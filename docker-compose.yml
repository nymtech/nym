version: '3.7'
services:
        genesis_validator:
                build: docker/validator
                image: validator:latest
                ports:
                        - "26657:26657"
                container_name: genesis_validator
                volumes:
                        - "genesis_volume:/genesis_volume"
                command: ["genesis"]
        secondary_validator:
                build: docker/validator
                image: validator:latest
                volumes:
                        - "genesis_volume:/genesis_volume"
                depends_on:
                        - "genesis_validator"
                command: ["secondary"]
        mixnet_contract:
                build: docker/mixnet_contract
                image: contract:latest
                volumes:
                        - ".:/nym"
        contract_uploader:
                build: clients/validator
                image: contract_uploader:typescript
                volumes:
                        - "genesis_volume:/genesis_volume"
                        - "contract_volume:/contract_volume"
                        - ".:/nym"
                depends_on:
                        - "genesis_validator"
                        - "secondary_validator"
                        - "mixnet_contract"
        wallet:
                build: wallet-web
                image: wallet:latest
                ports:
                        - "3000:3000"
                volumes:
                        - "contract_volume:/contract_volume:ro"
                depends_on:
                        - "contract_uploader"

volumes:
        genesis_volume:
        contract_volume:
