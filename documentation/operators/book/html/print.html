<!DOCTYPE HTML>
<html lang="en" class="coal" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Nym Operators Guide</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="Everything needed to run Nym Mixnet components">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./themes/custom.css">
        <link rel="stylesheet" href="./themes/mdbook-admonish.css">
        <link rel="stylesheet" href="./themes/pagetoc.css">

<!--        -->
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "coal" : "coal";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('coal')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><li class="part-title">Summary</li><li class="chapter-item "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item "><a href="changelog.html"><strong aria-hidden="true">2.</strong> Changelog</a></li><li class="chapter-item "><a href="release-cycle.html"><strong aria-hidden="true">3.</strong> Release Cycle</a></li><li class="chapter-item "><a href="sandbox.html"><strong aria-hidden="true">4.</strong> Sandbox Testnet</a></li><li class="chapter-item affix "><li class="part-title">Binaries</li><li class="chapter-item "><a href="binaries/pre-built-binaries.html"><strong aria-hidden="true">5.</strong> Pre-built Binaries</a></li><li class="chapter-item "><a href="binaries/building-nym.html"><strong aria-hidden="true">6.</strong> Building from Source</a></li><li class="chapter-item affix "><li class="part-title">Operators Guides</li><li class="chapter-item "><a href="nodes/preliminary-steps.html"><strong aria-hidden="true">7.</strong> Preliminary Steps</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="nodes/wallet-preparation.html"><strong aria-hidden="true">7.1.</strong> Nym Wallet Preparation</a></li><li class="chapter-item "><a href="nodes/vps-setup.html"><strong aria-hidden="true">7.2.</strong> VPS Setup</a></li></ol></li><li class="chapter-item "><a href="nodes/nym-node.html"><strong aria-hidden="true">8.</strong> Nym Node</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="nodes/setup.html"><strong aria-hidden="true">8.1.</strong> Setup & Run</a></li><li class="chapter-item "><a href="nodes/configuration.html"><strong aria-hidden="true">8.2.</strong> Configuration</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="nodes/proxy-configuration.html"><strong aria-hidden="true">8.2.1.</strong> WSS & Reversed Proxy</a></li></ol></li><li class="chapter-item "><a href="nodes/bonding.html"><strong aria-hidden="true">8.3.</strong> Bonding</a></li></ol></li><li class="chapter-item "><a href="nodes/validator-setup.html"><strong aria-hidden="true">9.</strong> Nyx Validator Setup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="nodes/nym-api.html"><strong aria-hidden="true">9.1.</strong> Nym API Setup</a></li><li class="chapter-item "><a href="nodes/nyx-configuration.html"><strong aria-hidden="true">9.2.</strong> Validator & API Configuration</a></li></ol></li><li class="chapter-item "><a href="nodes/maintenance.html"><strong aria-hidden="true">10.</strong> Maintenance</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="nodes/manual-upgrade.html"><strong aria-hidden="true">10.1.</strong> Manual Node Upgrade</a></li><li class="chapter-item "><a href="nodes/nymvisor-upgrade.html"><strong aria-hidden="true">10.2.</strong> Automatic Node Upgrade: Nymvisor Setup and Usage</a></li></ol></li><li class="chapter-item "><a href="testing/performance.html"><strong aria-hidden="true">11.</strong> Performance Monitoring & Testing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="testing/gateway-probe.html"><strong aria-hidden="true">11.1.</strong> Gateway Probe</a></li><li class="chapter-item "><a href="testing/node-api-check.html"><strong aria-hidden="true">11.2.</strong> Node API Check</a></li><li class="chapter-item "><a href="testing/prometheus-grafana.html"><strong aria-hidden="true">11.3.</strong> Prometheus & Grafana</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="testing/explorenym-scripts.html"><strong aria-hidden="true">11.3.1.</strong> ExploreNYM scripts</a></li></ol></li></ol></li><li class="chapter-item "><li class="part-title">Troubleshooting</li><li class="chapter-item "><a href="troubleshooting/vps-isp.html"><strong aria-hidden="true">12.</strong> VPS Setup</a></li><li class="chapter-item "><a href="troubleshooting/nodes.html"><strong aria-hidden="true">13.</strong> Nym Node</a></li><li class="chapter-item "><a href="troubleshooting/validators.html"><strong aria-hidden="true">14.</strong> Validators</a></li><li class="chapter-item affix "><li class="part-title">Token Economics</li><li class="chapter-item "><a href="tokenomics/validator-rewards.html"><strong aria-hidden="true">15.</strong> Nyx: Validator Rewards</a></li><li class="chapter-item affix "><li class="part-title">FAQ</li><li class="chapter-item "><a href="faq/general-faq.html"><strong aria-hidden="true">16.</strong> General Operators FAQ</a></li><li class="chapter-item "><a href="faq/nym-nodes-faq.html"><strong aria-hidden="true">17.</strong> Nym Nodes</a></li><li class="chapter-item "><a href="faq/nyx-faq.html"><strong aria-hidden="true">18.</strong> Nyx & Validators</a></li><li class="chapter-item affix "><li class="part-title">Community & Legal Forum</li><li class="chapter-item "><a href="legal/exit-gateway.html"><strong aria-hidden="true">19.</strong> Exit Gateway</a></li><li class="chapter-item "><a href="legal/community-counsel.html"><strong aria-hidden="true">20.</strong> Community Counsel</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="legal/isp-list.html"><strong aria-hidden="true">20.1.</strong> ISP List</a></li><li class="chapter-item "><a href="legal/jurisdictions.html"><strong aria-hidden="true">20.2.</strong> Jurisdictions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="legal/swiss.html"><strong aria-hidden="true">20.2.1.</strong> Switzerland</a></li><li class="chapter-item "><a href="legal/united-states.html"><strong aria-hidden="true">20.2.2.</strong> United States</a></li></ol></li><li class="chapter-item "><a href="legal/landing-pages.html"><strong aria-hidden="true">20.3.</strong> Landing Pages</a></li></ol></li><li class="chapter-item "><a href="legal/add-content.html"><strong aria-hidden="true">21.</strong> How to Add Info</a></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Archive</li><li class="chapter-item "><a href="archive/archive.html"><strong aria-hidden="true">22.</strong> Why archive?</a></li><li class="chapter-item "><a href="archive/nodes/setup-guides.html"><strong aria-hidden="true">23.</strong> Mixnet Nodes Setup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="archive/nodes/initial-steps.html"><strong aria-hidden="true">23.1.</strong> Preliminary Steps</a></li><li class="chapter-item "><a href="archive/nodes/mix-node-setup.html"><strong aria-hidden="true">23.2.</strong> Mix Node</a></li><li class="chapter-item "><a href="archive/nodes/gateway-setup.html"><strong aria-hidden="true">23.3.</strong> Gateway</a></li><li class="chapter-item "><a href="archive/nodes/network-requester-setup.html"><strong aria-hidden="true">23.4.</strong> Network Requester</a></li></ol></li><li class="chapter-item "><a href="archive/faq/mixnodes-faq.html"><strong aria-hidden="true">24.</strong> FAQ: Mix Nodes</a></li><li class="chapter-item "><a href="archive/faq/smoosh-faq.html"><strong aria-hidden="true">25.</strong> FAQ: Project Smoosh</a></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Misc.</li><li class="chapter-item "><a href="coc.html"><strong aria-hidden="true">26.</strong> Code of Conduct</a></li><li class="chapter-item "><a href="toc.html"><strong aria-hidden="true">27.</strong> Terms & Conditions</a></li><li class="chapter-item "><a href="licensing.html"><strong aria-hidden="true">28.</strong> Licensing</a></li><li class="chapter-item affix "><li class="spacer"></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>

                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Dark</button></li>
                        </ul>

                        <!-- CUSTOM -->
                        <select id="dropdown-menu" class="icon-button">
                            <option value="https://nymtech.net/docs">Network Docs</option>
                            <option value="https://nymtech.net/learn/papers">Academic Papers</option>
                            <option value="">--------</option>
                            <option value="https://nymtech.net/developers">Dev Portal</option>
                            <option value="https://nymtech.net/developers/sdk/rust/rust.html">Rust SDK</option>
                            <option value="https://sdk.nymtech.net">Typescript SDK</option>
                            <option value="">--------</option>
                            <option value="https://nymtech.net/operators">Operators</option>
                            <option value="https://nymtech.net/developers/nymvpn/intro.html">NymVPN Testing</option>
                        </select>

                        <script>
                            document.getElementById('dropdown-menu').addEventListener('change', function() {
                                const selected = this.options[this.selectedIndex];
                                if (selected.value !== '') {
                                    window.location.href = selected.value;
                                }
                            });
                        </script>
                        
                        <!-- END CUSTOM -->
                    </div>

                    <h1 class="menu-title"> Nym Operators Guide</h1>

                    <div class="right-buttons">
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/nymtech/nym" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <main>
                            <div class="sidetoc">
                                <nav class="pagetoc"></nav>
                            </div>
                            <div class="content-wrap">

                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>This is Nym’s Operators guide, containing information and setup guides for the various pieces of Nym Mixnet infrastructure and Nyx blockchain validators.</p>
<pre><code>                      ┌─►mix──┐  mix     mix
                      │       │
            Entry     │       │                   Exit
client ───► Gateway ──┘  mix  │  mix  ┌─►mix ───► Gateway ───► internet
                              │       │
                              │       │
                         mix  └─►mix──┘  mix
</code></pre>
<p>If you are new to Nym and want to learn about the Mixnet, explore kickstart options and demos, learn how to integrate with the network, and follow developer tutorials check out the <a href="https://nymtech.net/developers/">Developer Portal</a>.</p>
<p>If you want to dive deeper into Nym’s architecture, clients, nodes, and SDK examples visit the <a href="https://nymtech.net/docs/">technical docs</a>.</p>
<h2 id="popular-pages"><a class="header" href="#popular-pages">Popular pages</a></h2>
<p><strong>Binary Information</strong></p>
<ul>
<li><a href="binaries/building-nym.html">Building Nym</a></li>
<li><a href="binaries/pre-built-binaries.html">Pre-built Binaries</a></li>
</ul>
<p><strong>Node setup and usage guides:</strong></p>
<ul>
<li><a href="nodes/nym-node.html">Nym Node</a></li>
<li><a href="nodes/nymvisor-upgrade.html">Nymvisor</a></li>
<li><a href="nodes/validator-setup.html">Validators</a></li>
<li><a href="nodes/nym-api.html">Nym API Setup</a></li>
</ul>
<p><strong>Maintenance, troubleshooting and FAQ</strong></p>
<ul>
<li><a href="faq/nym-nodes-faq.html">FAQ</a></li>
<li><a href="nodes/maintenance.html">Maintenance</a></li>
<li><a href="troubleshooting/nodes.html">Troubleshooting</a></li>
</ul>
<p><strong>Community Legal Forum</strong></p>
<ul>
<li><a href="legal/exit-gateway.html">Exit Gateway</a></li>
<li><a href="legal/community-counsel.html">Community Counsel</a></li>
<li><a href="legal/add-content.html">How to Add Info</a></li>
</ul>
<footer id="last-change">Last change: 2024-04-24, commit: <a href="https://github.com/nymtech/nym/commit/c53b46ee1">c53b46ee1</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="changelog"><a class="header" href="#changelog">Changelog</a></h1>
<p>This page displays a full list of all the changes during our release cycle from <a href="https://github.com/nymtech/nym/blob/nym-binaries-v2024.3-eclipse/CHANGELOG.md"><code>v2024.3-eclipse</code></a> onwards. Operators can find here the newest updates together with links to relevant documentation. The list is sorted so that the newest changes appear first.</p>
<h2 id="nym-node-patch-from-release202410-caramello"><a class="header" href="#nym-node-patch-from-release202410-caramello"><code>nym-node</code> patch from <code>release/2024.10-caramello</code></a></h2>
<ul>
<li><a href="https://github.com/nymtech/nym/releases/tag/nym-binaries-v2024.10-caramello-patch">Patch release binaries</a></li>
</ul>
<pre><code class="language-sh">Binary Name:        nym-node
Build Timestamp:    2024-09-16T15:00:41.019107021Z
Build Version:      1.1.7
Commit SHA:         65c8982cab0ff3a1154966e7d61956cb42a065fc
Commit Date:        2024-09-16T15:59:34.000000000+02:00
Commit Branch:      HEAD
rustc Version:      1.81.0
rustc Channel:      stable
cargo Profile:      release
</code></pre>
<p>This patch fixes <a href="changelog.html#v202410-caramello"><code>v202410-caramello</code></a> relase <a href="changelog.html#known-bugs--undone-features">bug</a> where one of the used dependencies - <a href="https://github.com/DefGuard/defguard/issues/619"><code>DefGuard</code></a>, was failing.</p>
<p>Updating to this patched version and running <code>nym-node --mode exit-gateway</code> with <code>--wireguard-enabled true</code> should result in a smooth node start without the <code>defguard_wireguard</code> error, occuring to some operators before:</p>
<pre><code class="language-sh">/home/ubuntu/.cargo/registry/src/index.crates.io-6f17d22bba15001f/defguard_wireguard_rs-0.4.2/src/netlink.rs:155: Serialized netlink packet (23240 bytes) larger than maximum size 12288: NetlinkMessage.
</code></pre>
<h2 id="v202410-caramello"><a class="header" href="#v202410-caramello"><code>v2024.10-caramello</code></a></h2>
<ul>
<li><a href="https://github.com/nymtech/nym/releases/tag/nym-binaries-v2024.10-caramello">Release binaries</a></li>
<li><a href="https://github.com/nymtech/nym/blob/nym-binaries-v2024.10-caramello/CHANGELOG.md">Release CHANGELOG.md</a></li>
<li><a href="nodes/nym-node.html"><code>nym-node</code></a> version <code>1.1.7</code></li>
</ul>
<details id="admonition-changelogmd" class="admonition admonish-example" role="note" aria-labelledby="admonition-changelogmd-title">
<summary class="admonition-title">
<div id="admonition-changelogmd-title">
<p>CHANGELOG.md</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-changelogmd"></a>
</summary>
<div>
<ul>
<li>Backport 4844 and 4845 (<a href="https://github.com/nymtech/nym/pull/4857">#4857</a>)</li>
<li>Bugfix/client registration vol2 (<a href="https://github.com/nymtech/nym/pull/4856">#4856</a>)</li>
<li>Remove wireguard feature flag and pass runtime enabled flag (<a href="https://github.com/nymtech/nym/pull/4839">#4839</a>)</li>
<li>Eliminate cancel unsafe sig awaiting (<a href="https://github.com/nymtech/nym/pull/4834">#4834</a>)</li>
<li>added explicit updateable admin to the mixnet contract (<a href="https://github.com/nymtech/nym/pull/4822">#4822</a>)</li>
<li>using legacy signing payload in CLI and verifying both variants in contract (<a href="https://github.com/nymtech/nym/pull/4821">#4821</a>)</li>
<li>adding ecash contract address (<a href="https://github.com/nymtech/nym/pull/4819">#4819</a>)</li>
<li>Check profit margin of node before defaulting to hardcoded value  (<a href="https://github.com/nymtech/nym/pull/4802">#4802</a>)</li>
<li>Sync last_seen_bandwidth immediately (<a href="https://github.com/nymtech/nym/pull/4774">#4774</a>)</li>
<li>Feature/additional ecash nym cli utils (<a href="https://github.com/nymtech/nym/pull/4773">#4773</a>)</li>
<li>Better storage error logging (<a href="https://github.com/nymtech/nym/pull/4772">#4772</a>)</li>
<li>bugfix: make sure DKG parses data out of events if logs are empty (<a href="https://github.com/nymtech/nym/pull/4764">#4764</a>)</li>
<li>Fix clippy on rustc beta toolchain (<a href="https://github.com/nymtech/nym/pull/4746">#4746</a>)</li>
<li>Fix clippy for beta toolchain (<a href="https://github.com/nymtech/nym/pull/4742">#4742</a>)</li>
<li>Disable testnet-manager on non-unix (<a href="https://github.com/nymtech/nym/pull/4741">#4741</a>)</li>
<li>Don’t set NYM_VPN_API to default (<a href="https://github.com/nymtech/nym/pull/4740">#4740</a>)</li>
<li>Update publish-nym-binaries.yml (<a href="https://github.com/nymtech/nym/pull/4739">#4739</a>)</li>
<li>Update ci-build-upload-binaries.yml (<a href="https://github.com/nymtech/nym/pull/4738">#4738</a>)</li>
<li>Add NYM_VPN_API to network config (<a href="https://github.com/nymtech/nym/pull/4736">#4736</a>)</li>
<li>Re-export RecipientFormattingError in nym sdk (<a href="https://github.com/nymtech/nym/pull/4735">#4735</a>)</li>
<li>Persist wireguard peers (<a href="https://github.com/nymtech/nym/pull/4732">#4732</a>)</li>
<li>Fix tokio error in 1.39 (<a href="https://github.com/nymtech/nym/pull/4730">#4730</a>)</li>
<li>Feature/vesting purge plus ranged cost params (<a href="https://github.com/nymtech/nym/pull/4716">#4716</a>)</li>
<li>Fix (some) feature unification build failures (<a href="https://github.com/nymtech/nym/pull/4681">#4681</a>)</li>
<li>Feature Compact Ecash : The One PR (<a href="https://github.com/nymtech/nym/pull/4623">#4623</a>)</li>
</ul>
</div>
</details>
<h3 id="features"><a class="header" href="#features">Features</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4717">Add 1GB/day/user bandwidth cap</a></li>
</ul>
<details id="admonition-testing-steps-performed" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed"></a>
</summary>
<div>
<p><strong>Scenario 1: Bandwidth Decreasing Continuously</strong></p>
<ol>
<li>Started the client and noted the initial bandwidth (e.g., 1GB).</li>
<li>Used the client and tracked bandwidth usage over time (e.g., decrease by 100MB every hour).</li>
<li>Restarted the client after some usage.</li>
<li>Verified the bandwidth continued from the last recorded value, not reset.</li>
</ol>
<p>The bandwidth continued decreasing without resetting upon restart. Logs and reports correctly reflected the decreasing bandwidth.</p>
<p><strong>Scenario 2: Bandwidth Reset Next Day</strong></p>
<ol>
<li>Used the client normally until the end of the day.</li>
<li>Suspended some clients and kept others active.</li>
<li>Checked bandwidth at midnight.</li>
<li>Verified that bandwidth reset to 1GB for both suspended and active clients.</li>
</ol>
<p>Bandwidth reset to 1GB for all clients at midnight. Logs and reports correctly showed the reset.</p>
<p><strong>Scenario 3: Bandwidth Reset at a Different Time (e.g., Midday)</strong></p>
<ol>
<li>Configured the system to reset bandwidth at midday.</li>
<li>Used the client and monitored bandwidth until midday.</li>
<li>Kept the client connected during the reset time.</li>
<li>Verified that bandwidth reset to 1GB live at midday.</li>
</ol>
<p>Bandwidth reset to 1GB at midday while the client was connected. Logs and reports correctly reflected the reset.</p>
<p><strong>Scenario 4: Stale Check for 3 Days</strong></p>
<ol>
<li>Kept a client inactive for 3 days.</li>
<li>Verified removal from the peer list after 3 days.</li>
<li>Reconnected the client after 3 days and checked for a new private IP.</li>
<li>Restarted a client within 3 days and verified it retained the same private IP.</li>
</ol>
<p>The client was removed from the peer list after 3 days of inactivity. Upon re-connection after 3 days, the client received a new private IP. The client retained the same private IP when restarted within 3 days.</p>
</div>
</details>
<ul>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4710">Feature/merge back</a>: Merge back from the release branch the changes that fix the <code>nym-node</code> upgrades</p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4706">Removed mixnode/gateway config migration code and disabled cli without explicit flag</a>: Commands for archived / legacy binaries <code>nym-gateway</code> and <code>nym-mixnode</code> won’t do anything without explicit <code>--force-run</code> to bypass the deprecation. The next step, in say a month or so, is to completely remove all <code>cli</code> related things.</p>
</li>
</ul>
<details id="admonition-testing-steps-performed-1" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-1-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-1-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-1"></a>
</summary>
<div>
<ul>
<li>Verify that the <code>nym-gateway</code> binary and <code>nym-mixnode</code> binary commands return the <em>error message</em> stating to update to nym-node</li>
<li>Check that when adding the <code>--force-run</code> flag, it still allows the command to be run (aside from <code>init</code> which has been removed) and the message stating to update to nym-node is a <em>warning</em> now</li>
<li>Check <code>nym-node</code> is not affected</li>
<li>Reviewed the changes in the PR</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4723">Handle clients with different versions in IPR</a>: Allow the IPR to handle clients connecting both using <code>v6</code> and <code>v7</code>, independently. The motivation is that we want to be able to roll out a API version change gradually for VPN clients without breaking backwards compatibility. The main feature on the new <code>v7</code> format that is not yet used, is that it adds signatures for connect/disconnect.</li>
</ul>
<details id="admonition-testing-steps-performed-2" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-2-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-2-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-2"></a>
</summary>
<div>
<p>Run the same command (using same gateways deployed from this PR) on different versions of the <code>nym-vpn-cli</code>.</p>
<p>Example:</p>
<pre><code class="language-sh">~/nym-vpn-core-v0.1.10_macos_universal ❯ sudo -E ./nym-vpn-cli -c ../qa.env run --entry-gateway-id $entry_gateway --exit-gateway-id $exit_gateway --enable-two-hop

~/nym-vpn-core-v0.1.11-dev_macos_universal ❯ sudo -E ./nym-vpn-cli -c ../qa.env run --entry-gateway-id $entry_gateway --exit-gateway-id $exit_gateway --enable-two-hop
</code></pre>
</div>
</details>
<ul>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4857">Backport <code>#4844</code> and <code>#4845</code></a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4839">Remove wireguard feature flag and pass runtime enabled flag</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4834">Eliminate cancel unsafe sig awaiting</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4822">Added explicit updateable admin to the mixnet contract</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4821">Using legacy signing payload in CLI and verifying both variants in contract</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4819">Adding ecash contract address</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4802">Check profit margin of node before defaulting to hardcoded value </a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4774">Sync <code>last_seen_bandwidth</code> immediately</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4773">Feature/additional ecash <code>nym-cli</code> utils</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4772">Better storage error logging</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4741">Disable testnet-manager on non-unix</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4740">Don’t set NYM_VPN_API to default</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4739">Update publish-nym-binaries.yml</a>: Adds wireguard to builds</p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4738">Update ci-build-upload-binaries.yml</a>: Adds wireguard for ci-builds</p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4736">Add NYM_VPN_API to network config</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4735">Re-export RecipientFormattingError in nym sdk</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4732">Persist wireguard peers</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4716">Feature/vesting purge plus ranged cost params</a>: Combines <a href="https://github.com/nymtech/nym/pull/4715">#4715</a> and <a href="https://github.com/nymtech/nym/pull/4711">#4711</a> into one.</p>
<ul>
<li>Disables all non-essential operations on the vesting contract =&gt; you can no longer bond mixnodes/make delegations/etc. (you can still, however, withdraw your vested tokens and so on)</li>
<li>Introduces admin-controlled minimum (and maximum) profit margin and interval operating costs.</li>
<li>both contracts have to be migrated <strong>at the same time</strong>. ideally within the same transaction</li>
<li>mixnet contract migration is not allowed (and will fail) if there are any pending actions involving vesting tokens, like delegating, increasing pledge, etc</li>
</ul>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4709">Bump braces from <code>3.0.2</code> to <code>3.0.3</code> in <code>/nym-wallet/webdriver</code></a>: Bumps <a href="https://github.com/micromatch/braces">braces</a> from <code>3.0.2</code> to <code>3.0.3</code>.</p>
</li>
</ul>
<h3 id="bugfix"><a class="header" href="#bugfix">Bugfix</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4731">chore: fix 1.80 lint issues</a></li>
</ul>
<details id="admonition-testing-steps-performed-3" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-3-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-3-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-3"></a>
</summary>
<div>
<ul>
<li>Building all binaries is ok</li>
<li>Running <code>cargo fmt</code> returns no issues</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4733">Fix version 1 not having template correspondent initially</a></li>
</ul>
<details id="admonition-testing-steps-performed-4" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-4-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-4-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-4"></a>
</summary>
<div>
<p>Tested updating an old <code>nym-node</code> version and ensuring it did not throw any errors.</p>
</div>
</details>
<ul>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4856">Bugfix/client registration vol2</a></p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4730">Fix tokio error in <code>1.39</code></a>:</p>
<ul>
<li>Bump tokio to <code>1.39.2</code>, skipping the issue with <code>1.39.1</code></li>
</ul>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4681">Fix (some) feature unification build failures</a>: Running a script in the root workspace that builds each crate independently</p>
</li>
</ul>
<details id="admonition-the-script" class="admonition admonish-example" role="note" aria-labelledby="admonition-the-script-title">
<summary class="admonition-title">
<div id="admonition-the-script-title">
<p>The script</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-the-script"></a>
</summary>
<div>
<pre><code class="language-sh">#!/bin/bash

packages=$(cargo metadata --format-version 1 --no-deps | jq -r '.packages[].name')

# Loop through each package and build
for package in $packages; do
    echo "Building $package"
    cargo clean
    cargo check -p "$package"
    if [ $? -ne 0 ]; then
        echo "Build failed for $package. Stopping."
        exit 1
    fi
done
</code></pre>
</div>
</details>
<ul>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4764">bugfix: make sure DKG parses data out of events if logs are empty</a>: This will be the case on post <code>0.50</code> chains</p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4746">Fix clippy on rustc beta toolchain</a>: Fix clippy warnings for rust beta toolchain</p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4742">Fix clippy for beta toolchain</a>: Fix beta toolchain clippy by removing unused module</p>
<ul>
<li>Add <code>nym-</code> prefix to <code>serde-common</code> crate</li>
<li>Remove ignored <code>default-features = false</code> attribute for workspace dependency</li>
</ul>
</li>
</ul>
<h3 id="crypto"><a class="header" href="#crypto">Crypto</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4623">Feature Compact Ecash : The One PR</a></li>
</ul>
<h3 id="operators-guide-tooling--updates"><a class="header" href="#operators-guide-tooling--updates">Operators Guide, Tooling &amp; Updates</a></h3>
<ul>
<li>
<p>More explicit <a href="nodes/setup.html#initialise--run">setup for <code>nym-node</code></a> with a new <a href="nodes/setup.html#essential-parameters--variables">option explanation</a>, including syntax examples</p>
</li>
<li>
<p>New <a href="nodes/configuration.html#routing-configuration">VPS networking configuration steps for Wireguard</a></p>
</li>
<li>
<p>Wireguard <a href="binaries/building-nym.html">builds from source</a> together with <code>nym-node</code>, no need to specify with a feature flag anymore</p>
</li>
<li>
<p>Wireguard peers stay connected for longer time, re-connections are also faster</p>
</li>
<li>
<p>Profit margin and operating cost values are set to the values agreed by operators off-chain vote, the values can be changed in the future through <a href="https://forum.nymtech.net/t/poll-proposal-for-on-chain-minimum-profit-margin-for-all-nym-nodes/253">Nym Operators governance process</a></p>
</li>
</ul>
<div id="admonition-default" class="admonition admonish-success" role="note">
<div>
<ul>
<li>Minimum profit margin = 20%</li>
<li>Maximum profit margin = 50%</li>
<li>Minimum operating cost = 0 NYM</li>
<li>Maximum operating cost = 1000 NYM</li>
</ul>
</div>
</div>
<ul>
<li>
<p><a href="https://harbourmaster.nymtech.net">Nym Harbourmater</a> has several new functionalities:</p>
<ul>
<li>Version counting graph for Gateways and Mixnodes</li>
<li>Several new columns with larger nodes performance and settings overview.</li>
<li>Top routing score now includes:
<ul>
<li>Wireguard registration and complete handshake test, to configure see <a href="changelog.html#operators-tasks">tasklist below</a></li>
<li>DNS resolution check, to configure see <a href="changelog.html#operators-tasks">tasklist below</a></li>
<li>Wireguard perfomance &gt; 0.75, to configure see <a href="changelog.html#operators-tasks">tasklist below</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p>New <a href="https://github.com/nymtech/nym/releases/tag/nym-wallet-v1.2.14">Nym Wallet</a> is out!</p>
<ul>
<li>Vesting contract functionalities have been purged, users can only remove tokens from vesting</li>
<li>Migrating from <code>mixnode</code> or <code>gateway</code> smart contracts to a new unifying <code>nym-node</code> smart contract will be available soon using Nym desktop wallet, just like you are used to for bonding and node settings. After this migration all <code>nym-nodes</code> will be able to receive delegation and rewards. We will share a step by step guide once this migration will be deployed. No action needed now.</li>
</ul>
</li>
<li>
<p><a href="testing/node-api-check.html">Nym API Check CLI</a> is upgraded according to the latest API endpoints, output is cleaner and more concise.</p>
</li>
</ul>
<h4 id="operators-tasks"><a class="header" href="#operators-tasks">Operators Tasks</a></h4>
<div id="admonition-default-1" class="admonition admonish-warning" role="note">
<div>
<p><strong>The steps below are highly recommended for all operators and mandatory for everyone who is a part of Nym Delegation or Grant program. Deadline is Friday, September 20th, 2024.</strong></p>
</div>
</div>
<p>Every <code>nym-node</code> should be upgraded to the latest version! Operators can test using <a href="sandbox.html">Sandbox env</a> during the pre-release period, then upgrade on mainnet. During the upgrade, please follow the points below before you restart the node:</p>
<p><strong><code>nym-node</code></strong></p>
<ul>
<li>Make sure to fill in basic description info, into the file located at <code>.nym/nym-nodes/&lt;ID&gt;/data/description.toml</code> (all nodes)</li>
<li>Configure wireguard routing with new <a href="https://gist.github.com/tommyv1987/ccf6ca00ffb3d7e13192edda61bb2a77"><code>network_tunnel_manager.sh</code></a> following <a href="nodes/configuration.html#routing-configuration">these steps</a> (Gateways only for the time being)</li>
<li>Enable Wireguard with <code>--wireguard-enabled true</code> flag included in your run command (Gateways only for the time being)
<ul>
<li>Note: On some VPS this setup may not be enough to get the correct results as some ISPs  have their own security groups setup below the individual VPS. In that case a ticket to ISP will have to be issued to open the needed settings. We are working on a template for such ticket.</li>
</ul>
</li>
<li>Setup <a href="nodes/proxy-configuration.html">reverse proxy and WSS</a> on <code>nym-node</code> (Gateways only for the time being)</li>
<li>Don’t forget to restart your node - or (preferably using <a href="nodes/configuration.html#systemd">systemd automation</a>) reload daemon and restart the service</li>
<li>Optional: Use <a href="testing/gateway-probe.html"><code>nym-gateway-probe</code></a> and <a href="https://nymtech.net/developers/nymvpn/cli.html">NymVPN CLI</a> to test your own Gateway</li>
<li>Optional: Run the script below to measure ping speed of your Gateway and share your results in <a href="https://matrix.to/#/#operators:nymtech.chat">Nym Operators channel</a></li>
</ul>
<details id="admonition-the-script-to-measure-gateway-ping-results" class="admonition admonish-example" role="note" aria-labelledby="admonition-the-script-to-measure-gateway-ping-results-title">
<summary class="admonition-title">
<div id="admonition-the-script-to-measure-gateway-ping-results-title">
<p>The script to measure Gateway ping results</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-the-script-to-measure-gateway-ping-results"></a>
</summary>
<div>
<p>We made a script for pinging nymtech.net from your GWs. Can you please install it and then share the result together with your Gateway ID:</p>
<ol>
<li>Get the script onto your machine (soon on github for curl or wget):</li>
</ol>
<pre><code class="language-sh"># paste all this block as one command
cat &lt;&lt;'EOL' &gt; ping_with_curl_average_for_wg_check.sh
#!/bin/bash

ping_with_curl_average_for_wg_check() {
    total_connect_time=0
    total_total_time=0
    iterations=5
    timeout=2

    for ((i=1; i&lt;=iterations; i++)); do
        echo "ping attempt $i..."

        echo "curling nymtech.net to check ping response times"
        times=$(curl -I https://nymtech.net --max-time $timeout \
        -w "time_connect=%{time_connect}\ntime_total=%{time_total}" -o /dev/null -s)

        time_connect=$(echo "$times" | grep "time_connect" | cut -d"=" -f2)
        time_total=$(echo "$times" | grep "time_total" | cut -d"=" -f2)

        total_connect_time=$(echo "$total_connect_time + $time_connect" | bc)
        total_total_time=$(echo "$total_total_time + $time_total" | bc)

        echo "time to connect: $time_connect s"
        echo "total time: $time_total s"
    done

    average_connect_time=$(echo "scale=3; $total_connect_time / $iterations" | bc)
    average_total_time=$(echo "scale=3; $total_total_time / $iterations" | bc)

    echo "-----------------------------------"
    echo "average time to connect: $average_connect_time s"
    echo "average total time: $average_total_time s"
}

ping_with_curl_average_for_wg_check
EOL
</code></pre>
<ol start="2">
<li>Make executable:</li>
</ol>
<pre><code class="language-sh">chmod +x ping_with_curl_average_for_wg_check.sh
</code></pre>
<ol start="3">
<li>In case you don’t have <code>bc</code>, install it:</li>
</ol>
<pre><code class="language-sh">sudo apt install bc
</code></pre>
<ol start="4">
<li>Run:</li>
</ol>
<pre><code class="language-sh">./ping_with_curl_average_for_wg_check.sh
</code></pre>
<ol start="5">
<li>Share results and ID key in <a href="https://matrix.to/#/#operators:nymtech.chat">Nym Operators channel</a></li>
</ol>
<p>THANK YOU!</p>
</div>
</details>
<p><strong>validators</strong></p>
<ul>
<li>Validators need to update and prepare for ecash implementation.</li>
</ul>
<h3 id="known-bugs--undone-features"><a class="header" href="#known-bugs--undone-features">Known Bugs &amp; Undone features</a></h3>
<ul>
<li>New <code>nym-nodes</code> without a performance 24h history above 50% don’t show routing properly on <code>nym-gateway-probe</code>, on Nym Harbourmaster the page may appear blank - we are working on a fix.</li>
<li>Wireguard works on IPv4 only for the time being, we are working on IPv6 implementation.</li>
<li>Harbourmaster <em>Role</em> column shows <code>nym-node --mode exit-gateway</code> as <code>EntryGateway</code>, we are working to fix it.</li>
<li>In rare occassions Harbourmaster shows only <em>“panda”</em> without the <em>“smiley”</em> badge even for nodes, which have T&amp;C’s accepted. We are working to fix it.</li>
<li>Sometimes <code>nym-node</code> running with <code>--wireguard-enabled true</code> gives this error on restart: <code>Serialized netlink packet .. larger than maximum size ..</code></li>
</ul>
<pre><code class="language-sh">/home/ubuntu/.cargo/registry/src/index.crates.io-6f17d22bba15001f/defguard_wireguard_rs-0.4.2/src/netlink.rs:155: Serialized netlink packet (23240 bytes) larger than maximum size 12288: NetlinkMessage.
</code></pre>
<p>From what we found out it seems that one of our <a href="https://github.com/DefGuard/defguard/issues/619">dependencies - <code>DefGuard</code> - is failing</a>. Based on the reading on their fix, it seems that when node operators try to re-create a wireguard interface with too many previous peers (like on Gateway restart, with restoring from storage), there’s an overflow. So their fix is to just add them one by one. To be sure that bumping the dependency version fixes the problem there’s still two things we’d need to check - and your feedback would help us a lot:</p>
<ol>
<li>Did operators only encounter this error after a <code>nym-node</code> (Gateway) restart?</li>
<li>Reprouce this error ourselves and see if it actually fixes our problem.</li>
</ol>
<p><strong>Please share your experience with us to help faster fix of this issue.</strong></p>
<hr />
<h2 id="v20249-topdeck"><a class="header" href="#v20249-topdeck"><code>v2024.9-topdeck</code></a></h2>
<ul>
<li><a href="https://github.com/nymtech/nym/releases/tag/nym-binaries-v2024.9-topdeck">Release binaries</a></li>
<li><a href="https://github.com/nymtech/nym/blob/nym-binaries-v2024.9-topdeck/CHANGELOG.md">Release CHANGELOG.md</a></li>
<li><a href="nodes/nym-node.html"><code>nym-node</code></a> version <code>1.1.6</code></li>
</ul>
<details id="admonition-changelogmd-1" class="admonition admonish-example" role="note" aria-labelledby="admonition-changelogmd-1-title">
<summary class="admonition-title">
<div id="admonition-changelogmd-1-title">
<p>CHANGELOG.md</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-changelogmd-1"></a>
</summary>
<div>
<ul>
<li>chore: fix 1.80 lint issues (<a href="https://github.com/nymtech/nym/pull/4731">#4731</a>)</li>
<li>Handle clients with different versions in IPR (<a href="https://github.com/nymtech/nym/pull/4723">#4723</a>)</li>
<li>Add 1GB/day/user bandwidth cap (<a href="https://github.com/nymtech/nym/pull/4717">#4717</a>)</li>
<li>Feature/merge back (<a href="https://github.com/nymtech/nym/pull/4710">#4710</a>)</li>
<li>removed mixnode/gateway config migration code and disabled cli without explicit flag (<a href="https://github.com/nymtech/nym/pull/4706">#4706</a>)</li>
</ul>
</div>
</details>
<h3 id="features-1"><a class="header" href="#features-1">Features</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4706">Removed <code>nym-mixnode</code> and <code>nym-gateway</code> config migration code and disabled CLI without explicit flag</a>: Gateway and Mixnode commands now won’t do anything without explicit <code>--force-run</code> to bypass the deprecation, instead it will tell an operator to run a <code>nym-node</code>.  The next step, in say a month or so, is to completely remove all <code>cli</code> related things.</li>
</ul>
<details id="admonition-testing-steps-performed-5" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-5-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-5-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-5"></a>
</summary>
<div>
<ul>
<li>Verify that the <code>nym-gateway</code> binary and <code>nym-mixnode</code> binary commands return the <code>_error message_</code> stating to <em>update to <code>nym-node</code></em></li>
<li>Check that when adding the <code>--force-run</code> flag, it still allows the command to be run (aside from <code>init</code> which has been removed) and the message stating to update to <code>nym-node</code> is a <code>_warning_</code> now</li>
<li>Check <code>nym-node</code> is not affected</li>
<li>Review the changes in the PR</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4717">Add 1GB/day/user bandwidth cap</a></li>
</ul>
<details id="admonition-testing-steps-performed---scenario-1-bandwidth-decreasing-continuously" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed---scenario-1-bandwidth-decreasing-continuously-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed---scenario-1-bandwidth-decreasing-continuously-title">
<p>Testing steps performed - Scenario 1: Bandwidth Decreasing Continuously</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed---scenario-1-bandwidth-decreasing-continuously"></a>
</summary>
<div>
<ol>
<li>Start the client and noted the initial bandwidth (e.g., 1GB).</li>
<li>Us the client and track bandwidth usage over time (e.g., decrease by 100MB every hour).</li>
<li>Restart the client after some usage.</li>
<li>Verify the bandwidth continued from the last recorded value, not reset.</li>
</ol>
<p><strong>Notes:</strong>
The bandwidth continued decreasing without resetting upon restart. Logs and reports correctly reflected the decreasing bandwidth.</p>
</div>
</details>
<details id="admonition-testing-steps-performed---scenario-2-bandwidth-reset-next-day" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed---scenario-2-bandwidth-reset-next-day-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed---scenario-2-bandwidth-reset-next-day-title">
<p>Testing steps performed - Scenario 2: Bandwidth Reset Next Day</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed---scenario-2-bandwidth-reset-next-day"></a>
</summary>
<div>
<ol>
<li>Use the client normally until the end of the day.</li>
<li>Suspend some clients and kept others active.</li>
<li>Check bandwidth at midnight.</li>
<li>Verify that bandwidth reset to 1GB for both suspended and active clients.</li>
</ol>
<p><strong>Notes:</strong>
Bandwidth reset to 1GB for all clients at midnight. Logs and reports correctly showed the reset.</p>
</div>
</details>
<details id="admonition-testing-steps-performed---scenario-3-bandwidth-reset-at-a-different-time-eg-midday" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed---scenario-3-bandwidth-reset-at-a-different-time-eg-midday-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed---scenario-3-bandwidth-reset-at-a-different-time-eg-midday-title">
<p>Testing steps performed - Scenario 3: Bandwidth Reset at a Different Time (e.g., Midday)</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed---scenario-3-bandwidth-reset-at-a-different-time-eg-midday"></a>
</summary>
<div>
<ol>
<li>Configure the system to reset bandwidth at midday.</li>
<li>Use the client and monitored bandwidth until midday.</li>
<li>Keep the client connected during the reset time.</li>
<li>Verify that bandwidth reset to 1GB live at midday.</li>
</ol>
<p><strong>Notes:</strong>
Bandwidth reset to 1GB at midday while the client was connected. Logs and reports correctly reflected the reset.</p>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4723">Handle clients with different versions in IPR</a>: Allow the IPR to handle clients connecting both using <code>v6</code> and <code>v7</code>, independently. The motivation is that we want to be able to roll out an API version change gradually for NymVPN clients without breaking backwards compatibility. The main feature on the new <code>v7</code> format that is not yet used, is that it adds signatures for connect/disconnect.</li>
</ul>
<details id="admonition-testing-steps-performed-6" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-6-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-6-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-6"></a>
</summary>
<div>
<p>Run the same command (using same gateways deployed from this PR) on different versions of the <code>nym-vpn-cli</code>.</p>
<p>Example:</p>
<pre><code class="language-sh">sudo -E ./nym-vpn-cli -c ../qa.env run --entry-gateway-id $entry_gateway --exit-gateway-id $exit_gateway --enable-two-hop

sudo -E ./nym-vpn-cli -c ../qa.env run --entry-gateway-id $entry_gateway --exit-gateway-id $exit_gateway --enable-two-hop
</code></pre>
</div>
</details>
<h3 id="bugfix-1"><a class="header" href="#bugfix-1">Bugfix</a></h3>
<ul>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4710">Feature/merge back</a>: Merge back from the release branch the changes that fix the <code>nym-node</code> upgrades.</p>
</li>
<li>
<p><a href="https://github.com/nymtech/nym/pull/4733">Fix version <code>1.x.x</code> not having template correspondent initially</a>: This should fix the problem of config deserialisation when operators upgrade nodes and skip over multiple versions.</p>
</li>
</ul>
<details id="admonition-testing-steps-performed-7" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-7-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-7-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-7"></a>
</summary>
<div>
<ul>
<li>Tested updating an old nym-node version and ensuring it did not throw any errors.</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4731">chore: fix 1.80 lint issues</a>:</li>
</ul>
<details id="admonition-testing-steps-performed-8" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-8-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-8-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-8"></a>
</summary>
<div>
<ul>
<li>Building all binaries is ok</li>
<li>Running <code>cargo fmt</code> returns no issues</li>
</ul>
</div>
</details>
<h3 id="operators-guide-updates"><a class="header" href="#operators-guide-updates">Operators Guide updates</a></h3>
<ul>
<li><a href="nodes/configuration.html#routing-configuration">WireGuard tunnel configuration guide</a> for <code>nym-node</code> (currently Gateways functionalities). For simplicity we made a detailed step by step guide to upgrade an existing <code>nym-node</code> to the latest version and configure your VPS routing for WireGuard. Open by clicking on the example block below.</li>
</ul>
<details id="admonition-upgrading--nym-node-with-wg" class="admonition admonish-example" role="note" aria-labelledby="admonition-upgrading--nym-node-with-wg-title">
<summary class="admonition-title">
<div id="admonition-upgrading--nym-node-with-wg-title">
<p>Upgrading  <code>nym-node</code> with WG</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-upgrading--nym-node-with-wg"></a>
</summary>
<div>
<p><strong>Prerequisites</strong></p>
<ul>
<li>
<p><strong>Nym Node Version:</strong> You must be running the <code>2024.9-topdeck</code> release branch, which operates as <code>nym-node</code> version <code>1.1.6</code>. You can find the release here: <a href="https://github.com/nymtech/nym/releases/tag/nym-binaries-v2024.9-topdeck">Nym 2024.9-topdeck Release</a>.</p>
</li>
<li>
<p><strong>Important:</strong> Before proceeding, make sure to <a href="nodes/maintenance.html#backup-a-node">back up</a> your current <code>nym-node</code> configuration to avoid any potential data loss or issues.</p>
</li>
<li>
<p><strong>Download Nym Node:</strong></p>
<ul>
<li>You can download the <code>nym-node</code> binary directly using the following command:</li>
</ul>
</li>
</ul>
<pre><code class="language-bash">curl -L https://github.com/nymtech/nym/releases/download/nym-binaries-v2024.9-topdeck/nym-node -o nym-node &amp;&amp; chmod u+x nym-node
</code></pre>
<p><strong>Step 1: Update UFW Firewall Rules</strong></p>
<ul>
<li><strong>Warning:</strong> Enabling the firewall with UFW without allowing SSH port 22 first will lead to losing access over SSH. Make sure port 22 is allowed before proceeding with any UFW configurations.</li>
</ul>
<p>Run the following as root or with <code>sudo</code> prefix:</p>
<ol>
<li>Check the current status of UFW (Uncomplicated Firewall):</li>
</ol>
<pre><code class="language-bash">ufw status
</code></pre>
<ol start="2">
<li>Ensure that the following ports are allowed on your machine before adding the WireGuard port:</li>
</ol>
<pre><code class="language-bash">ufw allow 22/tcp    # SSH - you're in control of these ports
ufw allow 80/tcp    # HTTP
ufw allow 443/tcp   # HTTPS
ufw allow 1789/tcp  # Nym specific
ufw allow 1790/tcp  # Nym specific
ufw allow 8080/tcp  # Nym specific - nym-node-api
ufw allow 9000/tcp  # Nym Specific - clients port
ufw allow 9001/tcp  # Nym specific - wss port
ufw allow 51822/udp # WireGuard
</code></pre>
<ol start="3">
<li>Confirm that the UFW rules have been updated:</li>
</ol>
<pre><code class="language-bash">ufw status
</code></pre>
<p><strong>Step 2: Download and Prepare the Network Tunnel Manager Script</strong></p>
<ol>
<li>Download the <a href="https://gist.github.com/tommyv1987/ccf6ca00ffb3d7e13192edda61bb2a77"><code>network_tunnel_manager.sh</code></a> script:</li>
</ol>
<pre><code class="language-bash">curl -L -o network_tunnel_manager.sh https://gist.githubusercontent.com/tommyv1987/ccf6ca00ffb3d7e13192edda61bb2a77/raw/3c0a38c1416f8fdf22906c013299dd08d1497183/network_tunnel_manager.sh
</code></pre>
<ol start="2">
<li>Make the script executable:</li>
</ol>
<pre><code class="language-bash">chmod u+x network_tunnel_manager.sh
</code></pre>
<ol start="3">
<li>Apply the WireGuard IPTables rules:</li>
</ol>
<pre><code class="language-bash">./network_tunnel_manager.sh apply_iptables_rules_wg
</code></pre>
<p><strong>Step 3: Update the Nym Node Service File</strong></p>
<ol>
<li>Modify your <a href="nodes/configuration.html#systemd"><code>nym-node</code> service file</a> to enable WireGuard. Open the file (usually located at <code>/etc/systemd/system/nym-node.service</code>) and update the <code>[Service]</code> section as follows:</li>
</ol>
<pre><code class="language-ini">[Service]
User=&lt;YOUR_USER_NAME&gt;
Type=simple
#Environment=RUST_LOG=debug
# CAHNGE PATH IF YOU DON'T RUN IT FROM ROOT HOME DIRECTORY
ExecStart=/root/nym-node run --mode exit-gateway --id &lt;YOUR_NODE_LOCAL_ID&gt; --accept-operator-terms-and-conditions --wireguard-enabled true
Restart=on-failure
RestartSec=30
StartLimitInterval=350
StartLimitBurst=10
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target

# ADD OR TWEAK ANY CUSTOM SETTINGS
</code></pre>
<ol start="2">
<li>Reload the systemd daemon to apply the changes:</li>
</ol>
<pre><code class="language-bash">systemctl daemon-reload
</code></pre>
<ol start="3">
<li>Restart the <code>nym-node service</code>:</li>
</ol>
<pre><code class="language-bash">systemctl restart nym-node.service
</code></pre>
<ol start="4">
<li>Optionally, you can check if the node is running correctly by monitoring the service logs:</li>
</ol>
<pre><code class="language-bash">journalctl -u nym-node.service -f -n 100
</code></pre>
<p><strong>Step 4: Run the Network Tunnel Manager Script</strong></p>
<p>Finally, run the following command to initiate our favorite routing test - run the joke through the WireGuard tunnel:</p>
<pre><code class="language-bash">./network_tunnel_manager.sh joke_through_wg_tunnel
</code></pre>
<ul>
<li><strong>Note:</strong> Wireguard will return only IPv4 joke, not IPv6. WG IPv6 is under development. Running IPR joke through the mixnet with <code>./network_tunnel_manager.sh joke_through_the_mixnet</code> should work with both IPv4 and IPv6!</li>
</ul>
</div>
</details>
<ul>
<li><a href="nodes/setup.html#-initialise--run">Change <code>--wireguard-enabled</code> flag to <code>true</code></a>: With a proper <a href="nodes/configuration.html#routing-configuration">routing configuration</a> <code>nym-nodes</code> running as Gateways can now enable WG. See the example below:</li>
</ul>
<details id="admonition-syntax-to-run-nym-node-with-wg-enabled" class="admonition admonish-example" role="note" aria-labelledby="admonition-syntax-to-run-nym-node-with-wg-enabled-title">
<summary class="admonition-title">
<div id="admonition-syntax-to-run-nym-node-with-wg-enabled-title">
<p>Syntax to run <code>nym-node</code> with WG enabled</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-syntax-to-run-nym-node-with-wg-enabled"></a>
</summary>
<div>
<p>For Exit Gateway:</p>
<pre><code class="language-sh">./nym-node run --id &lt;ID&gt; --mode exit-gateway --public-ips "$(curl -4 https://ifconfig.me)" --hostname "&lt;YOUR_DOMAIN&gt;" --http-bind-address 0.0.0.0:8080 --mixnet-bind-address 0.0.0.0:1789 --location &lt;COUNTRY_FULL_NAME&gt; --accept-operator-terms-and-conditions --wireguard-enabled true

# &lt;YOUR_DOMAIN&gt; is in format without 'https://' prefix
# &lt;COUNTRY_FULL_NAME&gt; is format like 'Jamaica',  or two-letter alpha2 (e.g. 'JM'), three-letter alpha3 (e.g. 'JAM') or three-digit numeric-3 (e.g. '388') can be provided.
# wireguard can be enabled from version 1.1.6 onwards
</code></pre>
<p>For Entry Gateway:</p>
<pre><code class="language-sh">./nym-node run --id &lt;ID&gt; --mode entry-gateway --public-ips "$(curl -4 https://ifconfig.me)" --hostname "&lt;YOUR_DOMAIN&gt;" --http-bind-address 0.0.0.0:8080 --mixnet-bind-address 0.0.0.0:1789 --accept-operator-terms-and-conditions --wireguard-enabled true

# &lt;YOUR_DOMAIN&gt; is in format without 'https://' prefix
# &lt;COUNTRY_FULL_NAME&gt; is format like 'Jamaica',  or two-letter alpha2 (e.g. 'JM'), three-letter alpha3 (e.g. 'JAM') or three-digit numeric-3 (e.g. '388') can be provided.
# wireguard can be enabled from version 1.1.6 onwards
</code></pre>
</div>
</details>
<ul>
<li><a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">Update Nym exit policy</a>: Based on the survey, AMA and following discussions we added several ports to Nym exit policy. The ports voted upon in the <a href="https://forum.nymtech.net/t/poll-a-new-nym-exit-policy-for-exit-gateways-and-the-nym-mixnet-is-inbound/464">forum governance</a> have not been added yet due to the concerns raised. These ports were unrestricted:</li>
</ul>
<details id="admonition-newly-opened-ports-in-nym-exit-policy" class="admonition admonish-example" role="note" aria-labelledby="admonition-newly-opened-ports-in-nym-exit-policy-title">
<summary class="admonition-title">
<div id="admonition-newly-opened-ports-in-nym-exit-policy-title">
<p>Newly opened ports in Nym exit policy</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-newly-opened-ports-in-nym-exit-policy"></a>
</summary>
<div>
<pre><code>22 # SSH
123 # NTP
445 # SMB file share Windows
465 # URD for SSM
587 # SMTP
853 # DNS over TLS
1433 # databases
1521 # databases
2049 # NFS
3074 # Xbox Live
3306 # databases
5000-5005 # RTP / VoIP
5432 # databases
6543 # databases
8080 # HTTP Proxies
8767 # TeamSpeak
8883 # Secure MQ Telemetry Transport - MQTT over SSL
9053 # Tari
9339 # gaming
9443 # alternative HTTPS
9735 # Lightning
25565 # Minecraft
27000-27050 # Steam and game servers
60000-61000 # MOSH
</code></pre>
</div>
</details>
<ul>
<li>
<p><a href="https://nymtech.net/developers/archive/nym-connect.html">Create a NymConnect archive page</a>, PR <a href="https://github.com/nymtech/nym/commit/5096c1e60e203dcf8be934823946e24fda16a9a3">#4750</a>: Archive deprecated NymConnect for backward compatibility, show PEApps examples for both NC and maintained <code>nym-socks5-client</code>.</p>
</li>
<li>
<p>Fix broken URLs and correct redirection. PRs: <a href="https://github.com/nymtech/nym/commit/7e36595d8fa7706876880b42df1c998a4b8c1478">#4745</a>, <a href="https://github.com/nymtech/nym/commit/1db61f800c6884e284c5ab21e7abce3bc6d91d99">#4752</a> <a href="https://github.com/nymtech/nym/commit/aaf3dca5b999ad7f19d2ff170078b43c9c4476c2">#4755</a>, <a href="https://github.com/nymtech/nym/commit/6f669866e92e637772726ad05caa5c5501a830f3">#4737</a></p>
</li>
</ul>
<details id="admonition-testing-steps-performed-9" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-9-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-9-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-9"></a>
</summary>
<div>
<ul>
<li>Use <a href="https://www.deadlinkchecker.com/website-dead-link-checker.asp">deadlinkchecker.com</a> to go over <code>nymtech.net</code> and correct all docs URLs</li>
<li>Go over search engines and old medium articles and check that all dead URLs re-directing correctly</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://nymtech.net/operators/nodes/vps-setup.html#configure-your-firewall">Clarify syntax on <code>nym-nodes</code> ports on VPS setup page</a>, PR <a href="https://github.com/nymtech/nym/commit/5e6417f83788f30b2a84e4dd73d6dd9619a2bb16">#4734</a>: Make crystal clear that the addresses and ports in operators <code>config.toml</code> must be opened using <a href="https://nymtech.net/operators/nodes/vps-setup.html#configure-your-firewall"><code>ufw</code></a> and set up as in the example below:</li>
</ul>
<details id="admonition-snap-of-binding-addresses-and-ports-in-configtoml" class="admonition admonish-example" role="note" aria-labelledby="admonition-snap-of-binding-addresses-and-ports-in-configtoml-title">
<summary class="admonition-title">
<div id="admonition-snap-of-binding-addresses-and-ports-in-configtoml-title">
<p>snap of binding addresses and ports in <code>config.toml</code></p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-snap-of-binding-addresses-and-ports-in-configtoml"></a>
</summary>
<div>
<pre><code class="language-toml">[host]
public_ips = [
'&lt;YOUR_PUBLIC_IPv4&gt;'
]

[mixnet]
bind_address = '0.0.0.0:1789'

[http]
bind_address = '0.0.0.0:8080'

[mixnode]
[mixnode.verloc]
bind_address = '0.0.0.0:1790'

[entry_gateway]
bind_address = '0.0.0.0:9000'
</code></pre>
</div>
</details>
<h3 id="tooling"><a class="header" href="#tooling">Tooling</a></h3>
<ul>
<li>
<p><a href="https://https://harbourmaster.nymtech.net/">Nym Harbourmaster</a> has now several new functionalities:</p>
<ul>
<li>Tab for Mixnodes</li>
<li>Tab with Charts</li>
<li>New columns with: <em>Moniker (node description)</em>, <em>DP delegatee</em>, <em>Accepted T&amp;Cs</em> - also part of a new category 🐼😀</li>
</ul>
</li>
<li>
<p>Nym has a new <a href="https://nymtech.net/about/token">Token page</a></p>
</li>
</ul>
<hr />
<h2 id="v20248-wispa"><a class="header" href="#v20248-wispa"><code>v2024.8-wispa</code></a></h2>
<ul>
<li><a href="https://github.com/nymtech/nym/releases/tag/nym-binaries-v2024.8-wispa">Release binaries</a></li>
<li><a href="https://github.com/nymtech/nym/blob/nym-binaries-v2024.8-wispa/CHANGELOG.md">Release CHANGELOG.md</a></li>
<li><a href="nodes/nym-node.html"><code>nym-node</code></a> version <code>1.1.5</code></li>
</ul>
<details id="admonition-changelogmd-2" class="admonition admonish-example" role="note" aria-labelledby="admonition-changelogmd-2-title">
<summary class="admonition-title">
<div id="admonition-changelogmd-2-title">
<p>CHANGELOG.md</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-changelogmd-2"></a>
</summary>
<div>
<ul>
<li>add event parsing to support cosmos_sdk &gt; 0.50 (<a href="https://github.com/nymtech/nym/pull/4697">#4697</a>)</li>
<li>Fix NR config compatibility (<a href="https://github.com/nymtech/nym/pull/4690">#4690</a>)</li>
<li>Remove UserAgent constructor since it’s weakly typed (<a href="https://github.com/nymtech/nym/pull/4689">#4689</a>)</li>
<li>[bugfix]: Node_api_check CLI looked over roles on blacklisted nodes (<a href="https://github.com/nymtech/nym/pull/4687">#4687</a>)</li>
<li>Add mixnodes to self describing api cache (<a href="https://github.com/nymtech/nym/pull/4684">#4684</a>)</li>
<li>Move and whole bump of crates to workspace and upgrade some (<a href="https://github.com/nymtech/nym/pull/4680">#4680</a>)</li>
<li>Remove code that refers to removed nym-network-statistics (<a href="https://github.com/nymtech/nym/pull/4679">#4679</a>)</li>
<li>Remove nym-network-statistics (<a href="https://github.com/nymtech/nym/pull/4678">#4678</a>)</li>
<li>Create UserAgent that can be passed from the binary to the nym api client (<a href="https://github.com/nymtech/nym/pull/4677">#4677</a>)</li>
<li>Add authenticator (<a href="https://github.com/nymtech/nym/pull/4667">#4667</a>)</li>
</ul>
</div>
</details>
<h3 id="features-2"><a class="header" href="#features-2">Features</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4721">Default construct NodeRole</a>: To preserve compatibility with newer clients interacting with older <code>nym-api</code></li>
</ul>
<details id="admonition-testing-steps-performed-10" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-10-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-10-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-10"></a>
</summary>
<div>
<ol>
<li>Reviewed the changes in the <code>nym-api-requests/src/models.rs</code> file.</li>
<li>Verified that the <code>NymNodeDescription</code> struct includes the new <code>role</code> field with a default value set by <code>default_node_role</code>.</li>
<li>Checked the implementation of the <code>default_node_role</code> function to ensure it returns <code>NodeRole::Inactive</code>.</li>
<li>Ran the updated code in the sandbox environment.</li>
<li>Monitored the sandbox environment for any issues or errors related to the changes.</li>
</ol>
<p><strong>Notes (if any):</strong>
The test was successful. No issues were flagged during the testing in the sandbox environment. The new default value for <code>NodeRole</code> ensures backward compatibility without causing disruptions.</p>
</div>
</details>
<ul>
<li>[Default construct NodeRole for backwards compatibility (apply <a href="https://github.com/nymtech/nym/pull/4721">#4721</a> on develop)](https://github.com/nymtech/nym/pull/4722)</li>
<li><a href="https://github.com/nymtech/nym/pull/4703">Add upgrades to <code>nym-node</code> for <code>authenticator</code> changes</a></li>
</ul>
<details id="admonition-testing-steps-performed-11" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-11-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-11-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-11"></a>
</summary>
<div>
<ol>
<li>Reviewed the changes in the <code>gateway/src/error.rs</code> and <code>gateway/src/node/mod.rs</code> files.</li>
<li>Verified the new error enum <code>AuthenticatorStartupFailure</code> was added to <code>GatewayError</code>.</li>
<li>Confirmed the implementation of the <code>StartedAuthenticator</code> struct and its usage in the <code>start_authenticator</code> function.</li>
<li>Ran the updated code in the canary environment.</li>
<li>Monitored the canary environment for any issues or errors related to the changes.</li>
</ol>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4697">Add event parsing to support <code>cosmos_sdk</code> &gt; <code>0.50</code></a></li>
</ul>
<details id="admonition-testing-steps-performed-12" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-12-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-12-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-12"></a>
</summary>
<div>
<ol>
<li>Reviewed the changes in <code>common/client-libs/validator-client/src/nyxd/cosmwasm_client/client_traits/signing_client.rs</code>, <code>logs.rs</code>, <code>types.rs</code>, and <code>nym-api/src/coconut/tests/mod.rs</code> files.</li>
<li>Verified the addition of event parsing in the relevant functions and structs.</li>
<li>Ensured that the <code>find_attribute</code> function correctly parses event attributes.</li>
<li>Ran the updated code in the sandbox environment.</li>
<li>Broadcasted transactions on the sandbox network to test the changes.</li>
<li>Monitored the sandbox network for any malformed responses or errors after the test chain upgrade.</li>
</ol>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4691">Send bandwidth status messages when connecting</a>: When connecting to the gateway we get received the available bandwidth left. Emit a status messages for this, for consumption by the application layer.</li>
</ul>
<details id="admonition-testing-steps-performed-13" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-13-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-13-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-13"></a>
</summary>
<div>
<ol>
<li>Reviewed the changes in <code>common/bandwidth-controller/src/event.rs</code>, <code>common/bandwidth-controller/src/lib.rs</code>, and <code>common/client-libs/gateway-client/src/client.rs</code> files.</li>
<li>Verified the implementation of <code>BandwidthStatusMessage</code> enum for emitting status messages.</li>
<li>Ensured <code>GatewayClient</code> is updated to send bandwidth status messages when connecting.</li>
<li>Deployed the updated code on the canary environment.</li>
<li>Connected to the gateway and checked for the emission of bandwidth status messages.</li>
<li>Verified that the messages were correctly parsed and consumed by the application layer.</li>
<li>Ran the VPN client to observe the parsed events.</li>
</ol>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4690">Fix NR config compatibility</a>: Recently we deleted the old statistics service provider. This fixes some issues where old configs didn’t work with the latest changes.
<ul>
<li>Make NR able to read config with old keys in</li>
<li>Remove deleted config keys from NR template</li>
</ul>
</li>
</ul>
<details id="admonition-testing-steps-performed-14" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-14-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-14-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-14"></a>
</summary>
<div>
<ol>
<li>Reviewed the changes in the <code>service-providers/network-requester/src/config/mod.rs</code> and <code>service-providers/network-requester/src/config/template.rs</code> files.</li>
<li>Ensured <code>NetworkRequester</code> config is able to read old keys for compatibility.</li>
<li>Removed old and deleted config keys from the <code>NetworkRequester</code> template.</li>
<li>Compiled the project to verify no issues or warnings appeared.</li>
<li>Ran all tests to ensure that the changes did not affect the functionality.</li>
<li>Validated that no leftover code from the old statistics service provider caused any issues.</li>
</ol>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4689">Remove <code>UserAgent</code> constructor since it’s weakly typed</a>:</li>
</ul>
<details id="admonition-testing-steps-performed-15" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-15-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-15-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-15"></a>
</summary>
<div>
<ol>
<li>Reviewed the changes in <code>common/http-api-client/src/user_agent.rs</code> file.</li>
<li>Verified the removal of the <code>UserAgent</code> constructor and ensured that all instances of <code>UserAgent::new</code> are updated accordingly.</li>
<li>Checked the implementation of <code>UserAgent</code> struct using <code>BinaryBuildInformation</code> and <code>BinaryBuildInformationOwned</code>.</li>
<li>Deployed the updated code across different environments (QA, sandbox, and canary).</li>
<li>Ran tests to ensure that the <code>UserAgent</code> struct functions correctly without the constructor.</li>
</ol>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4684">Add mixnodes to self describing api cache</a>:
<ul>
<li>Abstracts getting the self describing info a bit</li>
<li>Adds mixnodes to the cache refresher as well</li>
<li>Adds <code>role</code> field to the <code>NodeDescription</code> struct, to be able to distinguish between mixnodes and gateways</li>
<li>Switched to using <code>NodeStatusCache</code> instead of <code>ContractCache</code></li>
</ul>
</li>
</ul>
<details id="admonition-testing-steps-performed-16" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-16-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-16-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-16"></a>
</summary>
<div>
<p>Called the new <code>/mixnodes/described</code> endpoint as well as the existing <code>/gateways/described</code> endpoint and verified that the data returned for each was correct based on the settings that different nodes have when they are setup.</p>
<p>For gateway endpoint, the “role” for now does not differentiate between entry and exit gateways, this will be implemented in the future.</p>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4680">Move and whole bump of crates to workspace and upgrade some</a>:
<ul>
<li>Fix cargo warning for <code>default_features</code></li>
<li>Move dirs 4.0 to workspace</li>
<li>Use workspace <code>base64</code> dep</li>
<li>Move <code>rand_chacha</code> and <code>x25519-dalek</code> to workspace</li>
<li>Use workspace <code>ed25519-dalek</code> dep</li>
<li>Move <code>itertools</code> to workspace deps and upgrade</li>
<li>Move a few partial deps to workspace  while preserving versions</li>
</ul>
</li>
</ul>
<details id="admonition-testing-steps-performed-17" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-17-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-17-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-17"></a>
</summary>
<div>
<ol>
<li>Reviewed the changes to move and upgrade crates to the workspace.</li>
<li>Verified the updated dependencies:
<ul>
<li>Moved <code>dirs</code> to version 4.0 in the workspace.</li>
<li>Updated the <code>base64</code> dependency to use the workspace version.</li>
<li>Moved <code>rand_chacha</code> and <code>x25519-dalek</code> to the workspace.</li>
<li>Updated <code>ed25519-dalek</code> to use the workspace version.</li>
<li>Moved and upgraded <code>itertools</code> in the workspace.</li>
<li>Moved other partial dependencies to the workspace while preserving their versions.</li>
</ul>
</li>
<li>Ensured the <code>Cargo.toml</code> files across the project reflect these changes correctly.</li>
<li>Compiled the entire project to check for any issues or warnings.</li>
<li>Verified that all tests pass successfully after the changes.</li>
</ol>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4678">Remove <code>nym-network-statistics</code></a>: Remove <code>nym-network-statistics</code> service provider that is no longer used.</li>
</ul>
<details id="admonition-testing-steps-performed-18" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-18-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-18-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-18"></a>
</summary>
<div>
<ol>
<li>Reviewed the project to identify all references to <code>nym-network-statistics</code>.</li>
<li>Removed all code and dependencies associated with <code>nym-network-statistics</code>.</li>
<li>Ensured that no references to <code>nym-network-statistics</code> remain in the codebase, including comments, imports, and configuration files.</li>
<li>Compiled the project to check for any issues or warnings.</li>
<li>Ran all tests to ensure the removal did not affect the functionality of the project.</li>
</ol>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4679">Remove code that refers to removed <code>nym-network-statistics</code></a>: Follow up to <a href="https://github.com/nymtech/nym/pull/4678">#4678</a> where all code interacting with it is removed.</li>
</ul>
<details id="admonition-testing-steps-performed-19" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-19-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-19-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-19"></a>
</summary>
<div>
<ol>
<li>Reviewed the project to identify all references to <code>nym-network-statistics</code>.</li>
<li>Removed all code and dependencies associated with <code>nym-network-statistics</code>.</li>
<li>Ensured that no references to <code>nym-network-statistics</code> remain in the codebase, including comments, imports, and configuration files.</li>
<li>Compiled the project to check for any issues or warnings.</li>
<li>Ran all tests to ensure the removal did not affect the functionality of the project.</li>
</ol>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4677">Create <code>UserAgent</code> that can be passed from the binary to the <code>nym-api</code> client</a>:
<ul>
<li>Support setting <code>UserAgent</code> for the validator client</li>
<li>Support setting <code>UserAgent</code> in the SDK <code>MixnetClient</code></li>
<li>Set <code>UserAgent</code> when getting the list of gateways and topology in
<ul>
<li><code>nym-client</code></li>
<li><code>nym-socks5-client</code></li>
<li>Standalone <code>ip-packet-router</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<details id="admonition-testing-steps-performed-20" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-20-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-20-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-20"></a>
</summary>
<div>
<p>Used the nym-vpn-cli to test this, and we can visibly see the <code>UserAgent</code>, no issues with the comments mentioned above.</p>
<p>Example of the user agent sent:
<code>nym-client/1.1.36/x86_64-unknown-linux-gnu/e18bb70</code></p>
<img width="1435" alt="image" src="https://github.com/nymtech/nym/assets/60836166/5d4cc76f-84e6-45cb-9102-adc2b58a25d9">
<p>Connected with no problems</p>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4667">Add <code>authenticator</code></a></li>
</ul>
<h3 id="bugfix-2"><a class="header" href="#bugfix-2">Bugfix</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4687"><code>Node_api_check.py</code> CLI looked over roles on blacklisted nodes</a>: Removing/correcting this redundant function which results in unwanted error print, will resolve in the program not looking up the <code>roles</code> endpoint for blacklisted GWs, instead just ignores the role description and still return all other endpoints.</li>
</ul>
<h3 id="operators-guide-updates-1"><a class="header" href="#operators-guide-updates-1">Operators Guide updates</a></h3>
<ul>
<li><a href="https://nymtech.net/operators/nodes/maintenance.html#backup-a-node">Create a guide to backup and restore <code>nym-node</code></a>, PR <a href="https://github.com/nymtech/nym/pull/4720">#4720</a></li>
<li><a href="https://nymtech.net/operators/troubleshooting/vps-isp.html#network-configuration">Add manual IPv6 ifup/down network configuration</a>, PR <a href="https://github.com/nymtech/nym/pull/4651">#4651</a></li>
<li><a href="https://nymtech.net/operators/legal/isp-list.html">Extend ISP list</a></li>
<li><a href="https://nymtech.net/operators/nodes/proxy-configuration.html#web-secure-socket-setup">Add SSL cert bot block to WSS setup</a>, <a href="https://github.com/nymtech/nym/commits/develop/">PR here</a>: WSS setup fully works!</li>
<li><a href="https://nymtech.net/operators/nodes/bonding.html#bond-via-the-desktop-wallet-recommended">Correct <code>HTTP API port</code> in bonding page</a> , <a href="https://github.com/nymtech/nym/pull/4707">PR #4707</a>: Change <code>HTTP API port</code> to <code>8080</code> on every <code>nym-node</code> by opening <code>config.toml</code> and making sure that your binding addresses and ports are as in the block below. Then go to desktop wallet and open the box called <code>Show advanced options</code> and make sure all your ports are set correctly (usually this means to change <code>HTTP api port</code> to <code>8080</code> for <code>mixnode</code> mode).</li>
</ul>
<details id="admonition-snap-of-binding-addresses-and-ports-in-configtoml-1" class="admonition admonish-example" role="note" aria-labelledby="admonition-snap-of-binding-addresses-and-ports-in-configtoml-1-title">
<summary class="admonition-title">
<div id="admonition-snap-of-binding-addresses-and-ports-in-configtoml-1-title">
<p>snap of binding addresses and ports in <code>config.toml</code></p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-snap-of-binding-addresses-and-ports-in-configtoml-1"></a>
</summary>
<div>
<pre><code class="language-toml">[host]
public_ips = [
'&lt;YOUR_PUBLIC_IPv4&gt;'
]

[mixnet]
bind_address = '0.0.0.0:1789'

[http]
bind_address = '0.0.0.0:8080'

[mixnode]
[mixnode.verloc]
bind_address = '0.0.0.0:1790'

[entry_gateway]
bind_address = '0.0.0.0:9000'
</code></pre>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4727">Comment our deprecated node pages in <code>/docs</code></a>
<ul>
<li>Fixes <a href="https://github.com/nymtech/nym/issues/4632">issue #4632</a></li>
</ul>
</li>
<li><a href="https://github.com/nymtech/nym/pull/4682">Remove redundant syntax from the setup guide</a></li>
</ul>
<hr />
<h2 id="v20247-doubledecker"><a class="header" href="#v20247-doubledecker"><code>v2024.7-doubledecker</code></a></h2>
<ul>
<li><a href="https://github.com/nymtech/nym/releases/tag/nym-binaries-v2024.7-doubledecker">Release binaries</a></li>
<li><a href="https://github.com/nymtech/nym/blob/nym-binaries-v2024.7-doubledecker/CHANGELOG.md">Release CHANGELOG.md</a></li>
<li><a href="nodes/nym-node.html"><code>nym-node</code></a> version <code>1.1.4</code></li>
</ul>
<details id="admonition-changelogmd-3" class="admonition admonish-example" role="note" aria-labelledby="admonition-changelogmd-3-title">
<summary class="admonition-title">
<div id="admonition-changelogmd-3-title">
<p>CHANGELOG.md</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-changelogmd-3"></a>
</summary>
<div>
<ul>
<li>Add an early return in <code>parse_raw_str_logs</code> for empty raw log strings. (<a href="https://github.com/nymtech/nym/pull/4686">#4686</a>)</li>
<li>Bump braces from 3.0.2 to 3.0.3 in /wasm/mix-fetch/internal-dev (<a href="https://github.com/nymtech/nym/pull/4672">#4672</a>)</li>
<li>add expiry returned on import (<a href="https://github.com/nymtech/nym/pull/4670">#4670</a>)</li>
<li>[bugfix] missing rustls feature (<a href="https://github.com/nymtech/nym/pull/4666">#4666</a>)</li>
<li>Bump ws from 8.13.0 to 8.17.1 in /wasm/client/internal-dev-node (<a href="https://github.com/nymtech/nym/pull/4665">#4665</a>)</li>
<li>Bump braces from 3.0.2 to 3.0.3 in /clients/native/examples/js-examples/websocket (<a href="https://github.com/nymtech/nym/pull/4663">#4663</a>)</li>
<li>Bump ws from 8.14.2 to 8.17.1 in /sdk/typescript/packages/nodejs-client (<a href="https://github.com/nymtech/nym/pull/4662">#4662</a>)</li>
<li>Update setup.md (<a href="https://github.com/nymtech/nym/pull/4661">#4661</a>)</li>
<li>New clippy lints (<a href="https://github.com/nymtech/nym/pull/4660">#4660</a>)</li>
<li>Bump braces from 3.0.2 to 3.0.3 in /nym-api/tests (<a href="https://github.com/nymtech/nym/pull/4659">#4659</a>)</li>
<li>Bump braces from 3.0.2 to 3.0.3 in /docker/typescript_client/upload_contract (<a href="https://github.com/nymtech/nym/pull/4658">#4658</a>)</li>
<li>Update vps-setup.md (<a href="https://github.com/nymtech/nym/pull/4656">#4656</a>)</li>
<li>Update configuration.md (<a href="https://github.com/nymtech/nym/pull/4655">#4655</a>)</li>
<li>Remove old PR template (<a href="https://github.com/nymtech/nym/pull/4639">#4639</a>)</li>
</ul>
</div>
</details>
<h3 id="features-3"><a class="header" href="#features-3">Features</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4693">Remove the <code>nym-mixnode</code> and <code>nym-gateway</code> binaries from the CI upload builds action</a></li>
<li><a href="https://github.com/nymtech/nym/pull/4686">Add an early return in <code>parse_raw_str_logs</code> for empty raw log strings.</a>: This accommodates for the v50 + chain upgrade.</li>
<li><a href="https://github.com/nymtech/nym/pull/4672">Bump braces from <code>3.0.2</code> to <code>3.0.3</code> in <code>/wasm/mix-fetch/internal-dev</code></a>: Version update of <a href="https://github.com/micromatch/braces">braces</a></li>
<li><a href="https://github.com/nymtech/nym/pull/4663">Bump braces from <code>3.0.2</code> to <code>3.0.3</code> in <code>/clients/native/examples/js-examples/websocket</code></a>: Version update of <a href="https://github.com/micromatch/braces">braces</a>.</li>
<li><a href="https://github.com/nymtech/nym/pull/4659">Bump braces from <code>3.0.2</code> to <code>3.0.3</code> in <code>/nym-api/tests</code></a>: Version update of <a href="https://github.com/micromatch/braces">braces</a>.</li>
<li><a href="https://github.com/nymtech/nym/pull/4658">Bump braces from <code>3.0.2</code> to <code>3.0.3</code> in <code>/docker/typescript_client/upload_contract</code></a>: Version update of  <a href="https://github.com/micromatch/braces">braces</a>.</li>
<li><a href="https://github.com/nymtech/nym/pull/4665">Bump <code>ws</code> from <code>8.13.0</code> to <code>8.17.1</code> in <code>/wasm/client/internal-dev-node</code></a>: Version update of <a href="https://github.com/websockets/ws"><code>ws</code></a>.</li>
<li><a href="https://github.com/nymtech/nym/pull/4662">Bump <code>ws</code> from <code>8.14.2</code> to <code>8.17.1</code> in <code>/sdk/typescript/packages/nodejs-client</code></a>: Version update of <a href="https://github.com/websockets/ws"><code>ws</code></a>.</li>
<li><a href="https://github.com/nymtech/nym/pull/4670">Add expiry returned on import</a>: We need to return the expiry on import for desktop daemon <code>nym-vpnd</code>.</li>
<li><a href="https://github.com/nymtech/nym/pull/4660">New clippy lints</a></li>
<li><a href="https://github.com/nymtech/nym/pull/4643">Remove <code>nym-connect</code> directory</a>: Since the <code>nym-vpn</code> has superseded <code>nym-connect</code>, remove <code>nym-connect</code> from the repo.</li>
<li><a href="https://github.com/nymtech/nym/pull/4639">Remove old PR template</a></li>
</ul>
<h3 id="bugfix-3"><a class="header" href="#bugfix-3">Bugfix</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4666">missing rustls feature</a>: It just happens to work due to <code>feature-unification</code>. It should probably have this feature inbuild.</li>
</ul>
<h3 id="operators-guide-updates-2"><a class="header" href="#operators-guide-updates-2">Operators Guide updates</a></h3>
<ul>
<li><a href="nodes/configuration.html#node-description">Node description guide</a>: Steps to add self-description to <code>nym-node</code> and query this information from any node.</li>
<li><a href="nodes/proxy-configuration.html">Web Secure Socket (WSS) guide and reverse proxy update</a>, PR <a href="https://github.com/nymtech/nym/pull/4694">here</a>: A guide to setup <code>nym-node</code> in a secure fashion, using WSS via Nginx and Certbot. Landing page (reversed proxy) is updated and simplified.</li>
</ul>
<hr />
<h2 id="v20246-chomp"><a class="header" href="#v20246-chomp"><code>v2024.6-chomp</code></a></h2>
<ul>
<li><a href="https://github.com/nymtech/nym/releases/tag/nym-binaries-v2024.6-chomp">Release binaries</a></li>
<li><a href="https://github.com/nymtech/nym/blob/nym-binaries-v2024.6-chomp/CHANGELOG.md">Release CHANGELOG.md</a></li>
<li><a href="nodes/nym-node.html"><code>nym-node</code></a> version <code>1.1.3</code></li>
<li>Standalone <code>nym-gateway</code> and <code>nym-mixnode</code> binaries are no longer released</li>
</ul>
<details id="admonition-changelogmd-4" class="admonition admonish-example" role="note" aria-labelledby="admonition-changelogmd-4-title">
<summary class="admonition-title">
<div id="admonition-changelogmd-4-title">
<p>CHANGELOG.md</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-changelogmd-4"></a>
</summary>
<div>
<ul>
<li>Remove additional code as part of Ephemera Purge and SP and contracts (<a href="https://github.com/nymtech/nym/pull/4650">#4650</a>)</li>
<li>bugfix: make sure nym-api can handle non-cw2 (or without detailed build info) compliant contracts (<a href="https://github.com/nymtech/nym/pull/4648">#4648</a>)</li>
<li>introduced a flag to accept toc and exposed it via self-described API (<a href="https://github.com/nymtech/nym/pull/4647">#4647</a>)</li>
<li>bugfix: make sure to return an error on invalid public ip (<a href="https://github.com/nymtech/nym/pull/4646">#4646</a>)</li>
<li>Add ci check for PR having an assigned milestone (<a href="https://github.com/nymtech/nym/pull/4644">#4644</a>)</li>
<li>Removed ephemera code (<a href="https://github.com/nymtech/nym/pull/4642">#4642</a>)</li>
<li>Remove stale peers (<a href="https://github.com/nymtech/nym/pull/4640">#4640</a>)</li>
<li>Add generic wg private network routing (<a href="https://github.com/nymtech/nym/pull/4636">#4636</a>)</li>
<li>Feature/new node endpoints (<a href="https://github.com/nymtech/nym/pull/4635">#4635</a>)</li>
<li>standarised ContractBuildInformation and added it to all contracts (<a href="https://github.com/nymtech/nym/pull/4631">#4631</a>)</li>
<li>validate nym-node public ips on startup (<a href="https://github.com/nymtech/nym/pull/4630">#4630</a>)</li>
<li>Bump defguard wg (<a href="https://github.com/nymtech/nym/pull/4625">#4625</a>)</li>
<li>Fix cargo warnings (<a href="https://github.com/nymtech/nym/pull/4624">#4624</a>)</li>
<li>Update kernel peers on peer modification (<a href="https://github.com/nymtech/nym/pull/4622">#4622</a>)</li>
<li>Handle v6 and v7 requests in the IPR, but reply with v6 (<a href="https://github.com/nymtech/nym/pull/4620">#4620</a>)</li>
<li>fix typo (<a href="https://github.com/nymtech/nym/pull/4619">#4619</a>)</li>
<li>Update crypto and rand crates (<a href="https://github.com/nymtech/nym/pull/4607">#4607</a>)</li>
<li>Purge name service and service provider directory contracts (<a href="https://github.com/nymtech/nym/pull/4603">#4603</a>)</li>
</ul>
</div>
</details>
<h3 id="features-4"><a class="header" href="#features-4">Features</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4671">Make embedded NR/IPR ignore performance of the Gateway</a>: fixes bug in relation to scoring issue on nym-nodes operating as exit gateways failing to come online.</li>
<li><a href="https://github.com/nymtech/nym/pull/4647">Introduce a flag to accept Operators Terms and Conditions and exposed it via self-described API</a></li>
</ul>
<details id="admonition-testing-steps-performed-21" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-21-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-21-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-21"></a>
</summary>
<div>
<ul>
<li>Verify that the <code>execute</code> function correctly checks if the <code>accept_operator_terms</code> flag is set.</li>
<li>Test that a warning is displayed when the <code>accept_operator_terms</code> flag is not set.</li>
<li>Confirm that the <code>NymNode</code> instance is initialized with <code>with_accepted_toc(accepted_toc)</code> when the flag is set.</li>
<li>Apply the <code>--accept-toc</code> flag in the service and confirmed the change by running:</li>
</ul>
<pre><code>curl -s -X 'GET' 'http://18.171.251.41:8080/api/v1/auxiliary-details?output=json' -H 'accept: application/json' | jq .accepted_toc
</code></pre>
<ul>
<li>Verify that the output is <code>true</code>.</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4654">Rename ‘accept-toc’ flag and fields into explicit ‘accept-operator-terms-and-conditions’</a>: makes the <code>accept-toc</code> flag more explicit.</li>
<li><a href="https://github.com/nymtech/nym/pull/4630">Validate nym-node public ips on startup</a>: makes sure <code>nym-node</code> is not run with an empty <code>public_ips</code> and that they do not correspond to common misconfigurations like <code>127.0.0.1</code> or <code>0.0.0.0</code> unless run with <code>--local</code> flag.</li>
</ul>
<details id="admonition-testing-steps-performed-22" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-22-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-22-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-22"></a>
</summary>
<div>
<ul>
<li>
<p>Use the latest release/chomp binary with nym-node and input a dodgy ip
<img width="361" alt="image" src="https://github.com/nymtech/nym/assets/60836166/6f2210f9-90ec-48fb-932f-f325c701de09"></p>
</li>
<li>
<p>Validation:
<img width="1104" alt="image" src="https://github.com/nymtech/nym/assets/60836166/3bac221f-82f2-44cd-b8c0-6c599b0eb325">
When restarting the node it complains within the service launch file</p>
</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4635">New node endpoints</a>: introduces new endpoints on nym-api (and creates scaffolding for additional ones) for providing <strong>unfiltered</strong> network topology alongside performance score of all nodes.
<ul>
<li><code>NymApiTopologyProvider</code> got modified to use those endpoints alongside (configurable) filtering of nodes with score &lt; 50% (like our current blacklist)</li>
<li>Old clients should work as before as no existing endpoint got removed</li>
</ul>
</li>
</ul>
<details id="admonition-testing-steps-performed-23" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-23-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-23-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-23"></a>
</summary>
<div>
<ul>
<li>Validate that the <code>skimmed</code> endpoints are working, keeping in mind that they are unstable. The <em>full-fat</em> and <em>semi-skimmed</em> have not yet been implemented.</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4640">Remove stale peers</a></li>
<li><a href="https://github.com/nymtech/nym/pull/4642">Removed ephemera code</a></li>
</ul>
<details id="admonition-testing-steps-performed-24" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-24-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-24-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-24"></a>
</summary>
<div>
<ul>
<li>Check references to everything named SP and Ephemera and removed any additional references</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4650">Remove additional code as part of Ephemera Purge and SP and contracts</a>: in line with <a href="https://github.com/nymtech/nym/pull/4642">#4642</a> and <a href="https://github.com/nymtech/nym/pull/4603">#4603</a></li>
</ul>
<details id="admonition-testing-steps-performed-25" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-25-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-25-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-25"></a>
</summary>
<div>
<ul>
<li>Check references to everything named SP and Ephemera and removed any additional references</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4644">Add ci check for PR having an assigned milestone</a>: add a CI check for checking that a PR is assigned to a milestone. Can bypassed the check by adding a <code>no-milestone</code> label to a PR</li>
</ul>
<details id="admonition-testing-steps-performed-26" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-26-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-26-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-26"></a>
</summary>
<div>
<ul>
<li>CI complains if no milestone is associated with the an issue.</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4625">Bump defguard wireguard</a></li>
<li><a href="https://github.com/nymtech/nym/pull/4636">Add generic wireguard private network routing</a>: as defguard wireguard only allows for peer routing modifications, we will configure the entire wireguard private network to be routed to the wg device. Configuring per peer is also not desirable, as the interface doesn’t allow removing routes, so unused ip routing won’t be cleaned until gateway restart (and it would also pollute to routing table with a lot of rules when many peers are added).</li>
</ul>
<details id="admonition-testing-steps-performed-27" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-27-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-27-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-27"></a>
</summary>
<div>
<ul>
<li>This is a part of a bigger ticket, but initial testing has proven to shown that launching nym-nodes (entry and exit gateways) in WG enable mode to be working</li>
</ul>
<p><em>QA will use this template for the other related WG tickets in this release milestone.</em></p>
</div>
</details>
- [Standarise `ContractBuildInformation` and add it to all contracts](https://github.com/nymtech/nym/pull/4631): Similarly to `cw2`, we're now saving `ContractBuildInformation` under a constant storage key, i.e. `b"contract_build_info"` that standarises the retrieval by nym-api.
    - Also each of our contracts now saves and updates that information upon init and migration.
<details id="admonition-testing-steps-performed-28" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-28-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-28-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-28"></a>
</summary>
<div>
<ul>
<li>Use the latest release/chomp contracts and deploy these to QA</li>
<li>Use the <code>nym-api</code> to query for the results of these new contracts</li>
</ul>
<pre><code class="language-sh"> curl -X 'GET' \
   'https://qa-nym-api.qa.nymte.ch/api/v1/network/nym-contracts-detailed' \
   -H 'accept: application/json'
</code></pre>
<ul>
<li>It returns a detailed view of the contracts and which branch they were built from, alongside rust versions and so forth.
<img width="1257" alt="image" src="https://github.com/nymtech/nym/assets/60836166/b5711431-c2f6-44ee-bf02-b17e6c48c5ee"></li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4622">Update kernel peers on peer modification</a>:</li>
</ul>
<details id="admonition-testing-steps-performed-29" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-29-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-29-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-29"></a>
</summary>
<div>
<ul>
<li>This is a part of a bigger ticket, but initial testing has proven to shown that launching nym-nodes (entry and exit gateways) in WG enable mode to be working.
<em>QA will use this template for the other related WG tickets in this release milestone.</em></li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4620">Handle v6 and v7 requests in the IPR, but reply with v6</a>: teach the IPR to read both v6 and v7 requests, but always reply with v6. This is to prepare for bumping to v7 and signed connect/disconnect messages. Follow up PRs will add
<ul>
<li>Verify signature</li>
<li>Send v7 in client with signatures included</li>
</ul>
</li>
<li><a href="https://github.com/nymtech/nym/pull/4603">Purge name service and service provider directory contracts</a>: this is a compiler assisted purge of the <code>nym-name-service</code> and <code>nym-service-provider-directory</code> contracts that were never deployed on mainnet, and will anyhow be superseded by the new mixnode directory that is being worked on.</li>
</ul>
<details id="admonition-testing-steps-performed-30" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-30-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-30-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-30"></a>
</summary>
<div>
<p>It works insofar that it compiles, we need to deploy and test this on non-mainnet before merging in</p>
<ul>
<li>Purge <code>nym-name-service</code> contract</li>
<li>Purge <code>nym-name-service-common</code></li>
<li>Purge <code>nym-service-provider-directory</code> contract</li>
<li>Purge <code>nym-service-provider-directory-common</code></li>
<li>Remove everywhere name-service contract is used</li>
<li>Remove everywhere sp contract is used</li>
</ul>
<p>Performed:</p>
<ul>
<li>Check references to everything named SP and Ephemera and removed any additional references</li>
</ul>
</div>
</details>
<h3 id="crypto-1"><a class="header" href="#crypto-1">Crypto</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4607">Update crypto and rand crates</a>: Update sphinx crate to <code>0.1.1</code> along with 25519 crates and <code>rand</code> crates</li>
</ul>
<details id="admonition-comments" class="admonition admonish-example" role="note" aria-labelledby="admonition-comments-title">
<summary class="admonition-title">
<div id="admonition-comments-title">
<p>Comments</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-comments"></a>
</summary>
<div>
<p>This PR contains a test failure due to the update <a href="https://github.com/nymtech/nym/blob/b4a0487a41375167b2f481c00917b957b9f89789/common/crypto/src/asymmetric/encryption/mod.rs#L353-L358">here</a></p>
<ul>
<li>This is due a change in <code>x25519-dalek</code> from <code>1.1.1</code> to <code>2</code>.</li>
<li>Crypto operations should be identical, but the byte representation has changed (sphinx clamps at creation, x25519 clamps at use). This cannot be changed in the sphinx crate without breaking changes.</li>
<li>There is a good chance that this failure doesn’t impact anything else, but it has to be tested to see.</li>
<li>A mix of old and new clients with a mix of old and new mixnodes should do</li>
</ul>
</div>
</details>
<h3 id="bugfix-4"><a class="header" href="#bugfix-4">Bugfix</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4648">Make sure nym-api can handle non-cw2 (or without detailed build info) compliant contracts</a>: fixes the issue (even if some contracts aren’t uploaded on chain it doesn’t prohibit the api from working - caveat, the essential vesting and mixnet contract are required)</li>
</ul>
<details id="admonition-testing-steps-performed-31" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-31-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-31-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-31"></a>
</summary>
<div>
<ul>
<li>Use the latest release/chomp contracts and deploy these to QA</li>
<li>If the contract was not found, the API would complain of invalid contracts, thus not starting the rest of the operations of the API (network monitor / rewarding etc)</li>
</ul>
<p><code>Jun 11 16:27:34 qa-v2-nym-api bash[1352642]:  2024-06-11T16:27:34.551Z ERROR nym_api::nym_contract_cache::cache::refresher &gt; Failed to refresh validator cache - Abci query failed with code 6 - address n14y2x8a60knc5jjfeztt84kw8x8l5pwdgnqg256v0p9v4p7t2q6eswxyusw: no such contract: unknown request</code></p>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4646">Make sure to return an error on <code>nym-node</code> invalid public ip</a>: bugfix for <a href="https://github.com/nymtech/nym/pull/4630">#4630</a> that interestingly hasn’t been detected by clippy.</li>
</ul>
<details id="admonition-testing-steps-performed-32" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-32-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-32-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-32"></a>
</summary>
<div>
<ul>
<li>
<p>Use the latest release/chomp binary with nym-node and input a dodgy ip
<img width="361" alt="image" src="https://github.com/nymtech/nym/assets/60836166/6f2210f9-90ec-48fb-932f-f325c701de09"></p>
</li>
<li>
<p>Validation:
<img width="1104" alt="image" src="https://github.com/nymtech/nym/assets/60836166/3bac221f-82f2-44cd-b8c0-6c599b0eb325"></p>
</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4626">Extend the return error when connecting to gateway fails</a></li>
</ul>
<details id="admonition-testing-steps-performed-33" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-33-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-33-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-33"></a>
</summary>
<div>
<ul>
<li>Verify that the <code>establish_connection</code> function correctly attempts to establish a connection to the gateway.</li>
<li>Test error handling for <code>NetworkConnectionFailed</code> by simulating a failed connection.</li>
<li>Ensure that the <code>NetworkConnectionFailed</code> error includes the <code>address</code> and <code>source</code> details as expected.</li>
<li>Checked that <code>SocketState::Available</code> is set correctly when a connection is successfully established.</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4624">Fix Cargo warnings</a>: On every cargo command we have the set warnings:</li>
</ul>
<details id="admonition-cargo-warnings" class="admonition admonish-example" role="note" aria-labelledby="admonition-cargo-warnings-title">
<summary class="admonition-title">
<div id="admonition-cargo-warnings-title">
<p>Cargo warnings</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-cargo-warnings"></a>
</summary>
<div>
<p>warning: /home/alice/src/nym/nym/common/dkg/Cargo.toml: <code>default-features</code> is ignored for bls12_381, since <code>default-features</code> was not specified for <code>workspace.dependencies.bls12_381</code>, this could become a hard error in the future warning: /home/alice/src/nym/nym/common/dkg/Cargo.toml: <code>default-features</code> is ignored for ff, since <code>default-features</code> was not specified for <code>workspace.dependencies.ff</code>, this could become a hard error in the future warning: /home/alice/src/nym/nym/common/dkg/Cargo.toml: <code>default-features</code> is ignored for group, since <code>default-features</code> was not specified for <code>workspace.dependencies.group</code>, this could become a hard error in the future warning: /home/alice/src/nym/nym/common/client-libs/validator-client/Cargo.toml: <code>default-features</code> is ignored for bip32, since <code>default-features</code> was not specified for <code>workspace.dependencies.bip32</code>, this could become a hard error in the future warning: /home/alice/src/nym/nym/common/client-libs/validator-client/Cargo.toml: <code>default-features</code> is ignored for prost, since <code>default-features</code> was not specified for <code>workspace.dependencies.prost</code>, this could become a hard error in the future warning: /home/alice/src/nym/nym/common/credentials-interface/Cargo.toml: <code>default-features</code> is ignored for bls12_381, since <code>default-features</code> was not specified for <code>workspace.dependencies.bls12_381</code>, this could become a hard error in the future warning: /home/alice/src/nym/nym/common/credentials/Cargo.toml: <code>default-features</code> is ignored for bls12_381, since <code>default-features</code> was not specified for <code>workspace.dependencies.bls12_381</code>, this could become a hard error in the future warning: /home/alice/src/nym/nym/common/nymcoconut/Cargo.toml: <code>default-features</code> is ignored for bls12_381, since <code>default-features</code> was not specified for <code>workspace.dependencies.bls12_381</code>, this could become a hard error in the future warning: /home/alice/src/nym/nym/common/nymcoconut/Cargo.toml: <code>default-features</code> is ignored for ff, since <code>default-features</code> was not specified for <code>workspace.dependencies.ff</code>, this could become a hard error in the future warning: /home/alice/src/nym/nym/common/nymcoconut/Cargo.toml: <code>default-features</code> is ignored for group, since <code>default-features</code> was not specified for <code>workspace.dependencies.group</code>, this could become a hard error in the future.</p>
</div>
</details>
    - This PR adds `default-features = false` to the workspace dependencies to fix these. An alternative way would be to remove `default-features = false` in the crates, but we assume these were put there for a good reason. Also we might have other crates outside of the main workspace that depends on these crates having default features disabled.
    - We also have the warning `warning: profile package spec nym-wasm-sdk in profile release did not match any packages`  which we fix by commenting out the profile settings, since the crate is currently commented out in the workspace crate list.
<details id="admonition-testing-steps-performed-34" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-34-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-34-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-34"></a>
</summary>
<div>
<ul>
<li>All binaries have been built and deployed from this branch and no issues have surfaced.</li>
</ul>
</div>
</details>
<h3 id="operators-guide-updates-3"><a class="header" href="#operators-guide-updates-3">Operators Guide updates</a></h3>
<ul>
<li><a href="release-cycle.html">New Release Cycle</a> introduced: a transparent release flow, including:
<ul>
<li>New environments</li>
<li>Stable testnet</li>
<li><a href="https://nymtech.net/operators/sandbox.html#sandbox-token-faucet">Testnet token faucet</a></li>
<li>Flow <a href="release-cycle.html#release-flow">chart</a></li>
</ul>
</li>
<li><a href="sandbox.html">Sandbox testnet</a> guide: teaching Nym node operators how to run their nodes in Nym Sandbox testnet environment.</li>
<li><a href="nodes/setup.html#terms--conditions">Terms &amp; Conditions flag</a></li>
<li><a href="testing/node-api-check.html">Node API Check CLI</a></li>
<li><a href="troubleshooting/vps-isp.html#pruning-logs">Pruning VPS <code>syslog</code> scripts</a></li>
<li><a href="troubleshooting/nodes.html#my-gateway-is-blacklisted">Black-xit: Exiting the blacklist</a></li>
</ul>
<hr />
<h2 id="v20245-ragusa"><a class="header" href="#v20245-ragusa"><code>v2024.5-ragusa</code></a></h2>
<ul>
<li><a href="https://github.com/nymtech/nym/releases/tag/nym-binaries-v2024.5-ragusa">Release binaries</a></li>
<li><a href="https://github.com/nymtech/nym/blob/nym-binaries-v2024.5-ragusa/CHANGELOG.md">Release CHANGELOG.md</a></li>
<li><a href="nodes/nym-node.html"><code>nym-node</code></a> version <code>1.1.2</code></li>
</ul>
<details id="admonition-changelogmd-5" class="admonition admonish-example" role="note" aria-labelledby="admonition-changelogmd-5-title">
<summary class="admonition-title">
<div id="admonition-changelogmd-5-title">
<p>CHANGELOG.md</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-changelogmd-5"></a>
</summary>
<div>
<ul>
<li>Feature/nym node api location (<a href="https://github.com/nymtech/nym/pull/4605">#4605</a>)</li>
<li>Add optional signature to IPR request/response (<a href="https://github.com/nymtech/nym/pull/4604">#4604</a>)</li>
<li>Feature/unstable tested nodes endpoint (<a href="https://github.com/nymtech/nym/pull/4601">#4601</a>)</li>
<li>nym-api: make report/avg_uptime endpoints ignore blacklist (<a href="https://github.com/nymtech/nym/pull/4599">#4599</a>)</li>
<li>removed blocking for coconut in the final epoch state (<a href="https://github.com/nymtech/nym/pull/4598">#4598</a>)</li>
<li>allow using explicit admin address for issuing freepasses (<a href="https://github.com/nymtech/nym/pull/4595">#4595</a>)</li>
<li>Use rfc3339 for last_polled in described nym-api endpoint (<a href="https://github.com/nymtech/nym/pull/4591">#4591</a>)</li>
<li>Explicitly handle constraint unique violation when importing credential (<a href="https://github.com/nymtech/nym/pull/4588">#4588</a>)</li>
<li>[bugfix] noop flag for nym-api for nymvisor compatibility (<a href="https://github.com/nymtech/nym/pull/4586">#4586</a>)</li>
<li>Chore/additional helpers (<a href="https://github.com/nymtech/nym/pull/4585">#4585</a>)</li>
<li>Feature/wasm coconut (<a href="https://github.com/nymtech/nym/pull/4584">#4584</a>)</li>
<li>upgraded axum and related deps to the most recent version (<a href="https://github.com/nymtech/nym/pull/4573">#4573</a>)</li>
<li>Feature/nyxd scraper pruning (<a href="https://github.com/nymtech/nym/pull/4564">#4564</a>)</li>
<li>Run cargo autoinherit on the main workspace (<a href="https://github.com/nymtech/nym/pull/4553">#4553</a>)</li>
<li>Add rustls-tls to reqwest in validator-client (<a href="https://github.com/nymtech/nym/pull/4552">#4552</a>)</li>
<li>Feature/rewarder voucher issuance (<a href="https://github.com/nymtech/nym/pull/4548">#4548</a>)</li>
</ul>
</div>
</details>
<h3 id="features-5"><a class="header" href="#features-5">Features</a></h3>
<ul>
<li>New <code>nym-node</code> API endpoint <code>/api/v1/auxiliary-details</code>: to expose any additional information. Currently it’s just the location. <code>nym-api</code> will then query all nodes for that information and put it in the <code>self-described</code> endpoint.</li>
<li>New <code>nym-node</code> location available - use one of the three options to add this to your node config:
<ol>
<li>Update the <code>location</code> field under <code>[host]</code> section of <code>config.toml</code></li>
<li>For new nodes: Initialise the node with <code>--location</code> flag, where they have to provide the country info. Either full country name (e.g. ‘Jamaica’), two-letter alpha2 (e.g. ‘JM’), three-letter alpha3 (e.g. ‘JAM’) or three-digit numeric-3 (e.g. ‘388’) can be provided.</li>
<li>For existing nodes: It’s also possible to use exactly the same <code>--location</code> argument as above, but make sure to also provide <code>--write-changes</code> (or <code>-w</code>) flag to persist those changes!</li>
</ol>
</li>
<li><a href="https://github.com/nymtech/nym/pull/4601">Feature/unstable tested nodes endpoint</a>: Adds new data structures (<code>TestNode</code>, <code>TestRoute</code>, <code>PartialTestResult</code>) to handle test results for Mixnodes and Gateways. With the inclusion of pagination to handle large API responses efficiently. Lastly, introducing a new route with the tag <code>unstable</code> thus meaning not to be consumed without a user risk, prefixes in endpoints with unstable, are what it says on the tin.</li>
</ul>
<details id="admonition-testing-steps-performed-35" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-35-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-35-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-35"></a>
</summary>
<div>
<ul>
<li>Deploy new api changes to sandbox environment</li>
<li>Ensure current operations are transactional and standed operations are working</li>
<li>Run a script to ensure that the new endpoints are working as expected with pagination
<img width="719" alt="image" src="https://github.com/nymtech/nym/assets/60836166/91285971-e82a-4e5a-8a58-880505ae1be9"></li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4599"><code>nym-api</code>: make report/avg_uptime endpoints ignore blacklist</a>: When querying for node specific data, it’s no longer going to go through the entire list of all cached (and filtered nodes) to find it; instead it will attempt to retrieve a single unfiltered entry.</li>
</ul>
<details id="admonition-testing-steps-performed-36" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-36-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-36-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-36"></a>
</summary>
<div>
<ul>
<li>Build the project and deployed it in a test environment.</li>
<li>Manually test API endpoints for mixnode and gateway data.</li>
<li>Verify that the endpoints return the expected data and handle blacklists correctly.</li>
<li>API performance improved due to the efficient <code>HashMap</code> lookups</li>
<li>Data in mainnet will differ from test nets due to the increased amount of gateways and mixnodes in that environment</li>
<li>Test standard uptime routes:</li>
</ul>
<pre><code class="language-sh">curl -X 'GET' 'https://validator.nymtech.net/api/v1/status/gateway/Fo4f4SQLdoyoGkFae5TpVhRVoXCF8UiypLVGtGjujVPf/avg_uptime' -H 'accept: application/json'
</code></pre>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4591">Use rfc3339 for last_polled in described nym-api endpoint</a>: Fix issue where the validator-client can’t parse the nym-api response for the described endpoint, in particular the <code>latest_polled</code> field that was recently added, by making the field use <code>rfc3339</code>
<ul>
<li><strong>Note:</strong> This will require upgrading <code>nym-api</code> and everything that depends on the described endpoint.</li>
</ul>
</li>
</ul>
<details id="admonition-testing-steps-performed-37" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-37-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-37-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-37"></a>
</summary>
<div>
<ul>
<li>Update a <code>nym-api</code> to the binary built from this branch, then restart the api</li>
<li>Check the <code>journalctl</code> for error messages</li>
<li>Connected via client and could not see the error messages, this is backwards compatible</li>
<li>Local testing using sdk examples:</li>
</ul>
<pre><code class="language-sh">cd &lt;PATH_TO&gt;/nym/sdk/rust/nym-sdk
cargo run --example simple

# outcome
thread 'main' panicked at sdk/rust/nym-sdk/examples/simple.rs:9:64:
called Result::unwrap() on an Err value: ClientCoreError(ValidatorClientError(NymAPIError { source: ReqwestClientError { source: reqwest::Error { kind: Request, url: Url { scheme: "https", cannot_be_a_base: false, username: "", password: None,
</code></pre>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4573">Upgrade <code>axum</code> and related dependencies to the most recent version</a></li>
<li><a href="https://github.com/nymtech/nym/pull/4553">Run cargo autoinherit on the main workspace</a>: Move several dependencies to the workspace level using cargo autoinherit, to make it easier to keep our dependencies up to date.
<ul>
<li>Run cargo autoinherit in the root</li>
<li>Merge in the new workspace deps in the main list</li>
<li>We made sure to not mix in other changes as well - all features flags for all crates should be the same as before</li>
</ul>
</li>
</ul>
<details id="admonition-testing-steps-performed-38" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-38-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-38-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-38"></a>
</summary>
<div>
<ul>
<li>Run <code>cargo autoinherit</code> in the root directory to move dependencies to the workspace level</li>
<li>Merge the new workspace dependencies into the main list</li>
<li>Ensure no other changes were mixed in during the process</li>
<li>Verify that all feature flags for all crates remained the same as before</li>
<li>Build all the binaries from this branch to confirm successful compilation</li>
<li>Deploy the built binaries across different environments to ensure there were no issues</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4552">Add rustls-tls to reqwest in validator-client</a>: An attempt to make possible to end up in a situation where use use the validator-client but without functioning TLS support. For the monorepo this is masked by cargo feature unification, but becomes a problem for outside consumers, as as been noticed in many of the vpn client implementations.
<ul>
<li>In <code>validator-client</code>: <code>reqwest</code>, enable <code>rustls-tls</code> for <code>non-wasm32</code></li>
<li>In <code>client-core</code>: Use default features enabled for <code>non-wasm32</code> and switch to <code>webpki</code> roots, since that’s what we’re using with <code>reqwest</code> anyway</li>
<li>In <code>gateway-client</code>: Switch to <code>webpki</code> roots, since that’s what we’re using with <code>reqwest</code> anyway</li>
</ul>
</li>
</ul>
<h4 id="crypto-2"><a class="header" href="#crypto-2">Crypto</a></h4>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4598">Remove blocking for coconut in the final epoch state</a></li>
</ul>
<details id="admonition-testing-steps-performed-39" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-39-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-39-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-39"></a>
</summary>
<div>
<ul>
<li>Build the project to ensure no compilation errors</li>
<li>Run tests to verify the functionality of the <code>issue_credential</code> function</li>
<li>Execute integration tests to check the behaviour during an epoch transition.</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4595">Allow using explicit admin address for issuing freepasses</a></li>
<li><a href="https://github.com/nymtech/nym/pull/4588">Explicitly handle constraint unique violation when importing credential</a>: Add a strong type for when a duplicate credential is imported so the vpn lib can handle this.</li>
<li><a href="https://github.com/nymtech/nym/pull/4584">Feature/wasm coconut</a>: This pull request requires <a href="https://github.com/nymtech/nym/pull/4585">#4585</a> to be merged first</li>
<li><a href="https://github.com/nymtech/nym/pull/4564">Feature/nyxd scraper pruning</a>: This PR introduces storage pruning to <code>nyxd</code> scraper which is then used by the validators rewarder.</li>
</ul>
<details id="admonition-testing-steps-performed-40" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-40-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-40-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-40"></a>
</summary>
<div>
<ul>
<li>Add a <code>main.rs</code> file in the <code>nyxd</code> scraper dir, underneath <code>lib.rs</code>, amend <code>config.pruning_options.validate()?;</code> to be <code>let _ = config.pruning_options.validate();</code> in the mod.rs file</li>
<li>Test the different variations of <code>pruning_options</code>:
<ul>
<li>Check the <em>default</em> option: <code>pruning_options: PruningOptions::default()</code></li>
<li>Check the <em>nothing</em> option: <code>pruning_options: PruningOptions::nothing()</code></li>
<li>Check the <em>custom</em> option, example: <code>pruning_options: PruningOptions { keep_recent: (500), interval: (10), strategy: (PruningStrategy::Custom) }</code></li>
<li>Check the pruning <em>in real life</em> for the validator rewarder</li>
</ul>
</li>
<li>Validate that the database table <code>blocks</code> was being updated accordingly</li>
</ul>
</div>
</details>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4548">Feature/rewarder voucher issuance</a>
<ul>
<li>Introduces signature checks on issued credential data</li>
<li>Stores evidence of any failures/malicious behaviour in the internal db</li>
</ul>
</li>
</ul>
<h3 id="bugfix-5"><a class="header" href="#bugfix-5">Bugfix</a></h3>
<ul>
<li><a href="https://github.com/nymtech/nym/pull/4586"><code>noop</code> flag for <code>nym-api</code> for <code>nymvisor</code> compatibility</a>
<ul>
<li>The application starts correctly and logs the starting message</li>
<li>The <code>--no_banner</code> flag works as intended, providing compatibility with <code>nymvisor</code></li>
</ul>
</li>
</ul>
<details id="admonition-testing-steps-performed-41" class="admonition admonish-example" role="note" aria-labelledby="admonition-testing-steps-performed-41-title">
<summary class="admonition-title">
<div id="admonition-testing-steps-performed-41-title">
<p>Testing steps performed</p>
</div>
<a class="admonition-anchor-link" href="changelog.html#admonition-testing-steps-performed-41"></a>
</summary>
<div>
<ul>
<li>Build the project to ensure no compilation errors</li>
<li>Run the binary with different command-line arguments to verify the CLI functionality</li>
<li>Test with and without the <code>--no_banner</code> flag to ensure compatibility and expected behavior</li>
<li>Verify logging setup and configuration file parsing</li>
</ul>
</div>
</details>
<h3 id="operators-guide-updates-4"><a class="header" href="#operators-guide-updates-4">Operators Guide updates</a></h3>
<ul>
<li><a href="testing/gateway-probe.html"><code>nym-gateway-probe</code></a>: A CLI tool to check in-real-time networking status of any Gateway locally.</li>
<li><a href="legal/isp-list.html">Where to host your <code>nym-node</code>?</a>: A list of Internet Service Providers (ISPs) by Nym Operators community. We invite all operators to add their experiences with different ISPs to strengthen the community knowledge and Nym mixnet performance.</li>
<li>Make sure you run <code>nym-node</code> with <code>--wireguard-enabled false</code> and add a location description to your <code>config.toml</code>, both documented in <a href="nodes/setup.html#mode-exit-gateway"><code>nym-node</code> setup manual</a>.</li>
</ul>
<hr />
<h2 id="v20244-nutella"><a class="header" href="#v20244-nutella"><code>v2024.4-nutella</code></a></h2>
<ul>
<li><a href="https://github.com/nymtech/nym/milestone/59?closed=1">Merged PRs</a></li>
<li><a href="nodes/nym-node.html"><code>nym-node</code></a> version <code>1.1.1</code></li>
<li>This release also contains: <code>nym-gateway</code> and <code>nym-network-requester</code> binaries</li>
<li>core improvements on nym-node configuration</li>
<li>Nym wallet changes:
<ul>
<li>Adding <code>nym-node</code> command to bonding screens</li>
<li>Fixed the delegation issues with fixing RPC</li>
</ul>
</li>
<li><a href="nodes/configuration.html#connectivity-test-and-configuration">Network configuration</a> section updates, in particular for <code>--mode mixnode</code> operators</li>
<li><a href="troubleshooting/vps-isp.html#ipv6-troubleshooting">VPS IPv6 troubleshooting</a> updates</li>
</ul>
<hr />
<h2 id="v20243-eclipse"><a class="header" href="#v20243-eclipse"><code>v2024.3-eclipse</code></a></h2>
<ul>
<li>Release <a href="https://github.com/nymtech/nym/blob/nym-binaries-v2024.3-eclipse/CHANGELOG.md">Changelog.md</a></li>
<li><a href="nodes/nym-node.html"><code>nym-node</code></a> initial release</li>
<li>New tool for monitoring Gateways performance <a href="https://harbourmaster.nymtech.net">harbourmaster.nymtech.net</a></li>
<li>New versioning <code>1.1.0+nymnode</code> mainly for internal migration testing, not essential for operational use. We aim to correct this in a future release to ensure mixnodes feature correctly in the main API</li>
<li>New <a href="nodes/vps-setup.html">VPS specs &amp; configuration</a> page</li>
<li>New <a href="nodes/configuration.html">configuration page</a> with <a href="nodes/configuration.html#connectivity-test-and-configuration">connectivity setup guide</a> - a new requirement for <code>exit-gateway</code></li>
<li>API endpoints redirection: Nym-mixnode and nym-gateway endpoints will eventually be deprecated; due to this, their endpoints will be redirected to new routes once the <code>nym-node</code> has been migrated and is running</li>
</ul>
<p><strong>API endpoints redirection</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Previous endpoint</th><th>New endpoint</th></tr></thead><tbody>
<tr><td><code>http://&lt;IP&gt;:8000/stats</code></td><td><code>http://&lt;IP&gt;:8000/api/v1/metrics/mixing</code></td></tr>
<tr><td><code>http://&lt;IP&gt;:8000/hardware</code></td><td><code>http://&lt;IP&gt;:8000/api/v1/system-info</code></td></tr>
<tr><td><code>http://&lt;IP&gt;:8000/description</code></td><td><code>http://&lt;IP&gt;:8000/api/v1/description</code></td></tr>
</tbody></table>
</div><footer id="last-change">Last change: 2024-09-13, commit: <a href="https://github.com/nymtech/nym/commit/05d665217">05d665217</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="release-cycle"><a class="header" href="#release-cycle">Release Cycle</a></h1>
<p>The Nym operator community is growing in quality and quantity. With node operators and developers joining the effort to make the Mixnet more robust and scalable, testing new features, sharing integration pull requests and generally taking an active part in Nym development, more transparency on the release cycle is required.</p>
<p>The core team therefore established a flow with different environments:</p>
<ul>
<li><em><strong>local</strong></em>: Developers use their local environments for feature building</li>
<li><em><strong>canary</strong></em>: Nym internal testing environment managed by Qualty Assurance team (QA)</li>
<li><a href="sandbox.html"><em><strong>sandbox</strong></em></a>: Public testnet, including testnet NYM token available in the <a href="sandbox.html#sandbox-token-faucet">faucet</a></li>
<li><em><strong>mainnet</strong></em>: Nym Mixnet - the production version of Nym network</li>
</ul>
<h2 id="release-flow"><a class="header" href="#release-flow">Release Flow</a></h2>
<p>Frequency of releases to mainnet is aimed to be every ~14 days. This time window is an optimal compromise between periodicity and quality assurance/testing, key factors playing an essential role in development.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left"><strong>Stage</strong></th><th style="text-align: left"><strong>Environment</strong></th><th style="text-align: left"><strong>Branch</strong></th><th style="text-align: left"><strong>Ownership</strong></th></tr></thead><tbody>
<tr><td style="text-align: left">development work</td><td style="text-align: left">local/canary</td><td style="text-align: left">feature branches</td><td style="text-align: left">devs</td></tr>
<tr><td style="text-align: left">cut and test release</td><td style="text-align: left">canary</td><td style="text-align: left">release branch</td><td style="text-align: left">QA</td></tr>
<tr><td style="text-align: left">bug fixing</td><td style="text-align: left">canary</td><td style="text-align: left">directly on release branch</td><td style="text-align: left">QA &amp; devs</td></tr>
<tr><td style="text-align: left">put release on sandbox</td><td style="text-align: left">sandbox</td><td style="text-align: left">release -&gt; master/develop</td><td style="text-align: left">QA</td></tr>
<tr><td style="text-align: left">promote release to mainnet after 3-5 days</td><td style="text-align: left">mainnet</td><td style="text-align: left">master</td><td style="text-align: left">QA</td></tr>
</tbody></table>
</div>
<pre><code class="language-ascii">                   ▲                          ▲
                   │                          │
                   │  merge back into develop │
      MAINNET      ├─────────────────────────►│
      easy         │                          │
      autopromotion│                          │
      ▲            │                          │
      │            │                          │
      │            │                          │◄───────────────────────────────┐
      │            │                          │                                │
      └───release  │                          │                                │
          to       x◄───────────────┐         │                                │
          sandbox  ▲                │         │◄────────────────────────┐      │
                   │   ┌────────────►         │                         │      │
                   │   │            │         │                         │      │
                   │   │ bug        │         │                         │      │
                   │   │ fix        │         │◄─────────────────┐      │      │
                   │   │            │         │                  │      │      │
                   │   │            │         │ M                │      │      │
                   │   └────────────┤         │ I                │      │      │
                   │                │         │ L                │      │      │
                   │                └─────────x E                │      │      │
                   │                  release ▲ S                │      │      │
       ^           │                  cut     │ T                │      │      │
       :           │                  ---     │ O                │      │      │
       :           │                  fixed   │ N                │      │      │
       :           │                  release │ E                │      │      │
       :           │                  every   │     feature-bob3 │      │      │
       :           │                  14 days ├──────────────────┘      │      │
       :           │                          │                         │      │
       :           │                          │                         │      │
       :           │                          │     feature-bob2        │      │
       :           │                          ├─────────────────────────┘      │
       :           │                          │                                │
       :           │                          │                                │
       :           │                          │     feature-bob1               │
       :           │                          ├────────────────────────────────┘
       :           │                          │
       :           │                          │
       :t          │                          │
       :i          │                          │
       :m          │                          │
       :e          │                          │

                master                     develop             feature branches

ENVs
┌─────────┬────────┬──────────────────────────┬─────────────────────────────────┐
│mainnet  │sandbox │ QA / canary              │ development                     │
│         │        │                          │                                 │
└─────────┴────────┴──────────────────────────┴─────────────────────────────────┘
</code></pre>
<h3 id="changes--collaboration"><a class="header" href="#changes--collaboration">Changes &amp; Collaboration</a></h3>
<p>To track changes easily, builders and operators can visit one of the following:</p>
<ul>
<li><a href="https://github.com/nymtech/nym/blob/master/CHANGELOG.md"><em>CHANGELOG.md</em></a>: Raw changelog of the merged feauters in Nym’s monorepo, managed by devs and QA.</li>
<li><a href="changelog.html"><em>Changelog page</em></a>: A copy of <em>CHANGELOG.md</em> with more detailed explanation, testing steps and updated summary of documentation changes, managed by devrels.</li>
</ul>
<p>In case you want to propose changes or resolve some of the existing <a href="https://github.com/nymtech/nym/issues">issues</a>, start <a href="https://github.com/nymtech/nym/issues/new/choose">here</a>. If you want to add content to the Operators Guide, visit <a href="legal/add-content.html">this page</a>.</p>
<div id="admonition-tip" class="admonition admonish-tip" role="note" aria-labelledby="admonition-tip-title">
<div class="admonition-title">
<div id="admonition-tip-title">
<p>Tip</p>
</div>
<a class="admonition-anchor-link" href="release-cycle.html#admonition-tip"></a>
</div>
<div>
<p>Feature tickets need explicit (while concise) wording because that title is eventually added to the changelog. Keep in mind that bad ticket naming results in bad changelog.</p>
<p>If you want to run in the testing environment, follow our <a href="sandbox.html">Sandbox testnet</a> guide.</p>
</div>
</div>
<footer id="last-change">Last change: 2024-06-17, commit: <a href="https://github.com/nymtech/nym/commit/38c4cc334">38c4cc334</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="sandbox-testnet"><a class="header" href="#sandbox-testnet">Sandbox Testnet</a></h1>
<p>Nym node operators can run their nodes in Nym Sandbox testnet environment. Whether it’s testing new configuration, hot features from Nym developers or just trying to setup a node for the first time, this environment is for you.</p>
<p>Below are steps to <a href="sandbox.html#sandbox-environment-setup">setup your environment</a> and an introduction to <a href="sandbox.html#sandbox-token-faucet">Sandbox token faucet</a>.</p>
<div id="admonition-default" class="admonition admonish-warning" role="note">
<div>
<p>This page is for Nym node operators. If you want to run NymVPN CLI over Sandbox testnet, visit our <a href="https://nymtech.net/developers/nymvpn/cli.html#testnet-environment">developers portal</a>.</p>
</div>
</div>
<h2 id="sandbox-environment-setup"><a class="header" href="#sandbox-environment-setup">Sandbox Environment Setup</a></h2>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable. Exchange with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<p>To run Nym binaries in Sandbox testnet, you need to get <code>sandbox.env</code> configuration file and point your binary to it. Follow the steps below:</p>
<ol>
<li>Create Sandbox environment config file by saving <a href="https://raw.githubusercontent.com/nymtech/nym/develop/envs/sandbox.env">this</a> as <code>sandbox.env</code> in the same directory as your binaries:</li>
</ol>
<pre><code class="language-sh">curl -o sandbox.env -L https://raw.githubusercontent.com/nymtech/nym/develop/envs/sandbox.env

# In case you want to save the file elswhere, change the path in '-o' flag
</code></pre>
<ol start="2">
<li>Run your <code>nym-node</code> with an additional flag <code>-c</code> or <code>--config-env-file</code> with a path to <code>sandbox.env</code> file followed by all needed commands and options. For example:</li>
</ol>
<pre><code class="language-sh"># this example is for nym-node in mixnode mode
./nym-node --config-env-file &lt;PATH/TO/&gt;sandbox.env run --mode mixnode

# this example is for nym-node in exit-gateway mode
./nym-node --config-file-env &lt;PATH/TO/&gt;sandbox.env run --mode exit-gateway --id &lt;ID&gt; --public-ips "$(curl -4 https://ifconfig.me)" --hostname "&lt;YOUR_DOMAIN&gt;" --http-bind-address 0.0.0.0:8080 --mixnet-bind-address 0.0.0.0:1789 true --location &lt;COUNTRY_FULL_NAME&gt;

# In case you downloaded sandbox.env to the same directory, &lt;PATH&gt; is not needed
</code></pre>
<ol start="3">
<li>Bond your node to Nym Sandbox environment:
<ul>
<li>Open <a href="https://nymtech.net/download/wallet">Nym Wallet</a> and switch to testnet</li>
<li>Go to <a href="https://faucet.nymtech.net">faucet.nymtech.net</a> and aquire 101 testnet NYM tokens</li>
<li>Follow the steps on the <a href="nodes/bonding.html">bonding page</a></li>
</ul>
</li>
</ol>
<p><img src="images/sandbox.png" alt="" /></p>
<div id="admonition-tip" class="admonition admonish-tip" role="note" aria-labelledby="admonition-tip-title">
<div class="admonition-title">
<div id="admonition-tip-title">
<p>Tip</p>
</div>
<a class="admonition-anchor-link" href="sandbox.html#admonition-tip"></a>
</div>
<div>
<ol>
<li>
<p>If you <a href="../binaries/building-nym.html">built Nym from source</a>, you already have <code>sandbox.env</code> as a part of the monorepo (<code>nym/envs/sandbox.env</code>). Giving that you are likely to run <code>nym-node</code> from <code>nym/target/release</code>, the flag will look like this <code>--config-env-file ../../envs/sandbox.env</code></p>
</li>
<li>
<p>You can export the path to <code>sandbox.env</code> to your enviromental variables:</p>
</li>
</ol>
<pre><code class="language-sh">export NYMNODE_CONFIG_ENV_FILE_ARG=&lt;PATH/TO/sandbox.env&gt;
</code></pre>
</div>
</div>
<h2 id="sandbox-token-faucet"><a class="header" href="#sandbox-token-faucet">Sandbox Token Faucet</a></h2>
<p>To run your nodes in Sandbox environment, you need testnet version of NYM token, that can be aquired from <a href="https://faucet.nymtech.net">faucet.nymtech.net</a>.</p>
<p>To prevent abuse, the faucet is rate-limited - your request will fail if the requesting wallet already has 101 NYM tokens.</p>
<footer id="last-change">Last change: 2024-08-06, commit: <a href="https://github.com/nymtech/nym/commit/7e36595d8">7e36595d8</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="pre-built-binaries"><a class="header" href="#pre-built-binaries">Pre-built Binaries</a></h1>
<p>The <a href="https://github.com/nymtech/nym/releases">Github releases page</a> has pre-built binaries which should work on Ubuntu 20.04 and other Debian-based systems, but at this stage cannot be guaranteed to work everywhere.</p>
<p>If the pre-built binaries don’t work or are unavailable for your system, you will need to build the platform yourself.</p>
<h2 id="setup-binaries"><a class="header" href="#setup-binaries">Setup Binaries</a></h2>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable. Exchange with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<h3 id="download-binary"><a class="header" href="#download-binary">Download Binary</a></h3>
<ol>
<li>Open <a href="https://github.com/nymtech/nym/releases">Github releases page</a> and right click on the binary you want</li>
<li>Select <code>Copy Link</code></li>
<li>Open your VPS terminal in a directory where you want to download Nym binaries.</li>
<li>Download binary by running <code>wget &lt;BINARY_LINK&gt;</code> where <code>&lt;BINARY_LINK&gt;</code> shall be in your clipboard from point # 2.</li>
</ol>
<h3 id="make-executable"><a class="header" href="#make-executable">Make Executable</a></h3>
<ol start="5">
<li>Run command:</li>
</ol>
<pre><code class="language-sh">chmod +x &lt;BINARY&gt;
# for example: chmod +x nym-mixnode
</code></pre>
<h3 id="run-binary"><a class="header" href="#run-binary">Run Binary</a></h3>
<p>Now you can use your binary, initialise and run your Nym Node. Follow the guide according to the type of your binary.</p>
<p><strong>Node setup and usage guides:</strong></p>
<ul>
<li><a href="binaries/../nodes/nym-node.html">Nym Nodes</a></li>
<li><a href="binaries/../nodes/validator-setup.html">Validators</a></li>
</ul>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="building-from-source"><a class="header" href="#building-from-source">Building from Source</a></h1>
<blockquote>
<p>Nym runs on Mac OS X, Linux, and Windows. All nodes <strong>except the Desktop Wallet and NymConnect</strong> on Windows should be considered experimental - it works fine if you’re an app developer but isn’t recommended for running nodes.</p>
</blockquote>
<h2 id="building-nym"><a class="header" href="#building-nym">Building Nym</a></h2>
<p>Nym has two main codebases:</p>
<ul>
<li>the <a href="https://github.com/nymtech/nym">Nym platform</a>, written in Rust. This contains all of our code <em>except</em> for the validators.</li>
<li>the <a href="https://github.com/nymtech/nyxd">Nym validators</a>, written in Go.</li>
</ul>
<blockquote>
<p>This page details how to build the main Nym platform code. <strong>If you want to build and run a validator, <a href="binaries/../nodes/validator-setup.html">go here</a> instead.</strong></p>
</blockquote>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<ul>
<li>Debian/Ubuntu: <code>pkg-config</code>, <code>build-essential</code>, <code>libssl-dev</code>, <code>curl</code>, <code>jq</code>, <code>git</code></li>
</ul>
<pre><code>apt install pkg-config build-essential libssl-dev curl jq git
</code></pre>
<ul>
<li>Arch/Manjaro: <code>base-devel</code></li>
</ul>
<pre><code>pacman -S base-devel
</code></pre>
<ul>
<li>Mac OS X: <code>pkg-config</code> , <code>brew</code>, <code>openss1</code>, <code>protobuf</code>, <code>curl</code>, <code>git</code>
Running the following the script installs Homebrew and the above dependencies:</li>
</ul>
<pre><code>/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
</code></pre>
<ul>
<li><code>Rust &amp; cargo &gt;= 1.66</code></li>
</ul>
<p>We recommend using the <a href="https://www.rust-lang.org/tools/install">Rust shell script installer</a>. Installing cargo from your package manager (e.g. <code>apt</code>) is not recommended as the packaged versions are usually too old.</p>
<p>If you really don’t want to use the shell script installer, the <a href="https://forge.rust-lang.org/infra/other-installation-methods.html">Rust installation docs</a> contain instructions for many platforms.</p>
<h2 id="download-and-build-nym-binaries"><a class="header" href="#download-and-build-nym-binaries">Download and build Nym binaries</a></h2>
<p>The following commands will compile binaries into the <code>nym/target/release</code> directory:</p>
<pre><code class="language-sh">rustup update
git clone https://github.com/nymtech/nym.git
cd nym

git reset --hard # in case you made any changes on your branch
git pull # in case you've checked it out before

git checkout master # master branch has the latest release version: `develop` will most likely be incompatible with deployed public networks

cargo build --release # build your binaries with **mainnet** configuration
</code></pre>
<p>Quite a bit of stuff gets built. The key working parts are:</p>
<ul>
<li><a href="binaries/../nodes/nym-node.html">Nym Node</a>: <code>nym-node</code></li>
<li><a href="binaries/../nodes/validator-setup.html">Validator</a></li>
<li><a href="https://nymtech.net/developers/clients/websocket-client.html">websocket client</a>: <code>nym-client</code></li>
<li><a href="https://nymtech.net/developers/clients/socks5-client.html">socks5 client</a>: <code>nym-socks5-client</code></li>
<li><a href="https://nymtech.net/developers/clients/webassembly-client.html">webassembly client</a>: <code>webassembly-client</code></li>
<li><a href="https://nymtech.net/docs/tools/nym-cli.html">nym-cli tool</a>: <code>nym-cli</code></li>
<li><a href="binaries/../nodes/nym-api.html">nym-api</a>: <code>nym-api</code></li>
<li><a href="binaries/../nodes/nymvisor-upgrade.html">nymvisor</a>: <code>nymvisor</code></li>
</ul>
<p>The repository also contains Typescript applications which aren’t built in this process. These can be built by following the instructions on their respective docs pages.</p>
<ul>
<li><a href="https://nymtech.net/docs/wallet/desktop-wallet.html">Nym Wallet</a></li>
<li><a href="https://nymtech.net/docs/explorers/mixnet-explorer.html">Network Explorer UI</a></li>
</ul>
<blockquote>
<p>You cannot build from GitHub’s .zip or .tar.gz archive files on the releases page - the Nym build scripts automatically include the current git commit hash in the built binary during compilation, so the build will fail if you use the archive code (which isn’t a Git repository). Check the code out from github using <code>git clone</code> instead.</p>
</blockquote>
<footer id="last-change">Last change: 2024-08-06, commit: <a href="https://github.com/nymtech/nym/commit/7e36595d8">7e36595d8</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="preliminary-steps"><a class="header" href="#preliminary-steps">Preliminary Steps</a></h1>
<blockquote>
<p>The <code>nym-node</code> binary was built in the <a href="nodes/../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code, go there first.</p>
</blockquote>
<p>There are a couple of steps that need completing before starting to set up your <code>nym-node</code>:</p>
<ol>
<li><strong><a href="nodes/wallet-preparation.html">Prepare your wallet</a>:</strong> <a href="https://nymtech.net/docs/wallet/desktop-wallet.html">desktop</a> or <a href="https://nymtech.net/docs/wallet/cli-wallet.html">CLI</a>.</li>
<li><strong><a href="nodes/vps-setup.html">Requisition and setup a VPS</a></strong> (Virtual Private Server)</li>
</ol>
<p>Make sure to follow these steps carefully as it prevents a lot of troubleshooting later on.</p>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nym-wallet-preparation"><a class="header" href="#nym-wallet-preparation">Nym Wallet Preparation</a></h1>
<h2 id="mainnet"><a class="header" href="#mainnet">Mainnet</a></h2>
<p>Head to our <a href="https://nymtech.net/download/">website</a> and download the Nym wallet for your operating system. If pre-compiled binaries for your operating system aren’t available, you can build the wallet yourself with instructions <a href="https://nymtech.net/docs/wallet/desktop-wallet.html">here</a>.</p>
<p>If you don’t already have one, please create a Nym address using the wallet, and fund it with NYM tokens. The minimum amount required to bond a node is 100 <code>NYM</code>, but make sure you have a bit more to account for gas costs.</p>
<p><code>NYM</code> can be purchased via Bity from the wallet itself with BTC or fiat, and is currently present on several <a href="https://www.coingecko.com/en/coins/nym#markets">exchanges</a>.</p>
<blockquote>
<p>Remember that you can <strong>only</strong> use Cosmos <code>NYM</code> tokens to bond your node. You <strong>cannot</strong> use ERC20 representations of <code>NYM</code> to run a node.</p>
</blockquote>
<h2 id="sandbox-testnet-1"><a class="header" href="#sandbox-testnet-1">Sandbox testnet</a></h2>
<p>Make sure to download a wallet and create an account as outlined above. Then head to our <a href="https://matrix.to/#/#operators:nymtech.chat">Operators Element channel</a> and request testnet tokens.</p>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="vps-setup--configuration"><a class="header" href="#vps-setup--configuration">VPS Setup &amp; Configuration</a></h1>
<p>We aim for Nym Mixnet to be reliable and quality base layer of privacy accross the globe, while growing as distributed as possible. It’s essential to have a fine tuned machine as a foundation for the nodes to meet the requirements and be rewarded for their work.</p>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="nodes/vps-setup.html#admonition-info"></a>
</div>
<div>
<p>A suboptimally configured VPS often results in a non-functional node. To follow these steps carefully will save you time and money later on.</p>
</div>
</div>
<h2 id="vps-hardware-specs"><a class="header" href="#vps-hardware-specs">VPS Hardware Specs</a></h2>
<p>You will need to rent a VPS to run your node on. One key reason for this is that your node <strong>must be able to send TCP data using both IPv4 and IPv6</strong> (as other nodes you talk to may use either protocol).</p>
<p>Tor community created a very helpful table called <a href="https://community.torproject.org/relay/community-resources/good-bad-isps/"><em>Good Bad ISPs</em></a>, you can use that one as a guideline for your choice of ISP for your VPS.</p>
<p><strong>Update:</strong> Nym community started an ISP table called <a href="nodes/../legal/isp-list.html"><em>Where to host your nym node?</em></a>, check it out and add your findings!</p>
<h3 id="nym-node"><a class="header" href="#nym-node"><code>nym-node</code></a></h3>
<p>Before we conclude the testing with exact results, these are the rough specs:</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left"><strong>Hardware</strong></th><th style="text-align: right"><strong>Minimum Specification</strong> w</th></tr></thead><tbody>
<tr><td style="text-align: left">CPU Cores</td><td style="text-align: right">4</td></tr>
<tr><td style="text-align: left">Memory</td><td style="text-align: right">4 GB RAM</td></tr>
<tr><td style="text-align: left">Storage</td><td style="text-align: right">40 GB</td></tr>
<tr><td style="text-align: left">Connectivity</td><td style="text-align: right">IPv4, IPv6, TCP/IP, UDP</td></tr>
<tr><td style="text-align: left">Bandwidth</td><td style="text-align: right">1Tb</td></tr>
<tr><td style="text-align: left">Port speed</td><td style="text-align: right">1Gbps</td></tr>
</tbody></table>
</div>
<h3 id="nyx-validator"><a class="header" href="#nyx-validator">Nyx validator</a></h3>
<p>The specification mentioned below is for running a full node alongside the nym-api. It is recommended to run <code>nym-api</code> and a full Nyx node on the same machine for optimum performance.</p>
<p>Bear in mind that credential signing is primarily CPU-bound, so choose the fastest CPU available to you.</p>
<h4 id="minimum-requirements"><a class="header" href="#minimum-requirements">Minimum Requirements</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Hardware</th><th><strong>Minimum Specification</strong></th></tr></thead><tbody>
<tr><td>CPU</td><td>8-cores, 2.8GHz base clock speed or higher</td></tr>
<tr><td>RAM</td><td>16GB DDR4+</td></tr>
<tr><td>Disk</td><td>500 GiB+ NVMe SSD</td></tr>
</tbody></table>
</div>
<h4 id="recommended-requirements"><a class="header" href="#recommended-requirements">Recommended Requirements</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Hardware</th><th><strong>Minimum Specification</strong></th></tr></thead><tbody>
<tr><td>CPU</td><td>16-cores, 2.8GHz base clock speed or higher</td></tr>
<tr><td>RAM</td><td>32GB DDR4+</td></tr>
<tr><td>Disk</td><td>1 TiB+ NVMe SSD</td></tr>
</tbody></table>
</div>
<h4 id="full-node-configuration-validator"><a class="header" href="#full-node-configuration-validator">Full node configuration (validator)</a></h4>
<p>To install a full node from scratch, refer to the <a href="nodes/validator-setup.html">validator setup guide</a> and follow the steps outlined there.</p>
<h2 id="vps-configuration"><a class="header" href="#vps-configuration">VPS Configuration</a></h2>
<p>Before node or validator setup, the VPS needs to be configured and tested, to verify your connectivity and make sure that your provider wasn’t dishonest with the offered services.</p>
<div id="admonition-info-1" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-1-title">
<div class="admonition-title">
<div id="admonition-info-1-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="nodes/vps-setup.html#admonition-info-1"></a>
</div>
<div>
<p>The commands listed in this chapter must be executed with a prefix <code>sudo</code> or from a root shell.</p>
</div>
</div>
<h3 id="install-dependencies"><a class="header" href="#install-dependencies">Install Dependencies</a></h3>
<p>SSH to your server as <code>root</code> or become one running <code>sudo -i</code> or <code>su</code>. If you prefer to administrate your VPS from a user environment, supply the commands with prefix <code>sudo</code>.</p>
<p>Start with setting up the essential tools on your server.</p>
<pre><code class="language-sh"># get your system up to date
apt update -y &amp;&amp; apt --fix-broken install

# install dependencies
apt -y install ca-certificates jq curl wget ufw jq tmux pkg-config build-essential libssl-dev git

# double check ufw is installed correctly
apt install ufw --fix-missing
</code></pre>
<h3 id="configure-your-firewall"><a class="header" href="#configure-your-firewall">Configure your Firewall</a></h3>
<p>For a <code>nym-node</code> or Nyx validator to recieve traffic, you need to open ports on the server. The following commands will allow you to set up a firewall using <code>ufw</code>.</p>
<ol>
<li>Check <code>ufw</code>:</li>
</ol>
<pre><code class="language-sh"># check if you have ufw installed
ufw version

# if it is not installed, install with
apt install ufw -y

# enable ufw
ufw enable

# check the status of the firewall
ufw status
</code></pre>
<ol start="2">
<li>Open all needed ports to have your firewall for <code>nym-node</code> working correctly:</li>
</ol>
<pre><code class="language-sh">ufw allow 22/tcp    # SSH - you're in control of these ports
ufw allow 80/tcp    # HTTP
ufw allow 443/tcp   # HTTPS
ufw allow 1789/tcp  # Nym specific
ufw allow 1790/tcp  # Nym specific
ufw allow 8080/tcp  # Nym specific - nym-node-api
ufw allow 9000/tcp  # Nym Specific - clients port
ufw allow 9001/tcp  # Nym specific - wss port 
ufw allow 51822/udp # WireGuard
</code></pre>
<ul>
<li>In case of reverse proxy setup add:</li>
</ul>
<pre><code class="language-sh">ufw allow 443/tcp
</code></pre>
<ul>
<li>For validator setup open these ports:</li>
</ul>
<pre><code class="language-sh">ufw allow 1317,26656,26660,22,80,443/tcp
</code></pre>
<ol start="3">
<li>Check the status of the firewall:</li>
</ol>
<pre><code class="language-sh">ufw status
</code></pre>
<p>For more information about your node’s port configuration, check the <a href="nodes/vps-setup.html#ports-reference-table">port reference table</a> below.</p>
<h2 id="setting-the-ulimit"><a class="header" href="#setting-the-ulimit">Setting the ulimit</a></h2>
<p>Linux machines limit how many open files a user is allowed to have. This is called a <code>ulimit</code>.</p>
<p><code>ulimit</code> is 1024 by default on most systems. It needs to be set higher, because Nym Nodes make and receive a lot of connections with each others.</p>
<p>If you see errors such as:</p>
<pre><code class="language-sh">Failed to accept incoming connection - Os { code: 24, kind: Other, message: "Too many open files" }
</code></pre>
<p>This means that the operating system is preventing network connections from being made.</p>
<h3 id="set-the-ulimit-via-systemd-service-file"><a class="header" href="#set-the-ulimit-via-systemd-service-file">Set the <code>ulimit</code> via <code>systemd</code> service file</a></h3>
<blockquote>
<p><strong>Replace <code>&lt;NODE&gt;</code> variable with the name of your service, for example <code>nym-node</code></strong> as we migrated from <code>nym-mixnode</code>, <code>nym-gateway</code> and <code>nym-network-requester</code>.</p>
</blockquote>
<p>The ulimit setup is relevant for maintenance of Nym Node only.</p>
<p>Query the <code>ulimit</code> of your <code>&lt;NODE&gt;</code> with:</p>
<pre><code class="language-sh"># for nym-node
grep -i "open files" /proc/$(ps -A -o pid,cmd|grep &lt;NODE&gt; | grep -v grep |head -n 1 | awk '{print $1}')/limits

# for nyx validator
grep -i "open files" /proc/$(ps -A -o pid,cmd|grep nymd | grep -v grep |head -n 1 | awk '{print $1}')/limits
</code></pre>
<p>You’ll get back the hard and soft limits, which looks something like this:</p>
<pre><code class="language-sh">Max open files            65536                65536                files
</code></pre>
<p>If your output is <strong>the same as above</strong>, your node will not encounter any <code>ulimit</code> related issues.</p>
<p>However if either value is <code>1024</code>, you must raise the limit via the systemd service file. Add the line:</p>
<pre><code class="language-sh">LimitNOFILE=65536
</code></pre>
<p>Reload the daemon:</p>
<pre><code class="language-sh">systemctl daemon-reload
</code></pre>
<p>or execute this as root for system-wide setting of <code>ulimit</code>:</p>
<pre><code class="language-sh">echo "DefaultLimitNOFILE=65535" &gt;&gt; /etc/systemd/system.conf
</code></pre>
<p>Reboot your server, and restart your node. When it comes back, use:</p>
<pre><code class="language-sh"># for nym-node
cat /proc/$(pidof &lt;NODE&gt;)/limits | grep "Max open files"

# for validator
cat /proc/$(pidof nym-validator)/limits | grep "Max open files"
</code></pre>
<p>Make sure the limit has changed to <code>65535</code>.</p>
<h3 id="set-the-ulimit-on-non-systemd-based-distributions"><a class="header" href="#set-the-ulimit-on-non-systemd-based-distributions">Set the ulimit on <code>non-systemd</code> based distributions</a></h3>
<p>In case you chose tmux option for Nym Node automation, see your <code>ulimit</code> list by running:</p>
<pre><code class="language-sh">ulimit -a

# watch for the output line -n
-n: file descriptors          1024
</code></pre>
<p>You can change it either by running a command:</p>
<pre><code class="language-sh">ulimit -u -n 4096
</code></pre>
<p>or editing <code>etc/security/conf</code> and add the following lines:</p>
<pre><code class="language-sh"># Example hard limit for max opened files
username        hard nofile 4096

# Example soft limit for max opened files
username        soft nofile 4096
</code></pre>
<p>Then reboot your server and restart your node.</p>
<h2 id="ports-reference-tables"><a class="header" href="#ports-reference-tables">Ports reference tables</a></h2>
<p>All node-specific port configuration can be found in <code>$HOME/.nym/&lt;NODE&gt;/&lt;YOUR_ID&gt;/config/config.toml</code>. If you do edit any port configs, remember to restart your client and node processes.</p>
<h3 id="nym-node-port-reference"><a class="header" href="#nym-node-port-reference">Nym node port reference</a></h3>
<h4 id="mix-node-functionality-ports"><a class="header" href="#mix-node-functionality-ports">Mix Node functionality ports</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td><code>1789</code></td><td>Listen for Mixnet traffic</td></tr>
<tr><td><code>1790</code></td><td>Listen for VerLoc traffic</td></tr>
<tr><td><code>8080</code></td><td>Metrics http API endpoint</td></tr>
</tbody></table>
</div>
<h4 id="gateway-functionality-ports"><a class="header" href="#gateway-functionality-ports">Gateway functionality ports</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td><code>1789</code></td><td>Listen for Mixnet traffic</td></tr>
<tr><td><code>9000</code></td><td>Listen for Client traffic</td></tr>
<tr><td><code>9001</code></td><td>WSS</td></tr>
<tr><td><code>8080, 80, 443</code></td><td>Reversed Proxy &amp; Swagger page</td></tr>
<tr><td><code>51822/udp</code></td><td>WireGuard</td></tr>
</tbody></table>
</div>
<h4 id="embedded-network-requester-functionality-ports"><a class="header" href="#embedded-network-requester-functionality-ports">Embedded Network Requester functionality ports</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td><code>9000</code></td><td>Listen for Client traffic</td></tr>
</tbody></table>
</div>
<h3 id="validator-port-reference"><a class="header" href="#validator-port-reference">Validator port reference</a></h3>
<p>All validator-specific port configuration can be found in <code>$HOME/.nymd/config/config.toml</code>. If you do edit any port configs, remember to restart your validator.</p>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td><code>1317</code></td><td>REST API server endpoint</td></tr>
<tr><td><code>26656</code></td><td>Listen for incoming peer connections</td></tr>
<tr><td><code>26660</code></td><td>Listen for Prometheus connections</td></tr>
</tbody></table>
</div><footer id="last-change">Last change: 2024-08-13, commit: <a href="https://github.com/nymtech/nym/commit/da8e51362">da8e51362</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nym-node-1"><a class="header" href="#nym-node-1">Nym Node</a></h1>
<div id="admonition-note" class="admonition admonish-note" role="note" aria-labelledby="admonition-note-title">
<div class="admonition-title">
<div id="admonition-note-title">
<p>Note</p>
</div>
<a class="admonition-anchor-link" href="nodes/nym-node.html#admonition-note"></a>
</div>
<div>
<p>If you are a <code>nym-mixnode</code> or <code>nym-gateway</code> operator and you are not familiar with the binary changes called <em>Project Smoosh</em>, you can read the archived <a href="nodes/../archive/faq/smoosh-faq.html">Smoosh FAQ</a> page.</p>
</div>
</div>
<p>NYM NODE is a tool for running a node within the Nym network. Nym Nodes containing functionality such as <code>mixnode</code>, <code>entry-gateway</code> and <code>exit-gateway</code> are fundamental components of Nym Mixnet architecture. Nym Nodes are ran by decentralised node operators.</p>
<p>To setup any type of Nym Node, start with either building <a href="nodes/../binaries/building-nym.html">Nym’s platform</a> from source or download <a href="nodes/../binaries/pre-built-binaries.html">pre-compiled binaries</a> on the <a href="nodes/vps-setup.html">configured server (VPS)</a> where you want to run the node. Your Nym Node will need to be bonded before it can be run. We recommend most users use the <a href="nodes/wallet-preparation.html">Nym desktop wallet</a> for this.</p>
<p><strong>Follow <a href="nodes/preliminary-steps.html">preliminary steps</a> page before you configure and run a <code>nym-node</code>!</strong></p>
<h2 id="steps-for-nym-node-operators"><a class="header" href="#steps-for-nym-node-operators">Steps for Nym Node Operators</a></h2>
<p>Once <a href="nodes/preliminary-steps.html">VPS and Nym wallet are configured</a>, binaries ready, the operators of <code>nym-node</code> need to:</p>
<ol>
<li>
<p><strong><a href="nodes/setup.html">Setup</a> the node</strong></p>
</li>
<li>
<p><strong><a href="nodes/configuration.html">Configure</a> the node and optionally automation, Wireguard, WSS, reversed proxy …</strong></p>
</li>
<li>
<p><strong><a href="nodes/setup.html#initialise--run">Run</a> the node or <a href="nodes/configuration.html#following-steps-for-nym-nodes-running-as-systemd-service">the service</a></strong></p>
</li>
<li>
<p><strong><a href="nodes/bonding.html">Bond</a> the node to the Nym API, using Nym wallet</strong></p>
</li>
</ol>
<p>Make sure to follow the steps thoroughly, in case you find any point difficult don’t hesitate to ask in our <a href="https://matrix.to/#/#operators:nymtech.chat">Operators channel</a>.</p>
<!-- COMMENTING OUT

## Quick `nym-node --mode exit-gateway` Setup

During the testing events series [Fast and Furious](https://nymtech.net/events/fast-and-furious) we found out, that after introducing IP Packet Router and [Nym exit policy](https://nymtech.net/.wellknown/network-requester/exit-policy.txt) as default features,  only a fragment of Exit Gateways routes correctly through IPv4 and IPv6. We built a useful monitor to check out your Gateway (`nym-node --mode exit-gateway`) at [harbourmaster.nymtech.net](https://harbourmaster.nymtech.net/).

Below is a fast - *ten command* - deployment for seasoned operators to migrate and setup the node, configure networking and connectivity and verify that it all works as it should by getting two free jokes through the Mixnet.

```admonish caution
If you are not well familiar with `nym-node` setup, automation, and `nymtun0` configuration, follow the [steps above](#steps-for-nym-node-operators) page by page. You can use this flow as a reference later on.
```

1. [Get](../binaries/pre-built-binaries.md) or [build](../binaries/building-nym.md) the latest `nym-node` binary

2. Get [network_tunnel_manager.sh](https://gist.github.com/tommyv1987/ccf6ca00ffb3d7e13192edda61bb2a77) script and grant permissions
```sh
curl -o network_tunnel_manager.sh -L https://gist.githubusercontent.com/tommyv1987/ccf6ca00ffb3d7e13192edda61bb2a77/raw/9d785d6ee3aa2970553633eccbd89a827f49fab5/network_tunnel_manager.sh && chmod +x network_tunnel_manager.sh
```

3. In case you had a`nym-gateway` running, stop the process (directly or systemd service), and [**migrate to `nym-node`**](setup.md#migrate) now!

4. Apply the rules:
```sh
sudo ./network_tunnel_manager.sh apply_iptables_rules
```
5. Check Nymtun IP tables:
```sh
sudo ./network_tunnel_manager.sh check_nymtun_iptables
```

6. Display IPv6:
```sh
sudo ./network_tunnel_manager.sh fetch_and_display_ipv6
```
 - You should see a `global ipv6` address:
~~~admonish example collapsible=true title="Correct `./network_tunnel_manager.sh fetch_and_display_ipv6` output:"
```sh
iptables-persistent is already installed.
Using IPv6 address: 2001:db8:a160::1/112 #the address will be different for you
operation fetch_ipv6_address_nym_tun completed successfully.
```
~~~

7. (If you didn't have a `nym-node` service yet) Create `systemd` [automation and configuration file](configuration.md#systemd), reload and enable the service

8. Start `nym-node` service:
```sh
sudo service nym-node start && journalctl -u nym-node -f -n 100
```
9. Upgrade your node version in the smart contract, [using Nym wallet](manual-upgrade.md#step-2-updating-your-node-information-in-the-smart-contract)
  - If you don't run this as an upgrade but started a fresh new node, you need to [bond](bonding.md) the gateway now. After that finish the verification steps below.

10. After a minute of running properly, validate your `nymtun0` routing:

  - Display the address 
```sh
ip addr show nymtun0
```

~~~admonish example collapsible=true title="Correct `ip addr show nymtun0` output:"
```sh
# your addresses will be different
8: nymtun0: <POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP> mtu 1420 qdisc fq_codel state UNKNOWN group default qlen 500
    link/none
    inet 10.0.0.1/16 scope global nymtun0
       valid_lft forever preferred_lft forever
    inet6 2001:db8:a160::1/112 scope global
       valid_lft forever preferred_lft forever
    inet6 fe80::ad08:d167:5700:8c7c/64 scope link stable-privacy
       valid_lft forever preferred_lft forever`
```
~~~

  - Run a joke through the Mixnet - you should get two jokes (IPv4 and IPv6 routing):

```sh
sudo ./network_tunnel_manager.sh joke_through_the_mixnet
```

-->
<footer id="last-change">Last change: 2024-08-13, commit: <a href="https://github.com/nymtech/nym/commit/da8e51362">da8e51362</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nym-node-setup--run"><a class="header" href="#nym-node-setup--run">Nym Node Setup &amp; Run</a></h1>
<p>This documentation page provides a guide on how to set up and run a <a href="nodes/nym-node.html">NYM NODE</a>, along with explanations of available flags, commands, and examples.</p>
<h2 id="current-version"><a class="header" href="#current-version">Current version</a></h2>
<pre><code>nym-node 
Binary Name:        nym-node
Build Timestamp:    2024-09-06T08:45:16.313081654Z
Build Version:      1.1.6
Commit SHA:         3d200db722beab850ee7c80704ff4463817af9d7
Commit Date:        2024-08-06T17:14:17.000000000+02:00
Commit Branch:      master
rustc Version:      1.80.1
rustc Channel:      stable
cargo Profile:      release

</code></pre>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-info"></a>
</div>
<div>
<p><strong>Migrating an existing node to a new <code>nym-node</code> is simple. The steps are documented <a href="nodes/setup.html#migrate">below</a>.</strong></p>
</div>
</div>
<div id="admonition-note" class="admonition admonish-note" role="note" aria-labelledby="admonition-note-title">
<div class="admonition-title">
<div id="admonition-note-title">
<p>Note</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-note"></a>
</div>
<div>
<p>If you are a <code>nym-mixnode</code> or <code>nym-gateway</code> operator and you are not familiar with the binary changes called <em>Project Smoosh</em>, you can read the archived <a href="nodes/../archive/faq/smoosh-faq.html">Smoosh FAQ</a> page.</p>
</div>
</div>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable. Exchange with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<p>To run a new node, you can simply execute the <code>nym-node</code> command without any flags. By default, the node will set necessary configurations. If you later decide to change a setting, you can use the <code>-w</code> flag.</p>
<p>The most crucial aspect of running the node is specifying the <code>--mode</code>, which can be one of three: <code>mixnode</code>, <code>entry-gateway</code>, and <code>exit-gateway</code>.</p>
<p>Currently the <code>nym-node</code> binary can only be run in a single <code>--mode</code> at any one time. In the future however, operators will be able to specify multiple modes that a single <code>nym-node</code> binary can run. Our goal is to have as many nodes as possible enabling multiple modes, and allow the Nym API to position the node according the network’s needs in the beginning of each epoch.</p>
<p>Every <code>exit-gateway</code> mode is basically an <code>entry-gateway</code> with NR (Network Requester) and IPR (IP Packet Router) enabled. This means that every <code>exit-gateway</code> is automatically seen as an <code>entry-gateway</code> but not the opposite.</p>
<p>Gateway operators can check out the node performance, connectivity and much more in our new tool <a href="https://harbourmaster.nymtech.net/">harbourmaster.nymtech.net</a>.</p>
<p>To determine which mode your node is running, you can check the <code>:8080/api/v1/roles</code> endpoint. For example:</p>
<pre><code class="language-sh"># sustitude &lt;NODE_IP_ADDRESS&gt; or &lt;NODE_DOMAIN&gt; with a real one
# for http
http://&lt;NODE_IP_ADDRESS&gt;:8080/api/v1/roles
# or
http://&lt;NODE_IP_ADDRESS&gt;/api/v1/roles

# for reversed proxy/WSS
https://&lt;NODE_DOMAIN&gt;/api/v1/roles
</code></pre>
<p>Everything necessary will exist on your node by default. For instance, if you’re running a mixnode, you’ll find that a NR (Network Requester) and IPR (IP Packet Router) address exist, but they will be ignored in <code>mixnode</code> mode.</p>
<p>For more information about available endpoints and their status, you can refer to:</p>
<pre><code class="language-sh"># sustitude &lt;NODE_IP_ADDRESS&gt; or &lt;NODE_DOMAIN&gt; with a real one
# for http
http://&lt;NODE_IP_ADDRESS&gt;:8080/api/v1/swagger/#/
# or
http://&lt;NODE_IP_ADDRESS&gt;/api/v1/swagger/#/

# for reversed proxy/WSS
https://&lt;NODE_DOMAIN&gt;/api/v1/swagger/#/
</code></pre>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<h3 id="help-command"><a class="header" href="#help-command">Help Command</a></h3>
<p>There are a few changes from the individual binaries used in the past. For example by default <code>run</code> command does <code>init</code> function as well, local node <code>--id</code> will be set by default unless specified otherwise etcetera.</p>
<div id="admonition-info-1" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-1-title">
<div class="admonition-title">
<div id="admonition-info-1-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-info-1"></a>
</div>
<div>
<p>You can always use <code>--help</code> flag to see the commands or arguments associated with a given command.</p>
</div>
</div>
<p>Run <code>./nym-node --help</code> to see all available commands:</p>
<details id="admonition-nym-node---help-output" class="admonition admonish-example" role="note" aria-labelledby="admonition-nym-node---help-output-title">
<summary class="admonition-title">
<div id="admonition-nym-node---help-output-title">
<p><code>./nym-node --help</code> output:</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-nym-node---help-output"></a>
</summary>
<div>
<pre><code>Usage: nym-node [OPTIONS] &lt;COMMAND&gt;

Commands:
  build-info           Show build information of this binary
  bonding-information  Show bonding information of this node depending on its currently selected mode
  node-details         Show details of this node
  migrate              Attempt to migrate an existing mixnode or gateway into a nym-node
  run                  Start this nym-node
  sign                 Use identity key of this node to sign provided message
  help                 Print this message or the help of the given subcommand(s)

Options:
  -c, --config-env-file &lt;CONFIG_ENV_FILE&gt;
          Path pointing to an env file that configures the nym-node and overrides any preconfigured values [env: NYMNODE_CONFIG_ENV_FILE_ARG=]
      --no-banner
          Flag used for disabling the printed banner in tty [env: NYMNODE_NO_BANNER=]
  -h, --help
          Print help
  -V, --version
          Print version
</code></pre>
</div>
</details>
<p>To list all available flags for each command, run <code>./nym-node &lt;COMMAND&gt; --help</code> for example <code>./nym-node run --help</code>:</p>
<details id="admonition-nym-node-run---help-output" class="admonition admonish-example" role="note" aria-labelledby="admonition-nym-node-run---help-output-title">
<summary class="admonition-title">
<div id="admonition-nym-node-run---help-output-title">
<p><code>./nym-node run --help</code> output:</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-nym-node-run---help-output"></a>
</summary>
<div>
<pre><code>Start this nym-node

Usage: nym-node run [OPTIONS]

Options:
      --id &lt;ID&gt;
          Id of the nym-node to use [env: NYMNODE_ID=] [default: default-nym-node]
      --config-file &lt;CONFIG_FILE&gt;
          Path to a configuration file of this node [env: NYMNODE_CONFIG=]
      --accept-operator-terms-and-conditions
          Explicitly specify whether you agree with the terms and conditions of a nym node operator as defined at &lt;https://nymtech.net/terms-and-conditions/operators/v1.0.0&gt; [env: NYMNODE_ACCEPT_OPERATOR_TERMS=]
      --deny-init
          Forbid a new node from being initialised if configuration file for the provided specification doesn't already exist [env: NYMNODE_DENY_INIT=]
      --init-only
          If this is a brand new nym-node, specify whether it should only be initialised without actually running the subprocesses [env: NYMNODE_INIT_ONLY=]
      --local
          Flag specifying this node will be running in a local setting [env: NYMNODE_LOCAL=]
      --mode &lt;MODE&gt;
          Specifies the current mode of this nym-node [env: NYMNODE_MODE=] [possible values: mixnode, entry-gateway, exit-gateway]
  -w, --write-changes
          If this node has been initialised before, specify whether to write any new changes to the config file [env: NYMNODE_WRITE_CONFIG_CHANGES=]
      --bonding-information-output &lt;BONDING_INFORMATION_OUTPUT&gt;
          Specify output file for bonding information of this nym-node, i.e. its encoded keys. NOTE: the required bonding information is still a subject to change and this argument should be treated only as a preview of future features [env: NYMNODE_BONDING_INFORMATION_OUTPUT=]
  -o, --output &lt;OUTPUT&gt;
          Specify the output format of the bonding information (`text` or `json`) [env: NYMNODE_OUTPUT=] [default: text] [possible values: text, json]
      --public-ips &lt;PUBLIC_IPS&gt;
          Comma separated list of public ip addresses that will be announced to the nym-api and subsequently to the clients. In nearly all circumstances, it's going to be identical to the address you're going to use for bonding [env: NYMNODE_PUBLIC_IPS=]
      --hostname &lt;HOSTNAME&gt;
          Optional hostname associated with this gateway that will be announced to the nym-api and subsequently to the clients [env: NYMNODE_HOSTNAME=]
      --location &lt;LOCATION&gt;
          Optional **physical** location of this node's server. Either full country name (e.g. 'Poland'), two-letter alpha2 (e.g. 'PL'), three-letter alpha3 (e.g. 'POL') or three-digit numeric-3 (e.g. '616') can be provided [env: NYMNODE_LOCATION=]
      --http-bind-address &lt;HTTP_BIND_ADDRESS&gt;
          Socket address this node will use for binding its http API. default: `0.0.0.0:8080` [env: NYMNODE_HTTP_BIND_ADDRESS=]
      --landing-page-assets-path &lt;LANDING_PAGE_ASSETS_PATH&gt;
          Path to assets directory of custom landing page of this node [env: NYMNODE_HTTP_LANDING_ASSETS=]
      --http-access-token &lt;HTTP_ACCESS_TOKEN&gt;
          An optional bearer token for accessing certain http endpoints. Currently only used for prometheus metrics [env: NYMNODE_HTTP_ACCESS_TOKEN=]
      --expose-system-info &lt;EXPOSE_SYSTEM_INFO&gt;
          Specify whether basic system information should be exposed. default: true [env: NYMNODE_HTTP_EXPOSE_SYSTEM_INFO=] [possible values: true, false]
      --expose-system-hardware &lt;EXPOSE_SYSTEM_HARDWARE&gt;
          Specify whether basic system hardware information should be exposed. default: true [env: NYMNODE_HTTP_EXPOSE_SYSTEM_HARDWARE=] [possible values: true, false]
      --expose-crypto-hardware &lt;EXPOSE_CRYPTO_HARDWARE&gt;
          Specify whether detailed system crypto hardware information should be exposed. default: true [env: NYMNODE_HTTP_EXPOSE_CRYPTO_HARDWARE=] [possible values: true, false]
      --mixnet-bind-address &lt;MIXNET_BIND_ADDRESS&gt;
          Address this node will bind to for listening for mixnet packets default: `0.0.0.0:1789` [env: NYMNODE_MIXNET_BIND_ADDRESS=]
      --nym-api-urls &lt;NYM_API_URLS&gt;
          Addresses to nym APIs from which the node gets the view of the network [env: NYMNODE_NYM_APIS=]
      --nyxd-urls &lt;NYXD_URLS&gt;
          Addresses to nyxd chain endpoint which the node will use for chain interactions [env: NYMNODE_NYXD=]
      --wireguard-enabled &lt;WIREGUARD_ENABLED&gt;
          Specifies whether the wireguard service is enabled on this node [env: NYMNODE_WG_ENABLED=] [possible values: true, false]
      --wireguard-bind-address &lt;WIREGUARD_BIND_ADDRESS&gt;
          Socket address this node will use for binding its wireguard interface. default: `0.0.0.0:51822` [env: NYMNODE_WG_BIND_ADDRESS=]
      --wireguard-private-ip &lt;WIREGUARD_PRIVATE_IP&gt;
          Private IP address of the wireguard gateway. default: `10.1.0.1` [env: NYMNODE_WG_IP=]
      --wireguard-announced-port &lt;WIREGUARD_ANNOUNCED_PORT&gt;
          Port announced to external clients wishing to connect to the wireguard interface. Useful in the instances where the node is behind a proxy [env: NYMNODE_WG_ANNOUNCED_PORT=]
      --wireguard-private-network-prefix &lt;WIREGUARD_PRIVATE_NETWORK_PREFIX&gt;
          The prefix denoting the maximum number of the clients that can be connected via Wireguard. The maximum value for IPv4 is 32 and for IPv6 is 128 [env: NYMNODE_WG_PRIVATE_NETWORK_PREFIX=]
      --verloc-bind-address &lt;VERLOC_BIND_ADDRESS&gt;
          Socket address this node will use for binding its verloc API. default: `0.0.0.0:1790` [env: NYMNODE_VERLOC_BIND_ADDRESS=]
      --entry-bind-address &lt;ENTRY_BIND_ADDRESS&gt;
          Socket address this node will use for binding its client websocket API. default: `0.0.0.0:9000` [env: NYMNODE_ENTRY_BIND_ADDRESS=]
      --announce-ws-port &lt;ANNOUNCE_WS_PORT&gt;
          Custom announced port for listening for websocket client traffic. If unspecified, the value from the `bind_address` will be used instead [env: NYMNODE_ENTRY_ANNOUNCE_WS_PORT=]
      --announce-wss-port &lt;ANNOUNCE_WSS_PORT&gt;
          If applicable, announced port for listening for secure websocket client traffic [env: NYMNODE_ENTRY_ANNOUNCE_WSS_PORT=]
      --enforce-zk-nyms &lt;ENFORCE_ZK_NYMS&gt;
          Indicates whether this gateway is accepting only coconut credentials for accessing the mixnet or if it also accepts non-paying clients [env: NYMNODE_ENFORCE_ZK_NYMS=] [possible values: true, false]
      --mnemonic &lt;MNEMONIC&gt;
          Custom cosmos wallet mnemonic used for zk-nym redemption. If no value is provided, a fresh mnemonic is going to be generated [env: NYMNODE_MNEMONIC=]
      --upstream-exit-policy-url &lt;UPSTREAM_EXIT_POLICY_URL&gt;
          Specifies the url for an upstream source of the exit policy used by this node [env: NYMNODE_UPSTREAM_EXIT_POLICY=]
      --open-proxy &lt;OPEN_PROXY&gt;
          Specifies whether this exit node should run in 'open-proxy' mode and thus would attempt to resolve **ANY** request it receives [env: NYMNODE_OPEN_PROXY=] [possible values: true, false]
  -h, --help
          Print help
</code></pre>
</div>
</details>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-warning"></a>
</div>
<div>
<p>The Wireguard flags currently have limited functionality. From version <code>1.1.6</code> (<a href="https://github.com/nymtech/nym/releases/tag/nym-binaries-v2024.9-topdeck"><code>v2024.9-topdeck</code></a>) wireguard is available and recommended to be switched on for nodes running as Gateways. Keep in mind that this option needs a bit of a special <a href="nodes/configuration.html#wireguard-setup">configuration</a>.</p>
</div>
</div>
<h3 id="terms--conditions"><a class="header" href="#terms--conditions">Terms &amp; Conditions</a></h3>
<div id="admonition-info-2" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-2-title">
<div class="admonition-title">
<div id="admonition-info-2-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-info-2"></a>
</div>
<div>
<p>From <code>nym-node</code> version <code>1.1.3</code> onward is required to accept <a href="https://nymtech.net/terms-and-conditions/operators/v1.0.0"><strong>Operators Terms &amp; Conditions</strong></a> in order to be part of the active set. Make sure to read them before you add the flag.</p>
</div>
</div>
<p>There has been a long ongoing discussion whether and how to apply Terms and Conditions for Nym network operators, with an aim to stay aligned with the philosophy of Free Software and provide legal defense for both node operators and Nym developers. To understand better the reasoning behind this decision, you can listen to the first <a href="https://www.youtube.com/live/7hwb8bAZIuc?si=3mQ2ed7AyUA1SsCp&amp;t=915">Nym Operator Town Hall</a> introducing the T&amp;Cs or to <a href="https://www.youtube.com/watch?v=yIN-zYQw0I0">Operator AMA with CEO Harry Halpin</a> from June 4th, 2024, explaining pros and cons of T&amp;Cs implementation.</p>
<p>Accepting T&amp;Cs is done via a flag <code>--accept-operator-terms-and-conditions</code> added explicitly to <code>nym-node run</code> command every time. If you use <a href="nodes/configuration.html#systemd">systemd</a> automation, add the flag to your service file’s <code>ExecStart</code> line.</p>
<p>To check whether any node has T&amp;Cs accepted or not can be done by querying Swagger API endpoint <code>/auxiliary_details</code> via one of these ports (depending on node setup):</p>
<pre><code class="language-sh"># sustitude &lt;NODE_IP_ADDRESS&gt; or &lt;NODE_DOMAIN&gt; with a real one
http://&lt;NODE_IP_ADDRESS&gt;:8080/api/v1/auxiliary_details
https://&lt;NODE_DOMAIN&gt;/api/v1/auxiliary_details
http://&lt;NODE_IP_ADDRESS&gt;/api/v1/auxiliary_details
</code></pre>
<details id="admonition-example-of-auxiliary_details-query" class="admonition admonish-example" role="note" aria-labelledby="admonition-example-of-auxiliary_details-query-title">
<summary class="admonition-title">
<div id="admonition-example-of-auxiliary_details-query-title">
<p>Example of <code>/auxiliary_details</code> query</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-example-of-auxiliary_details-query"></a>
</summary>
<div>
<pre><code class="language-sh"># substitude &lt;NODE_IP_ADDRESS&gt; with a real one
curl -X 'GET' \
  'http://&lt;NODE_IP_ADDRESS&gt;:8080/api/v1/auxiliary-details' \
  -H 'accept: application/json'

{
  "location": "Kurdistan",
  "accepted_operator_terms_and_conditions": true
}
</code></pre>
</div>
</details>
<h3 id="commands--examples"><a class="header" href="#commands--examples">Commands &amp; Examples</a></h3>
<p><strong><code>nym-node</code> introduces a default human readible ID (local only) <code>default-nym-node</code>, which is used if there is not an explicit custom <code>--id &lt;ID&gt;</code> specified. All configuration is stored in <code>~/.nym/nym-nodes/default-nym-node/config/config.toml</code> or <code>~/.nym/nym-nodes/&lt;ID&gt;/config/config.toml</code> respectively.</strong></p>
<div id="admonition-info-3" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-3-title">
<div class="admonition-title">
<div id="admonition-info-3-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-info-3"></a>
</div>
<div>
<p>All commands with more options listed below include <code>--accept-operator-terms-and-conditions</code> flag, read <a href="nodes/setup.html#terms--conditions">Terms &amp; Conditions</a> chapter above before executing these commands.</p>
</div>
</div>
<h3 id="initialise--run"><a class="header" href="#initialise--run">Initialise &amp; Run</a></h3>
<p>When we use <code>run</code> command the node will do <code>init</code> as well, unless we specify with a flag <code>--deny-init</code>. Below are some examples of initialising and running <code>nym-node</code> with different modes (<code>--mode</code>) like <code>mixnode</code>, <code>entry-gateway</code>, <code>exit-gateway</code>.</p>
<p>Please keep in mind that currently you can run only one functionality (<code>--mode</code>) per a <code>nym-node</code> instance. We are yet to finalise implement the multi-functionality solution under one node bonded to one Nyx account. Every <code>exit-gateway</code> can function as <code>entry-gateway</code> by default, not vice versa.</p>
<p>There is a simple default command to initialise and run your node: <code>./nym-node  run  --mode &lt;MODE&gt;</code>, however there quite a few parameters to be configured. When <code>nym-node</code> gets to be <code>run</code>, these parameters are read by the binary from the configuration file located at <code>.nym/nym-nodes/&lt;ID&gt;/config/config.toml</code>.</p>
<p>If an operator specifies any paramteres with optional flags alongside <code>run</code> command, these parameters passed in the option will take place over the ones in <code>config.toml</code> but they will not overwrite them by default. To overwrite them with the values passed with <code>run</code> command, a flag <code>-w</code> (<code>--write-changes</code>)  must be added.</p>
<p>Alternatively operators can just open a text editor and change these values manually. After saving the file,don’t forget to restart the node or reload and restart the service. If all values are setup correctly in <code>config.toml</code>, then operator can use as simple command as <code>nym-node run --mode &lt;MODE&gt; --accept-operators-terms-and-conditions</code>, or alternatively paste this command with a correct path to your binary to your <code>ExecStart</code> line into a <a href="nodes/configuration.html#systemd">systemd <code>nym-node.service</code></a> config file.</p>
<div id="admonition-default" class="admonition admonish-success" role="note">
<div>
<p><strong>We recommend operators to setup an <a href="nodes/configuration.html#systemd">automation</a> flow for their nodes, using systemd!</strong></p>
<p>In such case, you can <code>run</code> a node to initalise it or try if everything works, but then stop the proces and paste your entire <code>run</code> command syntax (below) to the <code>ExecStart</code> line of your <code>/etc/systemd/system/nym-node.service</code> and start the node as a <a href="nodes/configuration.html#following-steps-for-nym-nodes-running-as-systemd-service">service</a>.</p>
</div>
</div>
<h4 id="essential-parameters--variables"><a class="header" href="#essential-parameters--variables">Essential Parameters &amp; Variables</a></h4>
<p>Running a <code>nym-node</code> in a <code>mixnode</code> mode requires less configuration than a full <code>exit-gateway</code> setup, we recommend operators to still follow through with all documented <a href="nodes/configuration.html">configuration</a>. Before you scroll down to syntax examples for the mode of your choice: <a href="nodes/setup.html#mode-miznode"><code>mixnode</code></a>, <a href="nodes/setup.html#mode-exit-gateway"><code>exit-gateway</code></a>, or <a href="nodes/setup.html#mode-entry-gateway">`entry-gateway</a>, please familiarise yourself with the essential paramters and variables convention we use in the guide.</p>
<p>Substitute any variables in <code>&lt;&gt;</code> brackets your own value, without <code>&lt;&gt;</code> brackets. Here is a list of important options and variables.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Flag (Option)</th><th style="text-align: left">Variable</th><th style="text-align: left">Description</th><th style="text-align: left">Syntax example</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>--mode</code></td><td style="text-align: left"><code>&lt;MODE&gt;</code></td><td style="text-align: left">A functionality of your <code>nym-node</code> in the mixnet - mandatory! Chose from <code>entry-gateway</code>, <code>mixnode</code> or <code>exit-gateway</code></td><td style="text-align: left"><code>--mode exit-gateway</code></td></tr>
<tr><td style="text-align: left"><code>--id</code></td><td style="text-align: left"><code>&lt;ID&gt;</code></td><td style="text-align: left">A local only <code>nym-node</code> identifier, specified by flag <code>--id</code>. Not mandatory as it defaults to <code>default-nym-node</code> if not specified.</td><td style="text-align: left"><code>--id alice_super_node</code></td></tr>
<tr><td style="text-align: left"><code>-w</code> or <code>--write-changes</code></td><td style="text-align: left"><em>none</em></td><td style="text-align: left">Specify whether to write new changes - the values of other flags in the given command - to the config file</td><td style="text-align: left"><code>--write-changes</code></td></tr>
<tr><td style="text-align: left"><code>--accept-operator-terms-and-conditions</code></td><td style="text-align: left"><em>none</em></td><td style="text-align: left">A flag added explicitly to <code>nym-node run</code> command every time, showing that the operator agreed with <a href="nodes/setup.html#terms--conditions">T&amp;Cs</a></td><td style="text-align: left"><code>--accept-operator-terms-and-conditions</code></td></tr>
<tr><td style="text-align: left"><code>--public-ips</code></td><td style="text-align: left"><code>&lt;PUBLIC_IPS&gt;</code></td><td style="text-align: left">IPv4 of the <code>nym-node</code> server - mandatory! Use this address as a <code>host</code> value for bonding.Use this address as a <code>host</code> value for bonding.</td><td style="text-align: left"><code>--public-ips "$(curl -4 https://ifconfig.me)"</code></td></tr>
<tr><td style="text-align: left"><code>--mixnet-bind-address</code></td><td style="text-align: left"><code>&lt;MIXNET_BIND_ADDRESS&gt;</code></td><td style="text-align: left">Address to bind to for listening for mixnet packets - mandatory! Must be on port <code>1789</code>!</td><td style="text-align: left"><code>--mixnet-bind-address 0.0.0.0:1789</code></td></tr>
<tr><td style="text-align: left"><code>--http-bind-address</code></td><td style="text-align: left"><code>&lt;HTTP_BIND_ADDRESS&gt;</code></td><td style="text-align: left">Socket address this node will use for binding its http API - mandatory! Must be on port <code>8080</code>!</td><td style="text-align: left"><code>--http-bind-address 0.0.0.0:8080</code></td></tr>
<tr><td style="text-align: left"><code>--hostname</code></td><td style="text-align: left"><code>&lt;HOSTNAME&gt;</code></td><td style="text-align: left">Your registered DNS domain, asigned to the VPS with <code>nym-node</code>. Use without prefix like <code>http://</code> or <code>https://</code></td><td style="text-align: left"><code>exit-gateway1.squad.nsl</code></td></tr>
<tr><td style="text-align: left"><code>--location</code></td><td style="text-align: left"><code>&lt;LOCATION&gt;</code></td><td style="text-align: left">Loacation of your node. Formats like ‘Jamaica’,  or two-letter alpha2 (e.g. ‘JM’), three-letter alpha3 (e.g. ‘JAM’) or three-digit numeric-3 (e.g. ‘388’) can be provided.</td><td style="text-align: left"><code>--location JAM</code></td></tr>
<tr><td style="text-align: left"><code>--wireguard-private-ip</code></td><td style="text-align: left"><code>&lt;WIREGUARD_PRIVATE_IP&gt;</code></td><td style="text-align: left">Private IP address of the wireguard gateway. This mandatory field is set to a correct default: <code>10.1.0.1</code>, operators upgrading from older versions must overwrite it.</td><td style="text-align: left"><code>--wireguard-private-ip 10.1.0.1</code></td></tr>
<tr><td style="text-align: left"><code>--wireguard-enabled</code></td><td style="text-align: left"><code>&lt;WIREGUARD_ENABLED&gt;</code></td><td style="text-align: left">Specifies whether the wireguard service is enabled, possible values: <code>true</code> or <code>false</code> - <code>true</code> is recommended</td><td style="text-align: left"><code>--wireguard-enabled true</code></td></tr>
<tr><td style="text-align: left"><code>--expose-system-info</code></td><td style="text-align: left"><code>&lt;EXPOSE_SYSTEM_INFO&gt;</code></td><td style="text-align: left">Specify whether basic system information should be exposed. default: <code>true</code>, possible values: <code>true</code> or <code>false</code></td><td style="text-align: left"><code>--expose-system-info false</code></td></tr>
<tr><td style="text-align: left"><code>--expose-system-hardware</code></td><td style="text-align: left"><code>&lt;EXPOSE_SYSTEM_HARDWARE&gt;</code></td><td style="text-align: left">Specify whether basic system hardware information should be exposed. default: <code>true</code>, possible values: <code>true</code> or <code>false</code></td><td style="text-align: left"><code>--expose-system-hardware false</code></td></tr>
<tr><td style="text-align: left"><em>not a flag</em></td><td style="text-align: left"><code>&lt;PATH_TO&gt;</code></td><td style="text-align: left">Specify a full path to the given file, directory or binary behind this variable</td><td style="text-align: left"><code>/root/src/nym/target/release/</code></td></tr>
</tbody></table>
</div><div id="admonition-note-1" class="admonition admonish-note" role="note" aria-labelledby="admonition-note-1-title">
<div class="admonition-title">
<div id="admonition-note-1-title">
<p>Note</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-note-1"></a>
</div>
<div>
<p>To prevent over-flooding of our documentation we cannot provide with every single command syntax as there is a large combination of possibilities. Please use a common sense and the explanation in <code>--help</code> option.</p>
</div>
</div>
<h4 id="mode-exit-gateway"><a class="header" href="#mode-exit-gateway">Mode: <code>exit-gateway</code></a></h4>
<p>If you run a <code>nym-node</code> for the first time, you will need to specify a few parameters, please read the section <a href="nodes/setup.html#essential-paramteters--varibles">Essential Parameters &amp; Variables</a> before you start and make sure that your <code>nym-node</code> is up to date with the <a href="https://github.com/nymtech/nym/releases/">latest version</a>.</p>
<p><strong>Initialise and run</strong> in one command:</p>
<p>To initialise and test run your node, use this command:</p>
<pre><code class="language-sh">./nym-node run --id &lt;ID&gt; --mode exit-gateway --public-ips "$(curl -4 https://ifconfig.me)" --hostname "&lt;HOSTNAME&gt;" --http-bind-address 0.0.0.0:8080 --mixnet-bind-address 0.0.0.0:1789 --location &lt;LOCATION&gt; --accept-operator-terms-and-conditions --wireguard-enabled true
</code></pre>
<p>If you prefer to have a generic local identifier set to <code>default-nym-node</code>, skip <code>--id</code> option.</p>
<p>We highly recommend to setup <a href="nodes/proxy-configuration.html">reverse proxy and WSS</a> for <code>nym-node</code>. If you haven’t configured any of that, skip <code>--hostname</code> flag.</p>
<p>In any case <code>--public-ips</code> is a necessity for your node to bond to API and communicate with the internet.</p>
<p><strong>Initialise only</strong> without running the node with <code>--init-only</code> command:</p>
<p>Adding <code>--init-only</code> option results in <code>nym-node</code> initialising a configuration file <code>config.toml</code> without running - a good option for an initial node setup. Remember that if you using this flag on a node which already has a config file, this will not over-write the values, unless used with a specified flag <code>--write-changes</code> (<code>-w</code>) - a good option for introducing changes to your <code>config.toml</code> file.</p>
<pre><code class="language-sh">./nym-node run --id &lt;ID&gt; --init-only --mode exit-gateway --public-ips "$(curl -4 https://ifconfig.me)" --hostname "&lt;HOSTNAME&gt;" --http-bind-address 0.0.0.0:8080 --mixnet-bind-address 0.0.0.0:1789 --location &lt;LOCATION&gt; --wireguard-enabled true
</code></pre>
<p>In the example above we dropped <code>--accept-operator-terms-and-conditions</code> as the flag must be added to a running command explicitly and it is not stored in the config, <code>--init-only</code> will not run the node.</p>
<p><strong>Deny init</strong></p>
<p><code>--deny-init</code> was introduced as an additional safety for migration from legacy binaries to <code>nym-node</code> to prevent operators initialise over existing nodes. For most of the operators, this flag is not needed.</p>
<p>In this example we run the node with custom <code>--id</code> without initialising, using <code>--deny-init</code> command:</p>
<pre><code class="language-sh">./nym-node run --id &lt;ID&gt; --deny-init --mode exit-gateway --accept-operator-terms-and-conditions
</code></pre>
<h4 id="mode-entry-gateway"><a class="header" href="#mode-entry-gateway">Mode: <code>entry-gateway</code></a></h4>
<p>If you run a <code>nym-node</code> for the first time, you will need to specify a few parameters, please read the section <a href="nodes/setup.html#essential-paramteters--varibles">Essential Parameters &amp; Variables</a> before you start and make sure that your <code>nym-node</code> is up to date with the <a href="https://github.com/nymtech/nym/releases/">latest version</a>.</p>
<p><strong>Initialise and run:</strong></p>
<p>To initialise and test run with yur node with all needed options, use this command:</p>
<pre><code class="language-sh">./nym-node run --id &lt;ID&gt; --mode entry-gateway --public-ips "$(curl -4 https://ifconfig.me)" --hostname "&lt;HOSTNAME&gt;" --http-bind-address 0.0.0.0:8080 --mixnet-bind-address 0.0.0.0:1789 --location &lt;LOCATION&gt; --accept-operator-terms-and-conditions --wireguard-enabled true
</code></pre>
<p>If you prefer to have a generic local identifier set to <code>default-nym-node</code>, skip <code>--id</code> option.</p>
<p>We highly recommend to setup <a href="nodes/proxy-configuration.html">reverse proxy and WSS</a> for <code>nym-node</code>. If you haven’t configured any of that, skip <code>--hostname</code> flag.</p>
<p>In any case <code>--public-ips</code> is a necessity for your node to bond to API and communicate with the internet.</p>
<p><strong>Initialise only</strong> without running the node with <code>--init-only</code> command :</p>
<p>Adding <code>--init-only</code> option results in <code>nym-node</code> initialising a configuration file <code>config.toml</code> without running - a good option for an initial node setup. Remember that if you using this flag on a node which already has a config file, this will not over-write the values, unless used with a specified flag <code>--write-changes</code> (<code>-w</code>) - a good option for introducing changes to your <code>config.toml</code> file.</p>
<pre><code class="language-sh">./nym-node run --id &lt;ID&gt; --init-only --mode entry-gateway --public-ips "$(curl -4 https://ifconfig.me)" --hostname "&lt;HOSTNAME&gt;" --http-bind-address 0.0.0.0:8080 --mixnet-bind-address 0.0.0.0:1789 --location &lt;LOCATION&gt; --wireguard-enabled true
</code></pre>
<p>In the example above we dropped <code>--accept-operator-terms-and-conditions</code> as the flag must be added to a running command explicitly and it is not stored in the config, <code>--init-only</code> will not run the node.</p>
<p><strong>Deny init</strong></p>
<p><code>--deny-init</code> was introduced as an additional safety for migration from legacy binaries to <code>nym-node</code> to prevent operators initialise over existing nodes. For most of the operators, this flag is not needed.</p>
<p>In this example we run the node with custom <code>--id</code> without initialising, using <code>--deny-init</code> command:</p>
<pre><code class="language-sh">./nym-node run --id &lt;ID&gt; --deny-init --mode entry-gateway --accept-operator-terms-and-conditions
</code></pre>
<h4 id="mode-mixnode"><a class="header" href="#mode-mixnode">Mode: <code>mixnode</code></a></h4>
<p><strong>Initialise and run:</strong></p>
<pre><code class="language-sh">./nym-node run --mode mixnode --mixnet-bind-address 0.0.0.0:1789 --verloc-bind-address 0.0.0.0:1790 --http-bind-address 0.0.0.0:8080 --public-ips "$(curl -4 https://ifconfig.me)" --accept-operator-terms-and-conditions
</code></pre>
<p><strong>Init only</strong></p>
<p>Adding <code>--init-only</code> option results in <code>nym-node</code> initialising a configuration file <code>config.toml</code> without running - a good option for an initial node setup. Remember that if you using this flag on a node which already has a config file, this will not over-write the values, unless used with a specified flag <code>--write-changes</code> (<code>-w</code>) - a good option for introducing changes to your <code>config.toml</code> file.</p>
<p>Initialise only with a custom <code>--id</code> and <code>--init-only</code> command:</p>
<pre><code class="language-sh">./nym-node run --mode mixnode --id &lt;ID&gt; --init-only --mixnet-bind-address 0.0.0.0:1789 --verloc-bind-address 0.0.0.0:1790 --http-bind-address 0.0.0.0:8080 --public-ips "$(curl -4 https://ifconfig.me)" --accept-operator-terms-and-conditions
</code></pre>
<p>If you prefer to have a generic local identifier set to <code>default-nym-node</code>, skip <code>--id</code> option.</p>
<p><strong>Deny init</strong></p>
<p><code>--deny-init</code> was introduced as an additional safety for migration from legacy binaries to <code>nym-node</code> to prevent operators initialise over existing nodes. For most of the operators, this flag is not needed.</p>
<p>In this example we run the node with custom <code>--id</code> without initialising, using <code>--deny-init</code> command:</p>
<pre><code class="language-sh">./nym-node run --mode mixnode --id &lt;ID&gt; --deny-init --accept-operator-terms-and-conditions
</code></pre>
<h3 id="migrate"><a class="header" href="#migrate">Migrate</a></h3>
<div id="admonition-caution" class="admonition admonish-warning" role="note" aria-labelledby="admonition-caution-title">
<div class="admonition-title">
<div id="admonition-caution-title">
<p>Caution</p>
</div>
<a class="admonition-anchor-link" href="nodes/setup.html#admonition-caution"></a>
</div>
<div>
<p>Migration is a must for all deprecated nodes (<code>nym-mixnode</code>, <code>nym-gateway</code>). For backward compatibility we created an <a href="nodes/../archive/nodes/setup-guides.html">archive section</a> with all the guides for individual binaries. However, the binaries from version 1.1.35 (<code>nym-gateway</code>) and 1.1.37 (<code>nym-mixnode</code>) onwards will no longer have <code>init</code> command.</p>
</div>
</div>
<p>Operators who are about to migrate their nodes need to configure their <a href="nodes/vps-setup.html">VPS</a> and setup <code>nym-node</code> which can be downloaded as a <a href="nodes/../binaries/pre-built-binaries.html">pre-built binary</a> or compiled from <a href="nodes/../binaries/building-nym.html">source</a>.</p>
<p>To migrate a <code>nym-mixnode</code> or a <code>nym-gateway</code> to <code>nym-node</code> is fairly simple, use the <code>migrate</code> command with <code>--config-file</code> flag pointing to the original <code>config.toml</code> file, with a conditional argument defining which type of node this configuration belongs to. Examples are below.</p>
<p>Make sure to use <code>--deny-init</code> flag to prevent initialisation of a new node.</p>
<h4 id="mode-mixnode-1"><a class="header" href="#mode-mixnode-1">Mode: <code>mixnode</code></a></h4>
<pre><code class="language-sh"># move relevant infor from config.toml
./nym-node migrate --config-file ~/.nym/mixnodes/&lt;MIXNODE_ID&gt;/config/config.toml mixnode

# initialise with the new nym-node config
./nym-node run --mode mixnode --id &lt;NYM-NODE_ID&gt; --accept-operator-terms-and-conditions
</code></pre>
<h4 id="mode-entry-gateway-and-exit-gateway"><a class="header" href="#mode-entry-gateway-and-exit-gateway">Mode: <code>entry-gateway</code> and <code>exit-gateway</code></a></h4>
<pre><code class="language-sh"># move relevant infor from config.toml
./nym-node migrate --config-file ~/.nym/gateways/&lt;GATEWAY_ID&gt;/config/config.toml gateway

# initialise with the new nym-node config - entry-gateway
./nym-node run --mode entry-gateway --id &lt;NYM-NODE_ID&gt; --accept-operator-terms-and-conditions

# or as exit-gateway
./nym-node run --id &lt;NYM-NODE_ID&gt; --mode exit-gateway --public-ips "$(curl -4 https://ifconfig.me)" --hostname "&lt;YOUR_DOMAIN&gt;" --http-bind-address 0.0.0.0:8080 --mixnet-bind-address 0.0.0.0:1789 --location &lt;COUNTRY_FULL_NAME&gt; --accept-operator-terms-and-conditions --wireguard-enabled false
</code></pre>
<h3 id="next-steps"><a class="header" href="#next-steps">Next steps</a></h3>
<p>If there are any problems checkout the troubleshooting section or report an issue.</p>
<p>Follow up with <a href="nodes/configuration.html">configuration</a> page for automation, reversed proxy setup and other tweaks, then head straight to <a href="nodes/bonding.html">bonding</a> page to finalise your setup.</p>
<footer id="last-change">Last change: 2024-09-10, commit: <a href="https://github.com/nymtech/nym/commit/12e8d3468">12e8d3468</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nym-node-configuration"><a class="header" href="#nym-node-configuration">Nym Node Configuration</a></h1>
<h2 id="basic-changes"><a class="header" href="#basic-changes">Basic Changes</a></h2>
<p>Nym Node can be configured directly by editing the config file (<code>config.toml</code>) located at <code>~/.nym/nym-nodes/&lt;ID&gt;/config/config.toml</code> (by default <code>~/.nym/nym-nodes/default-nym-node/config/config.toml</code>) or through commands on the binary.</p>
<h3 id="node-description"><a class="header" href="#node-description">Node Description</a></h3>
<p>Operators can add a description themselves to share more information about their <code>nym-node</code> publicly.</p>
<p>To add or change <code>nym-node</code> description is done by editing <code>description.toml</code> file located in <code>~/.nym/nym-nodes/&lt;NODE_ID&gt;/data/description.toml</code>. After saving, don’t forget to reload and restart your node <a href="nodes/configuration.html#systemd">service</a> or simply restart your <code>nym-node</code> if you run it without a service (not recommended).</p>
<p><strong>Query description</strong></p>
<p>Nodes description can be queried from API endpoint <code>/api/v1/description</code> or via Swagger API UI page <code>/api/v1/swagger/#/Node/description</code>.</p>
<pre><code class="language-bash">curl -X 'GET' \
  'http://&lt;NODE_IP_ADDRESS&gt;:8080/api/v1/description' \
  -H 'accept: application/json'

# or for https reversed proxy or WSS setup

curl -X 'GET' \
  'https://&lt;HOSTNAME&gt;/api/v1/description' \
  -H 'accept: application/json'
</code></pre>
<h3 id="commands--examples-1"><a class="header" href="#commands--examples-1">Commands &amp; Examples</a></h3>
<p>Disable sharing of system hardware info with the network:</p>
<pre><code class="language-sh">./nym-node run --id &lt;ID&gt; --deny-init --mode entry-gateway -w --expose-system-hardware false --expose-system-info false
</code></pre>
<p>Note: <code>--expose-system-info false</code> supersedes <code>--expose-system-hardware false</code>. If both are present with conflicting values, the system hardware will not be shown.</p>
<h2 id="vps-setup-and-automation"><a class="header" href="#vps-setup-and-automation">VPS Setup and Automation</a></h2>
<blockquote>
<p>Replace <code>&lt;NODE&gt;</code> variable with type of node you run, preferably <code>nym-node</code> (depreciated <code>nym-mixnode</code>, <code>nym-gateway</code> or <code>nym-network-requester</code>).</p>
</blockquote>
<h3 id="automating-your-node-with-nohup-tmux-and-systemd"><a class="header" href="#automating-your-node-with-nohup-tmux-and-systemd">Automating your node with nohup, tmux and systemd</a></h3>
<p>Although it’s not totally necessary, it’s useful to have the Mix Node automatically start at system boot time. We recommend to run your remote operation via <a href="nodes/maintenance.html#tmux"><code>tmux</code></a> for easier management and a handy return to your previous session. For full automation, including a failed node auto-restart and <code>ulimit</code> setup, <a href="nodes/maintenance.html#systemd"><code>systemd</code></a> is a good choice.</p>
<blockquote>
<p>Do any of these steps and run your automated node before you start bonding process!</p>
</blockquote>
<h4 id="nohup"><a class="header" href="#nohup">nohup</a></h4>
<p><code>nohup</code> is a command with which your terminal is told to ignore the <code>HUP</code> or ‘hangup’ signal. This will stop the node process ending if you kill your session.</p>
<pre><code class="language-sh">nohup ./&lt;NODE&gt; run &lt;OTHER_FLAGS&gt; # use all the flags you use to run your node
</code></pre>
<h4 id="tmux"><a class="header" href="#tmux">tmux</a></h4>
<p>One way is to use <code>tmux</code> shell on top of your current VPS terminal. Tmux is a terminal multiplexer, it allows you to create several terminal windows and panes from a single terminal. Processes started in <code>tmux</code> keep running after closing the terminal as long as the given <code>tmux</code> window was not terminated.</p>
<p>Use the following command to get <code>tmux</code>.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Platform</th><th style="text-align: left">Install Command</th></tr></thead><tbody>
<tr><td style="text-align: left">Arch Linux</td><td style="text-align: left"><code>pacman -S tmux</code></td></tr>
<tr><td style="text-align: left">Debian or Ubuntu</td><td style="text-align: left"><code>apt install tmux</code></td></tr>
<tr><td style="text-align: left">Fedora</td><td style="text-align: left"><code>dnf install tmux</code></td></tr>
<tr><td style="text-align: left">RHEL or CentOS</td><td style="text-align: left"><code>yum install tmux</code></td></tr>
<tr><td style="text-align: left">macOS (using Homebrew</td><td style="text-align: left"><code>brew install tmux</code></td></tr>
<tr><td style="text-align: left">macOS (using MacPorts)</td><td style="text-align: left"><code>port install tmux</code></td></tr>
<tr><td style="text-align: left">openSUSE</td><td style="text-align: left"><code>zypper install tmux</code></td></tr>
</tbody></table>
</div>
<p>In case it didn’t work for your distribution, see how to build <code>tmux</code> from <a href="https://github.com/tmux/tmux#from-version-control">version control</a>.</p>
<p><strong>Running tmux</strong></p>
<p>Now you have installed tmux on your VPS, let’s run a Mix Node on tmux, which allows you to detach your terminal and let your <code>&lt;NODE&gt;</code> run on its own on the VPS.</p>
<ul>
<li>Pause your <code>&lt;NODE&gt;</code></li>
<li>Start tmux with the command</li>
</ul>
<pre><code class="language-sh">tmux
</code></pre>
<ul>
<li>The tmux terminal should open in the same working directory, just the layout changed into tmux default layout.</li>
<li>Start the <code>&lt;NODE&gt;</code> again with a command:</li>
</ul>
<pre><code class="language-sh">./&lt;NODE&gt; run &lt;OTHER_FLAGS&gt; # use all the flags you use to run your node
</code></pre>
<ul>
<li>Now, without closing the tmux window, you can close the whole terminal and the <code>&lt;NODE&gt;</code> (and any other process running in tmux) will stay active.</li>
<li>Next time just start your teminal, ssh into the VPS and run the following command to attach back to your previous session:</li>
</ul>
<pre><code class="language-sh">tmux attach-session
</code></pre>
<ul>
<li>To see keybinding options of tmux press <code>ctrl</code>+<code>b</code> and after 1 second <code>?</code></li>
</ul>
<h4 id="systemd"><a class="header" href="#systemd">systemd</a></h4>
<p>To automate with <code>systemd</code> use this init service file by saving it as <code>/etc/systemd/system/nym-node.service</code> and follow the <a href="nodes/configuration.html#following-steps-for-nym-nodes-running-as-systemd-service">next steps</a>.</p>
<ol>
<li>Open the service file in a text editor</li>
</ol>
<pre><code class="language-sh">nano /etc/systemd/system/nym-node.service
</code></pre>
<ol start="2">
<li>Paste this config file, substitute <code>&lt;USER&gt;</code> and <code>&lt;PATH&gt;</code> with your correct values and add all flags to run your <code>nym-node</code> to <code>ExecStart</code> line:</li>
</ol>
<pre><code class="language-ini">[Unit]
Description=Nym Node
StartLimitInterval=350
StartLimitBurst=10

[Service]
User=&lt;USER&gt;
LimitNOFILE=65536
ExecStart=/home/&lt;USER&gt;/&lt;PATH&gt;/nym-node run # add all the flags you use to run your node
KillSignal=SIGINT
Restart=on-failure
RestartSec=30

[Install]
WantedBy=multi-user.target
</code></pre>
<div id="admonition-default" class="admonition admonish-warning" role="note">
<div>
<p><a href="nodes/setup.html#terms--conditions">Accepting T&amp;Cs</a> is done via a flag <code>--accept-operator-terms-and-conditions</code> added explicitly to <code>nym-node run</code> command every time. If you use systemd automation, add the flag to your service file’s <code>ExecStart</code> line.</p>
</div>
</div>
<ol start="3">
<li>Save the file</li>
</ol>
<div id="admonition-note" class="admonition admonish-note" role="note" aria-labelledby="admonition-note-title">
<div class="admonition-title">
<div id="admonition-note-title">
<p>Note</p>
</div>
<a class="admonition-anchor-link" href="nodes/configuration.html#admonition-note"></a>
</div>
<div>
<p>Make sure your <code>ExecStart &lt;FULL_PATH&gt;</code> and <code>run</code> command are correct!</p>
<p>Example: If you have built nym in the <code>$HOME</code> directory on your server, your username is <code>jetpanther</code>, and node <code>&lt;ID&gt;</code> is <code>puma</code>, then the <code>ExecStart</code> line (command) in the script located in <code>/etc/systemd/system/nym-mixnode.service</code> for Nym Mixnode might look like this:
<code>ExecStart=/home/jetpanther/nym/target/release/nym-node run --id puma</code>.</p>
<p>Basically, you want the full <code>/&lt;PATH&gt;/&lt;TO&gt;/nym-mixnode run --id &lt;WHATEVER-YOUR-NODE-ID-IS&gt;</code>. If you are unsure about your <code>/&lt;PATH&gt;/&lt;TO&gt;/&lt;NODE&gt;</code>, then <code>cd</code> to your directory where you run your <code>&lt;NODE&gt;</code> from and run <code>pwd</code> command which returns the full path for you.</p>
</div>
</div>
<h4 id="following-steps-for-nym-nodes-running-as-systemd-service"><a class="header" href="#following-steps-for-nym-nodes-running-as-systemd-service">Following steps for Nym nodes running as <code>systemd</code> service</a></h4>
<p>Once your <code>init</code> file is saved follow these steps:</p>
<ol>
<li>Reload systemctl to pickup the new unit file</li>
</ol>
<pre><code class="language-sh">systemctl daemon-reload
</code></pre>
<ol start="2">
<li>Enable the newly created service:</li>
</ol>
<pre><code class="language-sh">systemctl enable nym-node.service
</code></pre>
<ol start="3">
<li>Start your <code>&lt;NODE&gt;</code> as a <code>systemd</code> service:</li>
</ol>
<pre><code class="language-sh">service nym-node start
</code></pre>
<p>This will cause your <code>&lt;NODE&gt;</code> to start at system boot time. If you restart your machine, your <code>&lt;NODE&gt;</code> will come back up automatically.</p>
<p><strong>Useful systemd commands</strong></p>
<ul>
<li>You can monitor system logs of your node by running:</li>
</ul>
<pre><code class="language-sh">journalctl -u nym-node -f
</code></pre>
<ul>
<li>Or check a status by running:</li>
</ul>
<pre><code class="language-sh">systemctl status &lt;NODE&gt;.service
# for example systemctl status nym-node.service
</code></pre>
<ul>
<li>You can also do <code>service &lt;NODE&gt; stop</code> or <code>service &lt;NODE&gt; restart</code>.</li>
</ul>
<p><strong>Note:</strong> if you make any changes to your <code>systemd</code> script after you’ve enabled it, you will need to run:</p>
<pre><code class="language-sh">systemctl daemon-reload
</code></pre>
<p>This lets your operating system know it’s ok to reload the service configuration. Then restart your <code>&lt;NODE&gt;</code>.</p>
<h2 id="connectivity-test-and-configuration"><a class="header" href="#connectivity-test-and-configuration">Connectivity Test and Configuration</a></h2>
<p>During our ongoing testing events <a href="https://nymtech.net/events/fast-and-furious">Fast and Furious</a> we found out, that after introducing IP Packet Router (IPR) and <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">Nym exit policy</a> on embedded Network Requester (NR) by default,  only a fragment of Gateways routes correctly through IPv4 and IPv6. We built a useful monitor to check out your Gateway (<code>nym-node --mode exit-gateway</code>) at <a href="https://harbourmaster.nymtech.net/">harbourmaster.nymtech.net</a>.</p>
<p>IPv6 routing is not only a case for gateways. Imagine a rare occasion when you run a <code>mixnode</code> without IPv6 enabled and a client will sent IPv6 packets through the Mixnet through such route:</p>
<pre><code class="language-ascii">[client] -&gt; [entry-gateway] -&gt; [mixnode layer 1] -&gt; [your mixnode] -&gt; [IPv6 mixnode layer3] -&gt; [exit-gateway]
</code></pre>
<p>In this (unusual) case your <code>mixnode</code> will not be able to route the packets. The node will drop the packets and its performance would go down. For that reason it’s beneficial to have IPv6 enabled when running a <code>mixnode</code> functionality.</p>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="nodes/configuration.html#admonition-info"></a>
</div>
<div>
<p>We recommend operators to configure their <code>nym-node</code> with the full routing configuration.</p>
<p>However, most of the time the packets sent through the Mixnet are IPv4 based. The IPv6 packets are still pretty rare and therefore it’s not mandatory from operational point of view to have this configuration implemented if you running only <code>mixnode</code> mode.</p>
<p>If you preparing to run a <code>nym-node</code> with all modes enabled in the future, this setup is required.</p>
</div>
</div>
<div id="admonition-delegation-program" class="admonition admonish-tip" role="note" aria-labelledby="admonition-delegation-program-title">
<div class="admonition-title">
<div id="admonition-delegation-program-title">
<p>Delegation Program</p>
</div>
<a class="admonition-anchor-link" href="nodes/configuration.html#admonition-delegation-program"></a>
</div>
<div>
<p>For everyone participating in Delegation Program or Service Grant program, this setup is a requirement!</p>
</div>
</div>
<h3 id="quick-ipv6-check"><a class="header" href="#quick-ipv6-check">Quick IPv6 Check</a></h3>
<p>You can always check IPv6 address and connectivity by using some of these methods:</p>
<details id="admonition-test-ipv6-methods" class="admonition admonish-example" role="note" aria-labelledby="admonition-test-ipv6-methods-title">
<summary class="admonition-title">
<div id="admonition-test-ipv6-methods-title">
<p>Test IPv6 methods</p>
</div>
<a class="admonition-anchor-link" href="nodes/configuration.html#admonition-test-ipv6-methods"></a>
</summary>
<div>
<pre><code class="language-sh"># locally listed IPv6 addresses
ip -6 addr

# globally reachable IPv6 addresses
ip -6 addr show scope global

# with DNS
dig -6 TXT +short o-o.myaddr.l.google.com @ns1.google.com
dig -t aaaa +short myip.opendns.com @resolver1.opendns.com

# https check
curl -6 https://ifconfig.co
curl -6 https://ipv6.icanhazip.com

# using telnet
telnet -6 ipv6.telnetmyip.com
</code></pre>
</div>
</details>
<div id="admonition-caution" class="admonition admonish-warning" role="note" aria-labelledby="admonition-caution-title">
<div class="admonition-title">
<div id="admonition-caution-title">
<p>Caution</p>
</div>
<a class="admonition-anchor-link" href="nodes/configuration.html#admonition-caution"></a>
</div>
<div>
<p>Make sure to keep your IPv4 address enabled while setting up IPv6, as the majority of routing goes through that one!</p>
</div>
</div>
<h3 id="routing-configuration"><a class="header" href="#routing-configuration">Routing Configuration</a></h3>
<p>While we’re working on Rust implementation to have these settings as a part of the binary build, to solve these connectivity requirements in the meantime we wrote a script <a href="https://gist.github.com/tommyv1987/ccf6ca00ffb3d7e13192edda61bb2a77"><code>network_tunnel_manager.sh</code></a> to support the operators to configure their servers and address all the connectivity requirements.</p>
<p>Networking configuration across different ISPs and various operation systems does not have a generic solution. If the provided configuration setup doesn’t solve your problem check out <a href="nodes/../troubleshooting/vps-isp.html#ipv6-troubleshooting">IPv6 troubleshooting</a> page. Be aware that you may have to do more research, customised adjustments or contact your ISP to change settings for your VPS.</p>
<p>The <code>nymtun0</code> interface is dynamically managed by the <code>exit-gateway</code> service. When the service is stopped, <code>nymtun0</code> disappears, and when started, <code>nymtun0</code> is recreated.</p>
<p>The <code>nymwg</code> interface is used for creating a secure wireguard tunnel as part of the Nym Network configuration. Similar to <code>nymtun0</code>, the script manages iptables rules specific to <code>nymwg</code> to ensure proper routing and forwarding through the wireguard tunnel. The <code>nymwg</code> interface needs to be correctly configured and active for the related commands to function properly. This includes applying or removing iptables rules and running connectivity tests through the <code>nymwg</code> tunnel.</p>
<p>The script should be used in a context where <code>nym-node</code> is running to fully utilise its capabilities, particularly for fetching IPv6 addresses or applying network rules that depend on the <code>nymtun0</code> and <code>nymwg</code> interfaces and to establish a WireGuard tunnel.</p>
<p><strong>Before starting with the following configuration, make sure you have the <a href="https://github.com/nymtech/nym/releases/">latest <code>nym-node</code> binary</a> installed and your <a href="nodes/vps-setup.html">VPS setup</a> finished properly!</strong></p>
<ol>
<li>Download <code>network_tunnel_manager.sh</code>, make executable and run:</li>
</ol>
<pre><code class="language-sh">curl -L https://gist.githubusercontent.com/tommyv1987/ccf6ca00ffb3d7e13192edda61bb2a77/raw/74241cc06492b955e582052939090f57a285a65e/network_tunnel_manager.sh -o network_tunnel_manager.sh &amp;&amp; \
chmod +x network_tunnel_manager.sh &amp;&amp; \
./network_tunnel_manager.sh
</code></pre>
<ol start="2">
<li>Make sure your <code>nym-node</code> service is up and running</li>
</ol>
<ul>
<li><strong>If you setting up a new node and not upgrading an existing one, keep it running and <a href="nodes/bonding.html">bond</a> your node now</strong>. Then come back here and follow the rest of the configuration.</li>
</ul>
<div id="admonition-default-1" class="admonition admonish-tip" role="note">
<div>
<p>Run the following steps as root or with <code>sudo</code> prefix!</p>
</div>
</div>
<ol start="3">
<li>Display IPv6:</li>
</ol>
<ul>
<li>At this point you should see a <code>global ipv6</code> address.</li>
</ul>
<pre><code class="language-sh">./network_tunnel_manager.sh fetch_and_display_ipv6
</code></pre>
<details id="admonition-correct-network_tunnel_managersh-fetch_and_display_ipv6-output" class="admonition admonish-example" role="note" aria-labelledby="admonition-correct-network_tunnel_managersh-fetch_and_display_ipv6-output-title">
<summary class="admonition-title">
<div id="admonition-correct-network_tunnel_managersh-fetch_and_display_ipv6-output-title">
<p>Correct <code>./network_tunnel_manager.sh fetch_and_display_ipv6</code> output:</p>
</div>
<a class="admonition-anchor-link" href="nodes/configuration.html#admonition-correct-network_tunnel_managersh-fetch_and_display_ipv6-output"></a>
</summary>
<div>
<pre><code class="language-sh">iptables-persistent is already installed.
Using IPv6 address: 2001:db8:a160::1/112 #the address will be different for you
operation fetch_ipv6_address_nym_tun completed successfully.
</code></pre>
</div>
</details>
<ol start="4">
<li>Apply the rules for IPv4 and IPv6:</li>
</ol>
<pre><code class="language-sh">./network_tunnel_manager.sh apply_iptables_rules
</code></pre>
<ul>
<li>The process may prompt you if you want to save current IPv4 and IPv6 rules, choose yes.</li>
</ul>
<p><img src="nodes/../images/ip_table_prompt.png" alt="" /></p>
<ol start="5">
<li>Check Nymtun IP tables:</li>
</ol>
<ul>
<li>If there’s no process running it wouldn’t return anything.</li>
<li>In case you see <code>nymtun0</code> but not active, this is probably because you are setting up a new (never bonded) node and not upgrading an existing one.</li>
</ul>
<pre><code class="language-sh">./network_tunnel_manager.sh check_nymtun_iptables
</code></pre>
<details id="admonition-correct-network_tunnel_managersh-check_nymtun_iptables-output" class="admonition admonish-example" role="note" aria-labelledby="admonition-correct-network_tunnel_managersh-check_nymtun_iptables-output-title">
<summary class="admonition-title">
<div id="admonition-correct-network_tunnel_managersh-check_nymtun_iptables-output-title">
<p>Correct <code>./network_tunnel_manager.sh check_nymtun_iptables</code> output:</p>
</div>
<a class="admonition-anchor-link" href="nodes/configuration.html#admonition-correct-network_tunnel_managersh-check_nymtun_iptables-output"></a>
</summary>
<div>
<pre><code class="language-sh">
iptables-persistent is already installed.
network Device: eth0
---------------------------------------

inspecting IPv4 firewall rules...
Chain FORWARD (policy DROP 0 packets, 0 bytes)
    0     0 ufw-reject-forward  all  --  *      *       0.0.0.0/0            0.0.0.0/0
    0     0 ACCEPT     all  --  nymtun0 eth0    0.0.0.0/0            0.0.0.0/0
    0     0 ACCEPT     all  --  eth0   nymtun0  0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  nymtun0 eth0    0.0.0.0/0            0.0.0.0/0
    0     0 ACCEPT     all  --  eth0   nymtun0  0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  nymtun0 eth0    0.0.0.0/0            0.0.0.0/0
    0     0 ACCEPT     all  --  eth0   nymtun0  0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED
---------------------------------------

inspecting IPv6 firewall rules...
Chain FORWARD (policy DROP 0 packets, 0 bytes)
    0     0 ufw6-reject-forward  all      *      *       ::/0                 ::/0
    0     0 ACCEPT     all      eth0   nymtun0  ::/0                 ::/0                 state RELATED,ESTABLISHED
    0     0 ACCEPT     all      nymtun0 eth0    ::/0                 ::/0
    0     0 ACCEPT     all      eth0   nymtun0  ::/0                 ::/0                 state RELATED,ESTABLISHED
    0     0 ACCEPT     all      nymtun0 eth0    ::/0                 ::/0
    0     0 ACCEPT     all      eth0   nymtun0  ::/0                 ::/0                 state RELATED,ESTABLISHED
    0     0 ACCEPT     all      nymtun0 eth0    ::/0                 ::/0
operation check_nymtun_iptables completed successfully.
</code></pre>
</div>
</details>
<ol start="6">
<li>Apply the rules for WG routing:</li>
</ol>
<pre><code class="language-sh">./network_tunnel_manager.sh apply_iptables_rules_wg
</code></pre>
<ol start="7">
<li>Apply rules to configure DNS routing and allow ICMP piung test for node probing (network testing):</li>
</ol>
<pre><code class="language-sh">./network_tunnel_manager.sh configure_dns_and_icmp_wg
</code></pre>
<ol start="8">
<li>Check <code>nymtun0</code> interface:</li>
</ol>
<pre><code class="language-sh">ip addr show nymtun0
</code></pre>
<details id="admonition-correct-ip-addr-show-nymtun0-output" class="admonition admonish-example" role="note" aria-labelledby="admonition-correct-ip-addr-show-nymtun0-output-title">
<summary class="admonition-title">
<div id="admonition-correct-ip-addr-show-nymtun0-output-title">
<p>Correct <code>ip addr show nymtun0</code> output:</p>
</div>
<a class="admonition-anchor-link" href="nodes/configuration.html#admonition-correct-ip-addr-show-nymtun0-output"></a>
</summary>
<div>
<pre><code class="language-sh"># your addresses will be different
8: nymtun0: &lt;POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP&gt; mtu 1420 qdisc fq_codel state UNKNOWN group default qlen 500
    link/none
    inet 10.0.0.1/16 scope global nymtun0
       valid_lft forever preferred_lft forever
    inet6 2001:db8:a160::1/112 scope global
       valid_lft forever preferred_lft forever
    inet6 fe80::ad08:d167:5700:8c7c/64 scope link stable-privacy
       valid_lft forever preferred_lft forever`
</code></pre>
</div>
</details>
<ol start="9">
<li>Validate your IPv6 and IPv4 networking by running a joke test via Mixnet:</li>
</ol>
<pre><code class="language-sh">./network_tunnel_manager.sh joke_through_the_mixnet
</code></pre>
<ol start="10">
<li>Validate your tunneling by running a joke test via WG:</li>
</ol>
<pre><code class="language-sh">./network_tunnel_manager.sh joke_through_wg_tunnel
</code></pre>
<ul>
<li><strong>Note:</strong> WireGuard will return only IPv4 joke, not IPv6. WG IPv6 is under development. Running IPR joke through the mixnet with <code>./network_tunnel_manager.sh joke_through_the_mixnet</code> should work with both IPv4 and IPv6!</li>
</ul>
<ol start="11">
<li>Now you can run your node with the <code>--wireguard-enabled true</code> flag or add it to your <a href="nodes/configuration.html#systemd">systemd service config</a>. Restart your <code>nym-node</code> or <a href="nodes/configuration.html#following-steps-for-nym-nodes-running-as-systemd-service">systemd</a> service (recommended):</li>
</ol>
<pre><code class="language-sh">systemctl daemon-reload &amp;&amp; systemctl restart nym-node.service
</code></pre>
<ul>
<li>Optionally, you can check if the node is running correctly by monitoring the service logs:</li>
</ul>
<pre><code class="language-sh">journalctl -u nym-node.service -f -n 100
</code></pre>
<p>Make sure that you get the validation of all connectivity. If there are still any problems, please refer to <a href="nodes/../troubleshooting/vps-isp.html#incorrect-gateway-network-check">troubleshooting section</a>.</p>
<h2 id="next-steps-1"><a class="header" href="#next-steps-1">Next Steps</a></h2>
<p>There are a few more good suggestions for <code>nym-node</code> configuration, like Web Secure Socket or Reversed Proxy setup. These are optional and you can skip them if you want. Visit <a href="nodes/proxy-configuration.html">Proxy configuration</a> page to see the guides.</p>
<footer id="last-change">Last change: 2024-09-10, commit: <a href="https://github.com/nymtech/nym/commit/12e8d3468">12e8d3468</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="reverse-proxy--web-secure-socket"><a class="header" href="#reverse-proxy--web-secure-socket">Reverse Proxy &amp; Web Secure Socket</a></h1>
<p>This section will guide you in setting up a reverse proxy for serving <code>nym-node</code> HTTP requests and to set up a custom <a href="nodes/../legal/landing-pages.html">landing page</a> for your node.</p>
<p>In later sections, you will be setting up secure websocket (wss) to add additional security and encrypt connections coming to your node. Follow <a href="nodes/proxy-configuration.html#web-secure-socket-setup">this guide</a> for installation.</p>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="nodes/proxy-configuration.html#admonition-info"></a>
</div>
<div>
<p>Since SSL certificates can only be issued for a domain name and not an IP address, it is essential for you to register a new domain name and configure a domain record pointing to your node’s IP address</p>
</div>
</div>
<h2 id="variables-explanation"><a class="header" href="#variables-explanation">Variables Explanation</a></h2>
<p>This guide contains several variables. Substitute them with your own value, without <code>&lt;&gt;</code> brackets. Here is a list of variables we used below.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Variable</th><th style="text-align: left">Description</th><th style="text-align: left">Syntax example</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>&lt;HOSTNAME&gt;</code></td><td style="text-align: left">Your registered DNS domain, asigned to the VPS with <code>nym-node</code></td><td style="text-align: left">exit-gateway1.squad.nsl</td></tr>
<tr><td style="text-align: left"><code>&lt;WSS_PORT&gt;</code></td><td style="text-align: left">Port listening to WSS, default is <code>9001</code></td><td style="text-align: left">9001</td></tr>
<tr><td style="text-align: left"><code>&lt;YOUR_WELCOME_TEXT&gt;</code></td><td style="text-align: left">Any text you want to show on the landing page</td><td style="text-align: left">Welcome to Nym Node, operator contact is example@email.me</td></tr>
<tr><td style="text-align: left"><code>&lt;LANDING_PAGE_PATH&gt;</code></td><td style="text-align: left">A sub-directory located at <code>/var/www/&lt;HOSTNAME&gt;</code> containing html configuration files</td><td style="text-align: left"><code>/var/www/exit-gateway1.squad.nsl</code></td></tr>
<tr><td style="text-align: left"><code>&lt;ID&gt;</code></td><td style="text-align: left">A local only <code>nym-node</code> identifier, specified by flag <code>--id</code>, default is <code>default-nym-node</code></td><td style="text-align: left">alice_super_node</td></tr>
<tr><td style="text-align: left"><code>&lt;PATH_TO&gt;</code></td><td style="text-align: left">Specify a full path to the given file, directory or binary behind this variable</td><td style="text-align: left"><code>/root/src/nym/target/release/</code></td></tr>
</tbody></table>
</div><div id="admonition-default" class="admonition admonish-warning" role="note">
<div>
<p>The commands in this setup need to be run with root permission. Either add a prefix <code>sudo</code> or execute them from a root shell.</p>
</div>
</div>
<h2 id="reverse-proxy-setup"><a class="header" href="#reverse-proxy-setup">Reverse Proxy Setup</a></h2>
<div id="admonition-info-1" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-1-title">
<div class="admonition-title">
<div id="admonition-info-1-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="nodes/proxy-configuration.html#admonition-info-1"></a>
</div>
<div>
<p>This guide was created by a Nym node operator, <a href="https://avril14th.org">Avril 14th</a> as a part of <a href="nodes/../legal/community-counsel.html">Nym Operators Community Counsel</a>, edited by Nym.</p>
</div>
</div>
<p>The following snippet needs  be modified as described below according to the public identity that you may want to show on this public notice, i.e. your graphics and your email.
It would allow you to serve it as a landing page resembling the one proposed by <a href="https://gitlab.torproject.org/tpo/core/tor/-/raw/HEAD/contrib/operator-tools/tor-exit-notice.html">Tor</a> but with all the changes needed to adhere to the Nym’s operators case.</p>
<h3 id="html-file-customization"><a class="header" href="#html-file-customization">HTML File Customization</a></h3>
<p>File for html configuration are by convention located at <code>/var/www/&lt;HOSTNAME&gt;</code> directory and it’s subdirectories. We refer to this directory as <code>&lt;LANDING_PAGE_PATH&gt;</code>.</p>
<ol>
<li>Start by creating this directory:</li>
</ol>
<pre><code class="language-sh">mkdir -p /var/www/&lt;HOSTNAME&gt;
</code></pre>
<ol start="2">
<li>Use your own html code or copy the template below to a new file called <code>index.html</code> located in <code>/var/www/&lt;HOSTNAME&gt;</code> directory.</li>
</ol>
<details id="admonition-an-example-template-for-varwwwindexhtml-page" class="admonition admonish-example" role="note" aria-labelledby="admonition-an-example-template-for-varwwwindexhtml-page-title">
<summary class="admonition-title">
<div id="admonition-an-example-template-for-varwwwindexhtml-page-title">
<p>An example template for <code>/var/www/&lt;HOSTNAME&gt;/index.html</code> page</p>
</div>
<a class="admonition-anchor-link" href="nodes/proxy-configuration.html#admonition-an-example-template-for-varwwwindexhtml-page"></a>
</summary>
<div>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en-US"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
&lt;title&gt;This is a NYM Exit Gateway&lt;/title&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
&lt;link rel="icon" type="image/png" href=""&gt;
&lt;style&gt;
:root {
  font-family: Consolas, "Ubuntu Mono", Menlo, "DejaVu Sans Mono", monospace;
}
:root{
--background-color: #121726;
--text-color: #f2f2f2;
--link-color: #fb6e4e;
}
html{
background: var(--background-color);
}
body{
margin-left: auto;
margin-right: auto;
padding-left: 5vw;
padding-right: 5vw;
max-width: 1000px;
}
h1{
font-size: 55px;
text-align: center;
color: var(--title-color)
}
p{
color: var(--text-color);
}
p, a{
font-size: 20px;
}
a{
color: var(--link-color);
text-decoration: none;
}
a:hover{
filter: brightness(.8);
text-decoration: underline;
}
.links{
display: flex;
flex-wrap: wrap;
justify-content: space-evenly;
}
.links &gt; a{
margin: 10px;
white-space: nowrap;
}
&lt;/style&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;main&gt;
&lt;h1&gt;This is a NYM Exit Gateway&lt;/h1&gt;
&lt;p style="text-align:center"&gt;
&lt;img class="logo" src="&lt;FIXME&gt;"&gt;
&lt;/p&gt;

&lt;p&gt;
You are most likely accessing this website because you've had some issue with
the traffic coming from this IP. This router is part of the &lt;a
href="https://nymtech.net/"&gt;NYM project&lt;/a&gt;, which is
dedicated to &lt;a href="https://nymtech.net/about/mission"&gt;create&lt;/a&gt; outstanding
privacy software that is legally compliant without sacrificing integrity or
having any backdoors.
This router IP should be generating no other traffic, unless it has been
compromised.&lt;/p&gt;

&lt;p&gt;
The Nym mixnet is operated by a decentralised community of node operators
and stakers. The Nym mixnet is trustless, meaning that no parts of the system
nor its operators have access to information that might compromise the privacy
of users. Nym software enacts a strict principle of data minimisation and has
no back doors. The Nym mixnet works by encrypting packets in several layers
and relaying those through a multi-layered network called a mixnet,  eventually
letting the traffic exit the Nym mixnet through an exit gateway like this one.
This design makes it very hard for a service to know which user is connecting to it,
since it can only see the IP-address of the Nym exit gateway:&lt;/p&gt;

&lt;p style="text-align:center;margin:40px 0"&gt;
&lt;svg xmlns="http://www.w3.org/2000/svg" width="500" viewBox="0 0 490.28 293.73" style="width:100%;max-width:600px"&gt;
&lt;desc&gt;Illustration showing how a user might connect to a service through the Nym network. The user first sends their data through three daisy-chained encrypted Nym nodes that exist on three different continents. Then the last Nym node in the chain connects to the target service over the normal internet.&lt;/desc&gt;
&lt;defs&gt;
&lt;style&gt;
.t{
fill: var(--text-color);
stroke: var(--text-color);
}
&lt;/style&gt;
&lt;/defs&gt;
&lt;path fill="#6fc8b7" d="M257.89 69.4c-6.61-6.36-10.62-7.73-18.36-8.62-7.97-1.83-20.06-7.99-24.17-.67-3.29 5.85-18.2 12.3-16.87 2.08.92-7.03 11.06-13.28 17-17.37 8.69-5.99 24.97-2.87 26.1-10.28 1.04-6.86-8.33-13.22-8.55-2.3-.38 12.84-19.62 2.24-8.73-6.2 8.92-6.9 16.05-9.02 25.61-6.15 12.37 4.83 25.58-2.05 33.73-.71 12.37-2.01 24.69-5.25 37.39-3.96 13 .43 24.08-.14 37.06.63 9.8 1.58 16.5 2.87 26.37 3.6 6.6.48 17.68-.82 24.3 1.9 8.3 4.24.44 10.94-6.89 11.8-8.79 1.05-23.59-1.19-26.6 1.86-5.8 7.41 10.75 5.68 11.27 14.54.57 9.45-5.42 9.38-8.72 16-2.7 4.2.3 13.93-1.18 18.45-1.85 5.64-19.64 4.47-14.7 14.4 4.16 8.34 1.17 19.14-10.33 12.02-5.88-3.65-9.85-22.04-15.66-21.9-11.06.27-11.37 13.18-12.7 17.52-1.3 4.27-3.79 2.33-6-.63-3.54-4.76-7.75-14.22-12.01-17.32-6.12-4.46-10.75-1.17-15.55 2.83-5.63 4.69-8.78 7.82-7.46 16.5.78 9.1-12.9 15.84-14.98 24.09-2.61 10.32-2.57 22.12-8.81 31.47-4 5.98-14.03 20.12-21.27 14.97-7.5-5.34-7.22-14.6-9.56-23.08-2.5-9.02.6-17.35-2.57-26.2-2.45-6.82-6.23-14.54-13.01-13.24-6.5.92-15.08 1.38-19.23-2.97-5.65-5.93-6-10.1-6.61-18.56 1.65-6.94 5.79-12.64 10.38-18.63 3.4-4.42 17.45-10.39 25.26-7.83 10.35 3.38 17.43 10.5 28.95 8.57 3.12-.53 9.14-4.65 7.1-6.62zm-145.6 37.27c-4.96-1.27-11.57 1.13-11.8 6.94-1.48 5.59-4.82 10.62-5.8 16.32.56 6.42 4.34 12.02 8.18 16.97 3.72 3.85 8.58 7.37 9.3 13.1 1.24 5.88 1.6 11.92 2.28 17.87.34 9.37.95 19.67 7.29 27.16 4.26 3.83 8.4-2.15 6.52-6.3-.54-4.54-.6-9.11 1.01-13.27 4.2-6.7 7.32-10.57 12.44-16.64 5.6-7.16 12.74-11.75 14-20.9.56-4.26 5.72-13.86 1.7-16.72-3.14-2.3-15.83-4-18.86-6.49-2.36-1.71-3.86-9.2-9.86-12.07-4.91-3.1-10.28-6.73-16.4-5.97zm11.16-49.42c6.13-2.93 10.58-4.77 14.61-10.25 3.5-4.28 2.46-12.62-2.59-15.45-7.27-3.22-13.08 5.78-18.81 8.71-5.96 4.2-12.07-5.48-6.44-10.6 5.53-4.13.38-9.2-5.66-8.48-6.12.8-12.48-1.45-18.6-1.73-5.3-.7-10.13-1-15.45-1.37-5.37-.05-16.51-2.23-25.13.87-5.42 1.79-12.5 5.3-16.73 9.06-4.85 4.2.2 7.56 5.54 7.45 5.3-.22 16.8-5.36 20.16.98 3.68 8.13-5.82 18.29-5.2 26.69.1 6.2 3.37 11 4.74 16.98 1.62 5.94 6.17 10.45 10 15.14 4.7 5.06 13.06 6.3 19.53 8.23 7.46.14 3.34-9.23 3.01-14.11 1.77-7.15 8.49-7.82 12.68-13.5 7.14-7.72 16.41-13.4 24.34-18.62zM190.88 3.1c-4.69 0-13.33.04-18.17-.34-7.65.12-13.1-.62-19.48-1.09-3.67.39-9.09 3.34-5.28 7.04 3.8.94 7.32 4.92 7.1 9.31 1.32 4.68 1.2 11.96 6.53 13.88 4.76-.2 7.12-7.6 11.93-8.25 6.85-2.05 12.5-4.58 17.87-9.09 2.48-2.76 7.94-6.38 5.26-10.33-1.55-1.31-2.18-.64-5.76-1.13zm178.81 157.37c-2.66 10.08-5.88 24.97 9.4 15.43 7.97-5.72 12.58-2.02 17.47 1.15.5.43 2.65 9.2 7.19 8.53 5.43-2.1 11.55-5.1 14.96-11.2 2.6-4.62 3.6-12.39 2.76-13.22-3.18-3.43-6.24-11.03-7.7-15.1-.76-2.14-2.24-2.6-2.74-.4-2.82 12.85-6.04 1.22-10.12-.05-8.2-1.67-29.62 7.17-31.22 14.86z"/&gt;
&lt;g fill="none"&gt;
&lt;path stroke="#cf63a6" stroke-linecap="round" stroke-width="2.76" d="M135.2 140.58c61.4-3.82 115.95-118.83 151.45-103.33"/&gt;
&lt;path stroke="#cf63a6" stroke-linecap="round" stroke-width="2.76" d="M74.43 46.66c38.15 8.21 64.05 42.26 60.78 93.92M286.65 37.25c-9.6 39.44-3.57 57.12-35.64 91.98"/&gt;
&lt;path stroke="#e4c101" stroke-dasharray="9.06,2.265" stroke-width="2.27" d="M397.92 162.52c-31.38 1.26-90.89-53.54-148.3-36.17"/&gt;
&lt;path stroke="#cf63a6" stroke-linecap="round" stroke-width="2.77" d="M17.6 245.88c14.35 0 14.4.05 28-.03"/&gt;
&lt;path stroke="#e3bf01" stroke-dasharray="9.06,2.265" stroke-width="2.27" d="M46.26 274.14c-17.52-.12-16.68.08-30.34.07"/&gt;
&lt;/g&gt;
&lt;g transform="translate(120.8 -35.81)"&gt;
&lt;circle cx="509.78" cy="68.74" r="18.12" fill="#240a3b" transform="translate(-93.3 38.03) scale(.50637)"/&gt;
&lt;circle cx="440.95" cy="251.87" r="18.12" fill="#240a3b" transform="translate(-93.3 38.03) scale(.50637)"/&gt;
&lt;circle cx="212.62" cy="272.19" r="18.12" fill="#240a3b" transform="translate(-93.3 38.03) scale(.50637)"/&gt;
&lt;circle cx="92.12" cy="87.56" r="18.12" fill="#240a3b" transform="translate(-93.3 38.03) scale(.50637)"/&gt;
&lt;circle cx="730.88" cy="315.83" r="18.12" fill="#67727b" transform="translate(-93.3 38.03) scale(.50637)"/&gt;
&lt;circle cx="-102.85" cy="282.18" r="9.18" fill="#240a3b"/&gt;
&lt;circle cx="-102.85" cy="309.94" r="9.18" fill="#67727b"/&gt;
&lt;/g&gt;
&lt;g class="t"&gt;
&lt;text xml:space="preserve" x="-24.76" y="10.37" stroke-width=".26" font-size="16.93" font-weight="700" style="line-height:1.25" transform="translate(27.79 2.5)" word-spacing="0"&gt;&lt;tspan x="-24.76" y="10.37"&gt;The user&lt;/tspan&gt;&lt;/text&gt;
&lt;text xml:space="preserve" x="150.63" y="196.62" stroke-width=".26" font-size="16.93" font-weight="700" style="line-height:1.25" transform="translate(27.79 2.5)" word-spacing="0"&gt;&lt;tspan x="150.63" y="196.62"&gt;This server&lt;/tspan&gt;&lt;/text&gt;
&lt;text xml:space="preserve" x="346.39" y="202.63" stroke-width=".26" font-size="16.93" font-weight="700" style="line-height:1.25" transform="translate(27.79 2.5)" word-spacing="0"&gt;&lt;tspan x="346.39" y="202.63"&gt;Your service&lt;/tspan&gt;&lt;/text&gt;
&lt;text xml:space="preserve" x="34.52" y="249.07" stroke-width=".26" font-size="16.93" font-weight="700" style="line-height:1.25" transform="translate(27.79 2.5)" word-spacing="0"&gt;&lt;tspan x="34.52" y="249.07"&gt;Nym network link&lt;/tspan&gt;&lt;/text&gt;
&lt;text xml:space="preserve" x="34.13" y="276.05" stroke-width=".26" font-size="16.93" font-weight="700" style="line-height:1.25" transform="translate(27.79 2.5)" word-spacing="0"&gt;&lt;tspan x="34.13" y="276.05"&gt;Unencrypted link&lt;/tspan&gt;&lt;/text&gt;
&lt;path fill="none" stroke-linecap="round" stroke-width="1.67" d="M222.6 184.1c-2.6-15.27 8.95-23.6 18.43-38.86m186.75 45.61c-.68-10.17-9.4-17.68-18.08-23.49"/&gt;
&lt;path fill="none" stroke-linecap="round" stroke-width="1.67" d="M240.99 153.41c.35-3.41 1.19-6.17.04-8.17m-7.15 5.48c1.83-2.8 4.58-4.45 7.15-5.48"/&gt;
&lt;path fill="none" stroke-linecap="round" stroke-width="1.67" d="M412.43 173.21c-2.2-3.15-2.54-3.85-2.73-5.85m0 0c2.46-.65 3.85.01 6.67 1.24M61.62 40.8C48.89 36.98 36.45 27.54 36.9 18.96M61.62 40.8c.05-2.58-3.58-4.8-5.25-5.26m-2.65 6.04c1.8.54 6.8 1.31 7.9-.78"/&gt;
&lt;path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.44" d="M1.22 229.4h247.74v63.1H1.22z"/&gt;
&lt;/g&gt;
&lt;/svg&gt;
&lt;/p&gt;

&lt;p&gt;
&lt;a href="https://nymtech.net/about/mixnet"&gt;Read more about how Nym works.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;
Nym relies on a growing ecosystem of users, developers and researcher partners
aligned with the mission to make sure Nym software is running, remains usable
and solves real problems. While Nym is not designed for malicious computer
users, it is true that they can use the network for malicious ends. This
is largely because criminals and hackers have significantly better access to
privacy and anonymity than do the regular users whom they prey upon. Criminals
can and do build, sell, and trade far larger and more powerful networks than
Nym on a daily basis. Thus, in the mind of this operator, the social need for
easily accessible censorship-resistant private, anonymous communication trumps
the risk of unskilled bad actors, who are almost always more easily uncovered
by traditional police work than by extensive monitoring and surveillance anyway.&lt;/p&gt;

&lt;p&gt;
In terms of applicable law, the best way to understand Nym is to consider it a
network of routers operating as common carriers, much like the Internet
backbone. However, unlike the Internet backbone routers, Nym mixnodes do not
contain identifiable routing information about the source of a packet and do
mix the user internet traffic with that of other users, making communications
private and protecting not just the user content but the metadata
(user's IP address, who the user talks to, when, where, from what device and
more) and no single Nym node can determine both the origin and destination
of a given transmission.&lt;/p&gt;

&lt;p&gt;
As such, there is little the operator of this Exit Gateway can do to help you
track the connection further. This Exit Gateway maintains no logs of any of the
Nym mixnet traffic, so there is little that can be done to trace either legitimate or
illegitimate traffic (or to filter one from the other).  Attempts to
seize this router will accomplish nothing.&lt;/p&gt;

&lt;!-- FIXME: US-Only section. Remove if you are a non-US operator --&gt;
&lt;!--
&lt;p&gt;
Furthermore, this machine also serves as a carrier of email, which means that
its contents are further protected under the ECPA. &lt;a
href="https://www.law.cornell.edu/uscode/text/18/2707"&gt;18
USC 2707&lt;/a&gt; explicitly allows for civil remedies ($1000/account
&lt;i&gt;plus&lt;/i&gt;  legal fees)
in the event of a seizure executed without good faith or probable cause (it
should be clear at this point that traffic with an originating IP address of
FIXME_DNS_NAME should not constitute probable cause to seize the
machine). Similar considerations exist for 1st amendment content on this
machine.&lt;/p&gt;
--&gt;
&lt;!-- FIXME: May or may not be US-only. Some non-US tor nodes have in
     fact reported DMCA harassment... --&gt;
&lt;!--
&lt;p&gt;
If you are a representative of a company who feels that this router is being
used to violate the DMCA, please be aware that this machine does not host or
contain any illegal content. Also be aware that network infrastructure
maintainers are not liable for the type of content that passes over their
equipment, in accordance with &lt;a
href="https://www.law.cornell.edu/uscode/text/17/512"&gt;DMCA
"safe harbor" provisions&lt;/a&gt;. In other words, you will have just as much luck
sending a takedown notice to the Internet backbone providers.
&lt;/p&gt;
--&gt;

&lt;p&gt;To decentralise and enable privacy for a broad range of services, this
Exit Gateway adopts an &lt;a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt"&gt;Exit Policy&lt;/a&gt;
in accordance with the &lt;a href="https://tornull.org/"&gt;Tor Null ‘deny’ list&lt;/a&gt;
and the &lt;a href="https://tornull.org/tor-reduced-reduced-exit-policy.php"&gt;Tor reduced policy&lt;/a&gt;,
which are two established safeguards.
&lt;/p&gt;

&lt;p&gt;
That being said, if you still have a complaint about the router, you may email the
 &lt;a href="mailto:&gt;YOUR_EMAIL_ADDRESS&gt;"&gt;maintainer&lt;/a&gt;. If complaints are related
 to a particular service that is being abused, the maintainer will submit that to the
 NYM Operators Community in order to add it to the Exit Policy cited above.
If approved, that would prevent this router from allowing that traffic to exit through it.
That can be done only on an IP+destination port basis, however. Common P2P ports are already blocked.&lt;/p&gt;

&lt;p&gt;
You also have the option of blocking this IP address and others on the Nym network if you so desire.
 The Nym project provides a &lt;a href="https://explorer.nymtech.net/network-components/gateways"&gt;
 web service&lt;/a&gt; to fetch a list of all IP addresses of Nym Gateway Exit nodes that allow exiting to a
specified IP:port combination. Please be considerate when using these options.&lt;/p&gt;

&lt;/main&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</div>
</details>
<ol start="3">
<li>Before you save and close the file, make sure to edit the text, especially the information in these points:</li>
</ol>
<ul>
<li>Add your favicon logo on the line:</li>
</ul>
<pre><code>&lt;link rel="icon" type="image/png" href=""&gt;
</code></pre>
<ul>
<li>Add your header logo on the line:</li>
</ul>
<pre><code>&lt;img class="logo" src="&lt;FIXME&gt;"&gt;
</code></pre>
<ul>
<li>By either setting the URl to the image (if you’re hosting it publicly, i.e. on your web server)</li>
</ul>
<pre><code>href="&lt;PATH_TO_YOUR_PUBLIC_URL&gt;"

# and

src="&lt;PATH_TO_YOUR_PUBLIC_URL&gt;"
</code></pre>
<ul>
<li><strong>or</strong> by adding the image inline as base64 encoded image</li>
</ul>
<pre><code>href="href="data:image/x-icon;base64,AAABAAMA....""

# and

src="href="data:image/x-icon;base64,AAABAAMA....""
</code></pre>
<ul>
<li>Add the email address you’re willing to use for being contacted.</li>
</ul>
<pre><code>&lt;a href="mailto:&gt;YOUR_EMAIL_ADDRESS&gt;"&gt;maintainer&lt;/a&gt;
</code></pre>
<ul>
<li>If you’re running the node within the US check the sections marked as <code>FIXME</code>, add your DNS name and un-comment those.</li>
</ul>
<ol start="4">
<li>Save and exit</li>
</ol>
<p>Now your html page is configured.</p>
<h3 id="nym-node-configuration-1"><a class="header" href="#nym-node-configuration-1"><code>nym-node</code> Configuration</a></h3>
<p>When done with the customization, you’ll need to make sure your <code>nym-node</code> uploads the file and reference to it. This is done by opening your node configuration file located at <code>~/.nym/nym-nodes/&lt;ID&gt;/config/config.toml</code> and changing the value of the line <code>landing_page_assets_path</code> on the <code>[http]</code> section:</p>
<pre><code>landing_page_assets_path = '&lt;LANDING_PAGE_PATH&gt;'
</code></pre>
<h3 id="reverse-proxy-configuration"><a class="header" href="#reverse-proxy-configuration">Reverse Proxy Configuration</a></h3>
<p>You may set up a <a href="https://www.nginx.com/resources/glossary/reverse-proxy-server/">reverse proxy</a> in order to serve this landing page with proper SSL and DNS management, i.e. to resolve it to https://<HOSTNAME>.</p>
<p><strong>Configure Nginx</strong></p>
<ol>
<li>Install <code>nginx</code>:</li>
</ol>
<pre><code class="language-sh">sudo apt install nginx
</code></pre>
<ol>
<li>Setup firewall with <code>ufw</code>. <code>ufw</code> has three profile pre-configured for <code>nginx</code>, we will need the first one for <code>nym-node</code>:</li>
</ol>
<ul>
<li><code>Nginx Full</code>: This profile opens both port 80 (normal, unencrypted web traffic) and port 443 (TLS/SSL encrypted traffic)</li>
<li><code>Nginx HTTP</code>: This profile opens only port 80 (normal, unencrypted web traffic)</li>
<li><code>Nginx HTTPS</code>: This profile opens only port 443 (TLS/SSL encrypted traffic)</li>
</ul>
<pre><code class="language-sh">ufw allow 'Nginx Full'

# you can verify by
ufw status

# possibly reload ufw by
ufw reload
</code></pre>
<ol start="3">
<li>Disable the default Nginx landing page</li>
</ol>
<pre><code>systemctl status nginx
unlink /etc/nginx/sites-enabled/default
systemctl restart nginx
</code></pre>
<ol start="4">
<li>Add your endpoint configuration to Nginx by creating file:</li>
</ol>
<pre><code class="language-sh">nano /etc/nginx/sites-available/&lt;HOSTNAME&gt;
</code></pre>
<ul>
<li>and changing <code>&lt;HOSTNAME&gt;</code> occurrences below with your domain name:</li>
</ul>
<pre><code>server {
    listen 80;
    listen [::]:80;

    # Replace &lt;HOSTNAME&gt; with your domain name
    server_name &lt;HOSTNAME&gt;;

    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
</code></pre>
<p>This guide assumes that the HTTP port used by you is <code>8080</code>. Adjust the configuration accordingly if you have defined
a custom port for your <code>nym-node</code> HTTP connections</p>
<ol start="5">
<li>Activate the configuration by creating a symlink to <code>/etc/nginx/sites-enabled</code>:</li>
</ol>
<pre><code class="language-sh">ln -s /etc/nginx/sites-available/&lt;HOSTNAME&gt; /etc/nginx/sites-enabled
</code></pre>
<ol start="6">
<li>Test your configuration syntax:</li>
</ol>
<pre><code class="language-sh">nginx -t
</code></pre>
<p>Nginx must report that the config is “ok” and the test was successful.</p>
<ol start="7">
<li>Restart <code>nginx</code>:</li>
</ol>
<pre><code class="language-sh">systemctl restart nginx
</code></pre>
<ol start="8">
<li>Get an <code>SSL</code> certificate using certbot:</li>
</ol>
<pre><code class="language-sh">apt install certbot python3-certbot-nginx
certbot --nginx --non-interactive --agree-tos --redirect -m &lt;YOUR_EMAIL_ADDRESS&gt; -d &lt;HOSTNAME&gt;
</code></pre>
<ol start="9">
<li>Restart your <code>nym-node</code> or if you’re running your <code>nym-node</code> as a <a href="nodes/configuration.html#systemd"><code>systemd</code> service</a>, restart your service:</li>
</ol>
<pre><code class="language-sh">systemctl daemon-reload &amp;&amp; systemctl restart nym-node
</code></pre>
<ol start="9">
<li>Check for the page being served reading the service logs</li>
</ol>
<pre><code class="language-sh">journalctl -u  nym-node.service | grep 8080

# where you should see
... Started NymNodeHTTPServer on 0.0.0.0:8080
</code></pre>
<p>Now your <code>nginx</code> should be configured, up and running. Test it by inserting your <code>&lt;HOSTNAME&gt;</code> as a URL in a browser.</p>
<h2 id="web-secure-socket-setup"><a class="header" href="#web-secure-socket-setup">Web Secure Socket Setup</a></h2>
<p>This section assumes that you have already configured a reverse proxy and have set it up to work over https. If not, head over to <a href="nodes/proxy-configuration.html#reverse-proxy-configuration">the reverse proxy section</a> to configure it.</p>
<p>We strongly recommend node operators to configure secure web sockets on their nodes. This will provide clients a more secure way to connect to your node.</p>
<p>You can read more about <em>Secure Socket Layer</em> (SSL) in <a href="https://www.geeksforgeeks.org/secure-socket-layer-ssl/">here</a>.</p>
<p>Remember that there may be some unique variables and customization depending on the way your reverse proxy is setup which you may have to adjust when configuring WSS to ensure correct functionality</p>
<div id="admonition-tip" class="admonition admonish-tip" role="note" aria-labelledby="admonition-tip-title">
<div class="admonition-title">
<div id="admonition-tip-title">
<p>Tip</p>
</div>
<a class="admonition-anchor-link" href="nodes/proxy-configuration.html#admonition-tip"></a>
</div>
<div>
<p>To see description of used variables (noted in <code>&lt;&gt;</code> brackets), scroll to the top of this page, chapter <a href="nodes/proxy-configuration.html#variables-explanation"><em>Variables Explanation</em></a>.</p>
</div>
</div>
<h4 id="firewall-configuration"><a class="header" href="#firewall-configuration">Firewall configuration</a></h4>
<p>Make sure to open all <a href="nodes/vps-setup.html#configure-your-firewall">needed ports</a>, adding your <code>&lt;WSS_PORT&gt;</code>:</p>
<pre><code class="language-sh">ufw allow &lt;WSS_PORT&gt;/tcp

# for example
# ufw allow 9001/tcp
</code></pre>
<h4 id="wss-configuration"><a class="header" href="#wss-configuration">WSS configuration</a></h4>
<p>This section assumes that you have already configured a reverse proxy and have set it up to work over https. If not, head over to <a href="nodes/proxy-configuration.html#reverse-proxy">the reverse proxy section</a> to configure it.</p>
<ol>
<li>Create a new Nginx configuration file called <code>/etc/nginx/sites-available/wss-config-nym</code> and paste the block below. Don’t forget to insert your correct values.</li>
</ol>
<details id="admonition-site-configuration-etcnginxsites-availablewss-config-nym" class="admonition admonish-example" role="note" aria-labelledby="admonition-site-configuration-etcnginxsites-availablewss-config-nym-title">
<summary class="admonition-title">
<div id="admonition-site-configuration-etcnginxsites-availablewss-config-nym-title">
<p>Site configuration <code>/etc/nginx/sites-available/wss-config-nym</code></p>
</div>
<a class="admonition-anchor-link" href="nodes/proxy-configuration.html#admonition-site-configuration-etcnginxsites-availablewss-config-nym"></a>
</summary>
<div>
<pre><code class="language-bash">#####################################################
# EXCHANGE ALL &lt;HOSTNAME&gt; &amp; &lt;WSS_PORT&gt; VARIABLES ! #
####################################################

server {
    listen &lt;WSS_PORT&gt; ssl http2;
    listen [::]:&lt;WSS_PORT&gt; ssl http2;

    server_name &lt;HOSTNAME&gt;;

    ssl_certificate /etc/letsencrypt/live/&lt;HOSTNAME&gt;/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/&lt;HOSTNAME&gt;/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;

    # Ignore favicon requests
    location /favicon.ico {
        return 204;
        access_log     off;
        log_not_found  off;
    }

    location / {

        add_header 'Access-Control-Allow-Origin' '*';
        add_header 'Access-Control-Allow-Credentials' 'true';
        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS, HEAD';
        add_header 'Access-Control-Allow-Headers' '*';

        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "Upgrade";
        proxy_set_header X-Forwarded-For $remote_addr;

        proxy_pass http://localhost:9000;
        proxy_intercept_errors on;
    }
}
</code></pre>
</div>
</details>
<ol start="4">
<li>Activate the configuration by creating a simlink to <code>/etc/nginx/sites-enabled</code>:</li>
</ol>
<pre><code class="language-sh">ln -s /etc/nginx/sites-available/wss-config-nym /etc/nginx/sites-enabled
</code></pre>
<ol start="5">
<li>Test your configuration syntax:</li>
</ol>
<pre><code class="language-sh">nginx -t
</code></pre>
<ol start="6">
<li>Restart <code>nginx</code>:</li>
</ol>
<pre><code class="language-sh">systemctl restart nginx

</code></pre>
<ol start="7">
<li>Finally, configure your <code>nym-node</code> to announce the port you have setup. This is done by opening your node configuration file located at <code>~/.nym/nym-nodes/&lt;ID&gt;/config/config.toml</code> and changing the value of the line <code>announce_wss_port</code> in the <code>[entry_gateway]</code> section:</li>
</ol>
<pre><code>announce_wss_port =  &lt;WSS_PORT&gt;

# example
# announce_wss_port = 9001
</code></pre>
<ol start="8">
<li>Restart your <code>nym-node</code> :</li>
</ol>
<pre><code class="language-sh">systemctl restart nym-node
</code></pre>
<p>Your <code>nym-node</code> should be configured to run over WSS now. Test it using the steps in the chapter <a href="nodes/proxy-configuration.html#test-wss-setup">below</a>.</p>
<h3 id="test-wss-setup"><a class="header" href="#test-wss-setup">Test WSS Setup</a></h3>
<p>You can do a few quick checks to test that your installation worked out and your <code>nym-node</code> is running correctly using WSS:</p>
<ul>
<li>Check out connection with <code>wscat</code> from another (local) machine:</li>
</ul>
<pre><code class="language-sh"># install
sudo apt install node-ws

# run
wscat -c wss://&lt;HOSTNAME&gt;:&lt;WSS_PORT&gt;
</code></pre>
<ul>
<li>Check Swagger API of your node using the hostname: <code>https://&lt;HOSTNAME&gt;/api/v1/swagger/#/</code></li>
</ul>
<footer id="last-change">Last change: 2024-09-13, commit: <a href="https://github.com/nymtech/nym/commit/05d665217">05d665217</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="bonding-nym-node"><a class="header" href="#bonding-nym-node">Bonding Nym Node</a></h1>
<div id="admonition-caution" class="admonition admonish-warning" role="note" aria-labelledby="admonition-caution-title">
<div class="admonition-title">
<div id="admonition-caution-title">
<p>Caution</p>
</div>
<a class="admonition-anchor-link" href="nodes/bonding.html#admonition-caution"></a>
</div>
<div>
<p>If you unbond your Nym Node that means you are leaving the mixnet and you will lose all your delegations (permanently). You can join again with the same identity key, however, you will start with <strong>no delegations</strong>.</p>
</div>
</div>
<p>Nym Mixnet operators are rewarded for their work every epoch (60 minutes). To prevent centralisation, <a href="nodes/nym-api.html">Nym API</a> is ran by distributed validators on Nyx blockchain.</p>
<p>You are asked to <code>sign</code> a transaction and bpnd your node to Nyx blockchain so that the Mixnet smart contract is able to map your nym address to your node. This allows us to create a nonce for each account and defend against replay attacks.</p>
<p><strong>Before you bond your <code>nym-node</code> make sure you went through all the previous steps</strong></p>
<ol>
<li><a href="nodes/../binaries/building-nym.html">Build</a> or <a href="nodes/../binaries/pre-built-binaries.html">download</a> <code>nym-node</code> binary</li>
<li><a href="nodes/vps-setup.html">Configure VPS</a> correctly</li>
<li><a href="nodes/wallet-preparation.html">Prepare Nym wallet</a></li>
<li><a href="nodes/setup.html">Setup &amp; Run</a> the node</li>
<li><a href="nodes/configuration.html">Configure</a> the node (Optionally setup automation, WSS, reversed proxy)</li>
</ol>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="nodes/bonding.html#admonition-warning"></a>
</div>
<div>
<p>Do not bond your node to the API if the previous steps weren’t finished. Bad connectivity, closed ports, or other poor setup will result in your node getting blacklisted.</p>
</div>
</div>
<h2 id="bond-via-the-desktop-wallet-recommended"><a class="header" href="#bond-via-the-desktop-wallet-recommended">Bond via the Desktop wallet (recommended)</a></h2>
<p>You can bond your <code>nym-node</code> via the Desktop wallet.</p>
<ol>
<li>Open your wallet, and head to the <code>Bond</code> page, then select the node type <code>Mixnode</code> and input your node details. Press <code>Next</code>.</li>
</ol>
<ul>
<li>To find out your <code>nym-node</code> details, run <code>./nym-node bonding-information --id &lt;ID&gt;</code></li>
<li>To get a correct host address, run <code>echo "$(curl -4 https://ifconfig.me)"</code></li>
</ul>
<ol start="2">
<li>Open the box called <code>Show advanced options</code> and make sure all your ports are set correctly, like the values in this table:</li>
</ol>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Node type</th><th style="text-align: left">Port name</th><th style="text-align: left">Correct port value</th></tr></thead><tbody>
<tr><td style="text-align: left">Mixnode</td><td style="text-align: left">Mix port</td><td style="text-align: left"><code>1789</code></td></tr>
<tr><td style="text-align: left">Mixnode</td><td style="text-align: left">Verloc port</td><td style="text-align: left"><code>1790</code></td></tr>
<tr><td style="text-align: left">Mixnode</td><td style="text-align: left">HTTP api port (picture below)</td><td style="text-align: left"><code>8080</code></td></tr>
<tr><td style="text-align: left">Gateway (entry &amp; exit)</td><td style="text-align: left">Mix port</td><td style="text-align: left"><code>1789</code></td></tr>
<tr><td style="text-align: left">Gateway (entry &amp; exit)</td><td style="text-align: left">Client WS API port</td><td style="text-align: left"><code>9000</code></td></tr>
</tbody></table>
</div>
<ul>
<li>If you bonding <code>nym-node --mode mixnode</code> through <em>Bond mixnode</em> desktop wallet menu, change manually <em>HTTP api port</em> value from deprecated <code>8000</code> to <code>8080</code> - a generic <code>nym-node</code> HTTP port (for all modes).</li>
</ul>
<p><img src="nodes/../images/wallet-screenshots/new_http_port.png" alt="" /></p>
<ol start="3">
<li>
<p>Enter the <code>Amount</code>, <code>Operating cost</code> and <code>Profit margin</code> and press <code>Next</code>.</p>
</li>
<li>
<p>You will be asked to run a <code>sign</code> command with your <code>nym-node</code> - copy and paste the long signature as the value of <code>--contract-msg</code> and run it.</p>
</li>
</ol>
<pre><code>./nym-node sign --contract-msg &lt;PAYLOAD_GENERATED_BY_THE_WALLET&gt;
</code></pre>
<ol start="5">
<li>Copy the resulting signature string and paste it into the wallet nodal, press <code>Next</code> and confirm the transaction:</li>
</ol>
<pre><code class="language-sh"># This is just an example, copy the one from your process
&gt;&gt;&gt; The base58-encoded signature is:
2bbDJSmSo9r9qdamTNygY297nQTVRyQaxXURuomVcRd7EvG9oEC8uW8fvZZYnDeeC9iWyG9mAbX2K8rWEAxZBro1
</code></pre>
<p><img src="nodes/../images/wallet-screenshots/wallet-sign.png" alt="Paste Signature" /></p>
<p><em>This image is just an example, copy-paste your own base58-encoded signature</em></p>
<ol start="6">
<li>Your node will now be bonded and ready to recieve traffic, latest at the beginning of the next epoch (at most 1 hour)</li>
</ol>
<p>If everything worked, you’ll see your node running on the either the <a href="https://sandbox-explorer.nymtech.net">Sandbox testnet network explorer</a> or the <a href="https://explorer.nymtech.net">mainnet network explorer</a>, depending on which network you’re running.</p>
<h2 id="bond-via-the-cli-power-users"><a class="header" href="#bond-via-the-cli-power-users">Bond via the CLI (power users)</a></h2>
<p>If you want to bond your Mix Node via the CLI, then check out the <a href="https://nymtech.net/docs/tools/nym-cli.html#bond-a-mix-node">relevant section in the Nym CLI</a> docs.</p>
<footer id="last-change">Last change: 2024-07-17, commit: <a href="https://github.com/nymtech/nym/commit/3ad3837c8">3ad3837c8</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="validators"><a class="header" href="#validators">Validators</a></h1>
<blockquote>
<p>Nym has two main codebases:</p>
<ul>
<li>the <a href="https://github.com/nymtech/nym">Nym platform</a>, written in Rust. This contains all of our code except for the validators.</li>
<li>the <a href="https://github.com/nymtech/nyxd">Nym validators</a>, written in Go &amp; maintained as a no-modification fork of <a href="https://github.com/CosmWasm/wasmd">wasmd</a></li>
</ul>
</blockquote>
<p>The validator is a Go application which implements it’s functionalities using <a href="https://v1.cosmos.network/sdk">Cosmos SDK</a>. The underlying state-replication engine is powered by <a href="https://cometbft.com/">CometBFT</a>, where the consensus mechanism is based on the <a href="https://arxiv.org/abs/1807.04938">Tendermint Consensus Algorithm</a>. Finally, a <a href="https://cosmwasm.com">CosmWasm</a> smart contract module controls crucial mixnet functionalities like decentralised directory service, node bonding, and delegated mixnet staking.</p>
<blockquote>
<p>We are currently running mainnet with a closed set of reputable validators. To ensure decentralisation of Nyx chain, we are working on a mechanism to onboard new validators to the network. To join the waitlist, please drop an email to <code>validators [at] nymtech.net</code> with details of your setup, experience and any other relevent information</p>
</blockquote>
<h2 id="building-your-validator"><a class="header" href="#building-your-validator">Building your validator</a></h2>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable. Exchange it with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<h3 id="prerequisites-1"><a class="header" href="#prerequisites-1">Prerequisites</a></h3>
<h4 id="git-gcc-jq"><a class="header" href="#git-gcc-jq"><code>git</code>, <code>gcc</code>, <code>jq</code></a></h4>
<ul>
<li>Debian-based systems:</li>
</ul>
<pre><code>apt install git build-essential jq

# optional additional manual pages can be installed with:
apt-get install manpages-dev
</code></pre>
<ul>
<li>Arch-based systems:
Install <code>git</code>, <code>gcc</code> and <code>jq</code> with the following:</li>
</ul>
<pre><code>pacman -S git gcc jq
</code></pre>
<h4 id="go"><a class="header" href="#go"><code>Go</code></a></h4>
<p><code>Go</code> can be installed via the following commands (taken from the <a href="https://go.dev/doc/install">Go Download and install page</a>):</p>
<pre><code># First remove any existing old Go installation and extract the archive you just downloaded into /usr/local:
# You may need to run the command as root or through sudo
rm -rf /usr/local/go &amp;&amp; tar -C /usr/local -xzf go1.20.10.linux-amd64.tar.gz

# Add /usr/local/go/bin to the PATH environment variable
export PATH=$PATH:/usr/local/go/bin
source $HOME/.profile
</code></pre>
<p>Verify <code>Go</code> is installed with:</p>
<pre><code>go version
# Should return something like:
go version go1.20.10 linux/amd64
</code></pre>
<h3 id="download-a-precompiled-validator-binary"><a class="header" href="#download-a-precompiled-validator-binary">Download a precompiled validator binary</a></h3>
<p>You can find pre-compiled binaries for Ubuntu <code>22.04</code> and <code>20.04</code> <a href="https://github.com/nymtech/nyxd/releases">here</a>.</p>
<h3 id="manually-compiling-your-validator-binary"><a class="header" href="#manually-compiling-your-validator-binary">Manually compiling your validator binary</a></h3>
<p>The codebase for the Nyx validators can be found <a href="https://github.com/nymtech/nyxd">here</a>.</p>
<p>The validator binary can be compiled by running the following commands:</p>
<pre><code>git clone https://github.com/nymtech/nyxd.git
cd nyxd

# Make sure to check releases for the latest version information
git checkout release/&lt;NYXD_VERSION&gt;

# Build the binaries
make build
</code></pre>
<p>At this point, you will have a copy of the <code>nyxd</code> binary in your <code>build/</code> directory. Test that it’s compiled properly by running:</p>
<pre><code>./build/nyxd
</code></pre>
<p>You should see a similar help menu printed to you:</p>
<details id="admonition-console-output" class="admonition admonish-example" role="note" aria-labelledby="admonition-console-output-title">
<summary class="admonition-title">
<div id="admonition-console-output-title">
<p>Console output</p>
</div>
<a class="admonition-anchor-link" href="nodes/validator-setup.html#admonition-console-output"></a>
</summary>
<div>
<pre><code>Nyx Daemon (server)

Usage:
  nyxd [command]

Available Commands:
  completion  Generate the autocompletion script for the specified shell
  config      Create or query an application CLI configuration file
  debug       Tool for helping with debugging your application
  export      Export state to JSON
  genesis     Application's genesis-related subcommands
  help        Help about any command
  init        Initialize private validator, p2p, genesis, and application configuration files
  keys        Manage your application's keys
  prune       Prune app history states by keeping the recent heights and deleting old heights
  query       Querying subcommands
  rollback    rollback cosmos-sdk and tendermint state by one height
  rosetta     spin up a rosetta server
  start       Run the full node
  status      Query remote node for status
  tendermint  Tendermint subcommands
  testnet     subcommands for starting or configuring local testnets
  tx          Transactions subcommands
  version     Print the application binary version information

Flags:
  -h, --help                help for nyxd
      --home string         directory for config and data
      --log_format string   The logging format (json|plain) (default "plain")
      --log_level string    The logging level (trace|debug|info|warn|error|fatal|panic) (default "info")
      --trace               print out full stack trace on errors

Use "nyxd [command] --help" for more information about a command.
</code></pre>
</div>
</details>
<h3 id="linking-nyxd-to-libwasmvmso"><a class="header" href="#linking-nyxd-to-libwasmvmso">Linking <code>nyxd</code> to <code>libwasmvm.so</code></a></h3>
<p><code>libwasmvm.so</code> is the wasm virtual machine which is needed to execute smart contracts in <code>v0.26.1</code>. This file is renamed in <code>libwasmvm.x86_64.so</code> in <code>v0.31.1</code> and above.</p>
<p>If you downloaded your <code>nyxd</code> binary from Github, you will have seen this file when un-<code>tar</code>-ing the <code>.tar.gz</code> file from the releases page.</p>
<p>If you are seeing an error concerning this file when trying to run <code>nyxd</code>, then you need to move the <code>libwasmvm.x86_64.so</code> file to correct location.</p>
<p>Simply <code>cp</code> or <code>mv</code> that file to <code>/lib/x86_64-linux-gnu/</code> and re-run <code>nyxd</code>.</p>
<h3 id="adding-nyxd-to-your-path"><a class="header" href="#adding-nyxd-to-your-path">Adding <code>nyxd</code> to your <code>$PATH</code></a></h3>
<p>You’ll need to set <code>LD_LIBRARY_PATH</code> in your user’s <code>~/.bashrc</code> or <code>~/.zshrc</code> file (depends on the terminal you use), and add that to our path. Replace <code>/home/&lt;USER&gt;/&lt;PATH-TO-NYM&gt;/binaries</code> in the command below to the locations of <code>nyxd</code> and <code>libwasmvm.so</code> and run it. If you have compiled these on the server, they will be in the <code>build/</code> folder:</p>
<pre><code>NYX_BINARIES=/home/&lt;USER&gt;/&lt;PATH-TO-VALIDATOR&gt;/&lt;BINARY&gt;

# if you are using another shell like zsh replace '.bashrc' with the relevant config file
echo 'export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:'NYX_BINARIES &gt;&gt; ~/.bashrc
echo 'export PATH=$PATH:'${NYX_BINARIES} &gt;&gt; ~/.bashrc
source ~/.bashrc
</code></pre>
<p>Test everything worked:</p>
<pre><code>nyxd
</code></pre>
<p>This should return the regular help menu:</p>
<details id="admonition-console-output-1" class="admonition admonish-example" role="note" aria-labelledby="admonition-console-output-1-title">
<summary class="admonition-title">
<div id="admonition-console-output-1-title">
<p>Console output</p>
</div>
<a class="admonition-anchor-link" href="nodes/validator-setup.html#admonition-console-output-1"></a>
</summary>
<div>
<pre><code>Nyx Daemon (server)

Usage:
  nyxd [command]

Available Commands:
  completion  Generate the autocompletion script for the specified shell
  config      Create or query an application CLI configuration file
  debug       Tool for helping with debugging your application
  export      Export state to JSON
  genesis     Application's genesis-related subcommands
  help        Help about any command
  init        Initialize private validator, p2p, genesis, and application configuration files
  keys        Manage your application's keys
  prune       Prune app history states by keeping the recent heights and deleting old heights
  query       Querying subcommands
  rollback    rollback cosmos-sdk and tendermint state by one height
  rosetta     spin up a rosetta server
  start       Run the full node
  status      Query remote node for status
  tendermint  Tendermint subcommands
  testnet     subcommands for starting or configuring local testnets
  tx          Transactions subcommands
  version     Print the application binary version information

Flags:
  -h, --help                help for nyxd
      --home string         directory for config and data
      --log_format string   The logging format (json|plain) (default "plain")
      --log_level string    The logging level (trace|debug|info|warn|error|fatal|panic) (default "info")
      --trace               print out full stack trace on errors

Use "nyxd [command] --help" for more information about a command.
</code></pre>
</div>
</details>
<h2 id="initialising-your-validator"><a class="header" href="#initialising-your-validator">Initialising your validator</a></h2>
<h3 id="prerequisites-2"><a class="header" href="#prerequisites-2">Prerequisites:</a></h3>
<ul>
<li>FQDN Domain name</li>
<li>IPv4 and IPv6 connectivity</li>
</ul>
<p>Choose a name for your validator and use it in place of <code>&lt;ID&gt;</code> in the following command:</p>
<pre><code># Mainnet
nyxd init &lt;ID&gt; --chain-id=nyx

# Sandbox testnet
nyxd init &lt;ID&gt; --chain-id=sandbox
</code></pre>
<div id="admonition-default" class="admonition admonish-warning" role="note">
<div>
<p><code>init</code> generates <code>priv_validator_key.json</code> and <code>node_key.json</code>.</p>
<p>If you have already set up a validator on a network, <strong>make sure to back up the key located at</strong>
<code>~/.nyxd/config/priv_validator_key.json</code>.</p>
<p>If you don’t save the validator key, then it can’t sign blocks and will be jailed all the time, and
there is no way to deterministically (re)generate this key.</p>
</div>
</div>
<p>At this point, you have a new validator, with its own genesis file located at <code>$HOME/.nyxd/config/genesis.json</code>. You will need to replace the contents of that file that with either the Nyx Mainnet or Sandbox Testnet genesis file.</p>
<p>You can use the following command to download them for the correct network:</p>
<pre><code># Mainnet
wget  -O $HOME/.nyxd/config/genesis.json https://nymtech.net/genesis/genesis.json

# Sandbox testnet
curl https://rpc.sandbox.nymtech.net/snapshots/genesis.json | jq '.result.genesis' &gt; $HOME/.nyxd/config/genesis.json
</code></pre>
<h3 id="configtoml-configuration"><a class="header" href="#configtoml-configuration"><code>config.toml</code> configuration</a></h3>
<p>Edit the following config options in <code>$HOME/.nyxd/config/config.toml</code> to match the information below for your network:</p>
<pre><code># Mainnet
persistent_peers = "ee03a6777fb76a2efd0106c3769daaa064a3fcb5@51.79.21.187:26656"
laddr = "tcp://0.0.0.0:26656"
</code></pre>
<pre><code># Sandbox testnet
cors_allowed_origins = ["*"]
persistent_peers = "26f7782aff699457c8e6dd9a845e5054c9b0707e@:3.72.19.120:26656"
laddr = "tcp://0.0.0.0:26656"
</code></pre>
<p>These affect the following:</p>
<ul>
<li><code>persistent_peers = "&lt;PEER_ADDRESS&gt;@&lt;DOMAIN&gt;.nymtech.net:26666"</code> allows your validator to start pulling blocks from other validators. <strong>The main sandbox validator listens on <code>26666</code> instead of the default <code>26656</code> for debugging</strong>. It is recommended you do not change your port from <code>26656</code>.</li>
<li><code>laddr = "tcp://0.0.0.0:26656"</code> is in your p2p configuration options</li>
</ul>
<p>Optionally, if you want to enable <a href="https://prometheus.io/">Prometheus</a> metrics then the following must also match in the <code>config.toml</code>:</p>
<ul>
<li><code>prometheus = true</code></li>
<li><code>prometheus_listen_addr = ":26660"</code></li>
</ul>
<blockquote>
<p>Remember to enable metrics in the ‘Configuring Prometheus metrics’ section below as well.</p>
</blockquote>
<p>And if you wish to add a human-readable moniker to your node:</p>
<ul>
<li><code>moniker = "&lt;YOUR_VALIDATOR_NAME&gt;"</code></li>
</ul>
<p>Finally, if you plan on using <a href="https://cockpit-project.org/documentation.html">Cockpit</a> on your server, change the <code>grpc</code> port from <code>9090</code> as this is the port used by Cockpit.</p>
<h3 id="apptoml-configuration"><a class="header" href="#apptoml-configuration"><code>app.toml</code> configuration</a></h3>
<p>In the file <code>$HOME/.nyxd/config/app.toml</code>, set the following values:</p>
<pre><code># Mainnet
minimum-gas-prices = "0.025unym,0.025unyx"
</code></pre>
<pre><code># Sandbox Testnet
minimum-gas-prices = "0.025unym,0.025unyx"
</code></pre>
<h3 id="setting-up-your-validators-admin-user"><a class="header" href="#setting-up-your-validators-admin-user">Setting up your validator’s admin user</a></h3>
<p>You’ll need an admin account to be in charge of your validator. Set that up with:</p>
<pre><code>nyxd keys add nyxd-admin
</code></pre>
<div id="admonition-key-backends" class="admonition admonish-tip" role="note" aria-labelledby="admonition-key-backends-title">
<div class="admonition-title">
<div id="admonition-key-backends-title">
<p>Key Backends</p>
</div>
<a class="admonition-anchor-link" href="nodes/validator-setup.html#admonition-key-backends"></a>
</div>
<div>
<p>Cosmos SDK offers multiple backends for securing your keys. Please refer to the Cosmos SDK <a href="https://docs.cosmos.network/main/user/run-node/keyring#available-backends-for-the-keyring">docs on available keyring backends</a> to learn more</p>
</div>
</div>
<p>While using the default settings, this will add keys for your account to your system’s keychain and log your name, address, public key, and mnemonic. As the instructions say, remember to <strong>write down your mnemonic</strong>.</p>
<p>You can get the current account address with:</p>
<pre><code>nyxd keys show nyxd-admin -a
</code></pre>
<p>Type in your keychain <strong>password</strong>, not the mnemonic, when asked.</p>
<h2 id="starting-your-validator"><a class="header" href="#starting-your-validator">Starting your validator</a></h2>
<p>Everything should now be ready to go. You’ve got the validator set up, all changes made in <code>config.toml</code> and <code>app.toml</code>, the Nym genesis file copied into place (replacing the initial auto-generated one). Now let’s validate the whole setup:</p>
<pre><code>nyxd validate-genesis
</code></pre>
<p>If this check passes, you should receive the following output:</p>
<pre><code>File at /path/to/genesis.json is a valid genesis file
</code></pre>
<blockquote>
<p>If this test did not pass, check that you have replaced the contents of <code>/&lt;PATH-TO&gt;/.nyxd/config/genesis.json</code> with that of the correct genesis file.</p>
</blockquote>
<h3 id="setting-up-nyxd-as-full-node-non-signing"><a class="header" href="#setting-up-nyxd-as-full-node-non-signing">Setting up nyxd as full node (non-signing)</a></h3>
<div id="admonition-default-1" class="admonition admonish-danger" role="note">
<div>
<p>Skip this section if you’re planning to run a validator node to join network consensus. To ensure security &amp; maximum availability of validators, do not expose additional services to the Internet</p>
</div>
</div>
<p>Unlike signing validators, full nodes do not propose / sign blocks. A full node is typically used for indexing blocks produced on the chain and for exposing web interfaces such as RPC, API and gRPC endpoints required for external applications/services to interact with the blockchain.</p>
<p>By default, API server is disabled and RPC/gRPC servers listen to the loopback address only. In a production setup, it is recommended to use a webserver such as Nginx or caddy to proxy requests to the endpoints as required.</p>
<p>To enable Cosmos REST API, you can enable it in <code>$HOME/.nyxd/config/app.toml</code> like :</p>
<pre><code>[api]

# Enable defines if the API server should be enabled. Toggle this to `true`
enable = true

# Swagger defines if swagger documentation should automatically be registered.
# You can also expose swagger documentation by toggling the below configuration to true
swagger = true
</code></pre>
<p>For more information on enabling access to various endpoints via Nginx, refer to the <a href="nodes/./maintenance.html#setup">example configuration here</a></p>
<h3 id="open-firewall-ports"><a class="header" href="#open-firewall-ports">Open firewall ports</a></h3>
<p>Before starting the validator, we will need to open the firewall ports:</p>
<pre><code># if ufw is not already installed:
sudo apt install ufw
sudo ufw enable

# Customise according to your port bindings. This is only for reference
# 26656 : p2p gossip port
# 26660: If prometheus is enabled
# 22 : Default SSH port
sudo ufw allow 26656,26660,22

## !! FOR FULL NODES ONLY !! - exposing Nginx for serving web requests
sudo ufw allow 80,443

# to check everything worked
sudo ufw status
</code></pre>
<p>For more information about your validator’s port configuration, check the <a href="nodes/./maintenance.html#ports">validator port reference table</a> below. These can be customised in <code>app.toml</code> and <code>config.toml</code> files.</p>
<blockquote>
<p>If you are planning to use <a href="https://cockpit-project.org/">Cockpit</a> on your validator server then you will have defined a different <code>grpc</code> port in your <code>config.toml</code> above: remember to open this port as well.</p>
</blockquote>
<p>Start the validator:</p>
<pre><code>nyxd start
</code></pre>
<p>Once your validator starts, it will start requesting blocks from other validators. This may take several hours. Once it’s up to date, you can issue a request to join the validator set with the command below.</p>
<h3 id="syncing-from-a-snapshot"><a class="header" href="#syncing-from-a-snapshot">Syncing from a snapshot</a></h3>
<p>If you wish to sync from a snapshot on <strong>mainnet</strong> use Polkachu’s <a href="https://polkachu.com/networks/nym">mainnet</a> resources.</p>
<p>If you wish to sync from a snapshot on <strong>Sandbox testnet</strong> use the below commands, which are a modified version of Polkachu’s excellent resources. These commands assume you are running an OS with <code>apt</code> as the package manager:</p>
<pre><code># install lz4 if necessary
sudo apt install snapd -y
sudo snap install lz4

# download the snapshot
wget -O nyxd-sandbox-snapshot-data.tar.lz4 https://rpc.sandbox.nymtech.net/snapshots/nyxd-sandbox-snapshot-data.tar.lz4

# reset your validator state
nyxd tendermint unsafe-reset-all

# unpack the snapshot
lz4 -c -d nyxd-sandbox-snapshot-data.tar.lz4 | tar -x -C $HOME/.nyxd
</code></pre>
<p>You can then restart <code>nyxd</code> - it should start syncing from a block &gt; 2000000.</p>
<h3 id="joining-consensus"><a class="header" href="#joining-consensus">Joining Consensus</a></h3>
<div id="admonition-default-2" class="admonition admonish-info" role="note">
<div>
<p>You can skip this section if you are planning to run a full-node. This step will make your node a signing validator which joins network consensus</p>
</div>
</div>
<p>Once your validator has synced and you have received tokens, you can join consensus and produce blocks.</p>
<pre><code># Mainnet
nyxd tx staking create-validator
  --amount=&lt;10000000unyx&gt;
  --pubkey=$(/home/&lt;USER&gt;/&lt;PATH-TO&gt;/nyxd/binaries/nyxd tendermint show-validator)
  --moniker="&lt;YOUR_VALIDATOR_NAME&gt;"
  --chain-id=nyx
  --commission-rate="0.10"
  --commission-max-rate="0.20"
  --commission-max-change-rate="0.01"
  --min-self-delegation="1"
  --gas="auto"
  --gas-adjustment=1.15
  --gas-prices=0.025unyx
  --from=&lt;"KEYRING_NAME"&gt;
  --node=https://rpc.nymtech.net:443
</code></pre>
<pre><code># Sandbox Testnet
nyxd tx staking create-validator
  --amount=&lt;10000000unyx&gt;
  --pubkey=$(/home/&lt;USER&gt;/&lt;PATH-TO&gt;/nym/binaries/nyxd tendermint show-validator)
  --moniker="&lt;YOUR_VALIDATOR_NAME&gt;"
  --chain-id=sandbox
  --commission-rate="0.10"
  --commission-max-rate="0.20"
  --commission-max-change-rate="0.01"
  --min-self-delegation="1"
  --gas="auto"
  --gas-adjustment=1.15
  --gas-prices=0.025unyx
  --from=&lt;"KEYRING_NAME"&gt;
  --node https://rpc.sandbox.nymtech.net:443
</code></pre>
<p>You’ll need Nyx tokens on mainnet / sandbox to perform the above tasks.</p>
<p>If you want to edit some details for your node you will use a command like this:</p>
<pre><code># Mainnet
nyxd tx staking edit-validator
  --chain-id=nyx
  --moniker="&lt;YOUR_VALIDATOR_NAME&gt;"
  --details="Nyx validator"
  --security-contact="&lt;YOUR_EMAIL&gt;"
  --identity="&lt;YOUR_IDENTITY&gt;"
  --gas="auto"
  --gas-adjustment=1.15
  --gas-prices=0.025unyx
  --from="KEYRING_NAME"
</code></pre>
<pre><code># Sandbox testnet
nyxd tx staking edit-validator
  --chain-id=sandbox
  --moniker="&lt;YOUR_VALIDATOR_NAME&gt;"
  --details="Sandbox testnet validator"
  --security-contact="your email"
  --identity="&lt;YOUR_IDENTITY&gt;"
  --gas="auto"
  --gas-adjustment=1.15
  --gas-prices=0.025unyx
  --from="KEYRING_NAME"
</code></pre>
<p>With above command you can specify the <code>gpg</code> key last numbers (as used in <code>keybase</code>) as well as validator details and your email for security contact.</p>
<h3 id="automating-your-validator-with-systemd"><a class="header" href="#automating-your-validator-with-systemd">Automating your validator with systemd</a></h3>
<p>You will most likely want to automate your validator restarting if your server reboots. Checkout the <a href="nodes/./maintenance.html#systemd">maintenance page</a> with a quick tutorial.</p>
<h3 id="setting-the-ulimit-1"><a class="header" href="#setting-the-ulimit-1">Setting the ulimit</a></h3>
<p>Linux machines limit how many open files a user is allowed to have. This is called a <code>ulimit</code>. We need to set it to a higher value than the default 1024. Follow the instructions in the <a href="nodes/./maintenance.html#Setting-the-ulimit">maintenance page</a> to change the <code>ulimit</code> value for validators.</p>
<h2 id="using-your-validator"><a class="header" href="#using-your-validator">Using your validator</a></h2>
<h3 id="un-jailing-your-validator"><a class="header" href="#un-jailing-your-validator">Un-jailing your validator</a></h3>
<p>If your validator gets jailed, you can fix it with the following command:</p>
<pre><code># Mainnet
nyxd tx slashing unjail
  --broadcast-mode=block
  --from="KEYRING_NAME"
  --chain-id=nyx
  --gas=auto
  --gas-adjustment=1.4
  --gas-prices=0.025unyx
</code></pre>
<pre><code># Sandbox Testnet
nyxd tx slashing unjail
  --broadcast-mode=block
  --from="KEYRING_NAME"
  --chain-id=sandbox
  --gas=auto
  --gas-adjustment=1.4
  --gas-prices=0.025unyx
</code></pre>
<h3 id="upgrading-your-validator"><a class="header" href="#upgrading-your-validator">Upgrading your validator</a></h3>
<p>To upgrade your validator, follow the steps on the <a href="nodes/./maintenance.html#setting-the-ulimit">maintenance page</a>.</p>
<h4 id="common-reasons-for-your-validator-being-jailed"><a class="header" href="#common-reasons-for-your-validator-being-jailed">Common reasons for your validator being jailed</a></h4>
<p>Your validator will be jailed if your node:</p>
<ul>
<li>misses <em><code>x</code></em> amount of blocks in <em><code>y</code></em> interval, where <em><code>x</code></em> and <em><code>y</code></em> are parameters set by chain governance</li>
<li>performs double signing (two conflicting signatures on the same block using the same key)</li>
</ul>
<p>Double signing is a serious infraction. If a node double signs, all the delegators to the node (including self-delegation) will be slashed by 5%. Additionally, the node will be permanently jailed and removed from consensus (called <em>tombstoning</em>)</p>
<p>One of the most common reason for your validator being jailed is that your validator is out of memory because of bloated syslogs.</p>
<p>Running the command <code>df -H</code> will return the size of the various partitions of your VPS. If the partition with blockchain data is almost full, try pruning the blockchain data or expanding the storage size.</p>
<h3 id="day-2-operations-with-your-validator"><a class="header" href="#day-2-operations-with-your-validator">Day 2 operations with your validator</a></h3>
<p>You can check your current balances with:</p>
<pre><code>nyxd query bank balances ${ADDRESS}
</code></pre>
<p>For example, on the Sandbox testnet this would return:</p>
<pre><code class="language-yaml">balances:
- amount: "919376"
denom: unym
pagination:
next_key: null
total: "0"
</code></pre>
<p>You can, of course, stake back the available balance to your validator with the following command.</p>
<blockquote>
<p>Remember to save some tokens for gas costs!</p>
</blockquote>
<pre><code># Mainnet
nyxd tx staking delegate VALOPERADDRESS AMOUNTunyx
  --from="KEYRING_NAME"
  --keyring-backend=os
  --chain-id=nyx
  --gas="auto"
  --gas-adjustment=1.15
  --gas-prices=0.025unyx

# Sandbox Testnet
nyxd tx staking delegate VALOPERADDRESS AMOUNTunyx
  --from="KEYRING_NAME"
  --keyring-backend=os
  --chain-id=sandbox
  --gas="auto"
  --gas-adjustment=1.15
  --gas-prices=0.025unyx
</code></pre>
<footer id="last-change">Last change: 2023-12-21, commit: <a href="https://github.com/nymtech/nym/commit/a1dd9e656">a1dd9e656</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nym-api-setup"><a class="header" href="#nym-api-setup">Nym API Setup</a></h1>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable. Exchange with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<h2 id="what-is-the-nym-api"><a class="header" href="#what-is-the-nym-api">What is the Nym API?</a></h2>
<p>The Nym API is a binary that will be operated by the Nyx validator set. This binary can be run in several different modes, and has two main bits of functionality:</p>
<ul>
<li>network monitoring (calculating the routing score of Mixnet nodes)</li>
<li>generation and validation of <a href="https://blog.nymtech.net/zk-nyms-are-here-a-major-milestone-towards-a-market-ready-mixnet-a3470c9ab10a">zk-nyms</a>, our implementation of the Coconut Selective Disclosure Credential Scheme.</li>
</ul>
<p>This is important for both the proper decentralisation of the network uptime calculation and, more pressingly, enabling the NymVPN to utilise privacy preserving payments.</p>
<p>The process of enabling these different aspects of the system will take time. At the moment, Nym API operators will only have to run the binary in a minimal ‘caching’ mode in order to get used to maintaining an additional process running alongside a full node.</p>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="nodes/nym-api.html#admonition-warning"></a>
</div>
<div>
<p>It is highly recommended to run <code>nym-api</code> alongside a full node and NOT a validator node, since you will be exposing HTTP port(s) to the Internet. We also observed degradation in p2p and block signing operations when <code>nym-api</code> was run alongside a signing validator.</p>
</div>
</div>
<h3 id="rewards"><a class="header" href="#rewards">Rewards</a></h3>
<p>Operators of Nym API will be rewarded for performing the extra work of taking part in credential generation. These rewards will be calculated <strong>separately</strong> from rewards for block production.</p>
<p>Rewards for credential signing will be calculated hourly, with API operators receiving a proportional amount of the reward pool (333NYM per hour / 237,600 NYM per month), proportional to the percentage of credentials they have signed.</p>
<h3 id="hardware-requirements"><a class="header" href="#hardware-requirements">Hardware Requirements</a></h3>
<p>The specification mentioned below is for running a full node alongside the nym-api. It is recommended to run <code>nym-api</code> and a full Nyx node on the same machine for optimum performance.</p>
<p>Bear in mind that credential signing is primarily CPU-bound, so choose the fastest CPU available to you.</p>
<h4 id="minimum-requirements-1"><a class="header" href="#minimum-requirements-1">Minimum Requirements</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Hardware</th><th>Minimum Specification</th></tr></thead><tbody>
<tr><td>CPU</td><td>8-cores, 2.8GHz base clock speed or higher</td></tr>
<tr><td>RAM</td><td>16GB DDR4+</td></tr>
<tr><td>Disk</td><td>500 GiB+ NVMe SSD</td></tr>
</tbody></table>
</div>
<h4 id="recommended-requirements-1"><a class="header" href="#recommended-requirements-1">Recommended Requirements</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Hardware</th><th>Minimum Specification</th></tr></thead><tbody>
<tr><td>CPU</td><td>16-cores, 2.8GHz base clock speed or higher</td></tr>
<tr><td>RAM</td><td>32GB DDR4+</td></tr>
<tr><td>Disk</td><td>1 TiB+ NVMe SSD</td></tr>
</tbody></table>
</div>
<h3 id="full-node-configuration"><a class="header" href="#full-node-configuration">Full node configuration</a></h3>
<p>To install a full node from scratch, refer to the <a href="nodes/./validator-setup.html">validator setup guide</a> and follow the steps outlined there.
Additionally, to ensure <code>nym-api</code> works as expected, ensure the configuration is as below:</p>
<h4 id="ensure-transaction-index-is-turned-on-in-your-configtoml"><a class="header" href="#ensure-transaction-index-is-turned-on-in-your-configtoml">Ensure transaction index is turned on in your <code>config.toml</code>:</a></h4>
<pre><code>[tx_index]

# Ensure that this is not set to "null". You're free to use any indexer

indexer = "kv"
</code></pre>
<h4 id="ensure-pruning-settings-are-manually-configured"><a class="header" href="#ensure-pruning-settings-are-manually-configured">Ensure pruning settings are manually configured</a></h4>
<p><code>nym-api</code> needs to check validity of user-submitted transactions (in the past) while issuing credentials and as part of double-spend check. Hence, aggressively pruning data will lead to errors with your <code>nym-api</code></p>
<p>Make sure your pruning settings are configured as below in <code>app.toml</code>:</p>
<pre><code>pruning = "custom"

# This number is likely to be updated once zk-nym signing goes live
pruning-keep-recent = "750000"
pruning-interval = "100"
</code></pre>
<p>The example value of <code>100</code> for <code>pruning-interval</code> can be customised as per your requirement.</p>
<h3 id="credential-generation"><a class="header" href="#credential-generation">Credential Generation</a></h3>
<p>Validators that take part in the DKG ceremony will become part of the ‘quorum’ generating and verifying zk-nym credentials. These will initially be used for private proof of payment for NymVPN (see our blogposts <a href="https://blog.nymtech.net/nymvpn-an-invitation-for-privacy-experts-and-enthusiasts-63644139d09d">here</a> and <a href="https://blog.nymtech.net/zk-nyms-are-here-a-major-milestone-towards-a-market-ready-mixnet-a3470c9ab10a">here</a> for more on this), and in the future will be expanded into more general usecases such as <a href="https://arxiv.org/abs/2303.08221">offline ecash</a>.</p>
<p>The DKG ceremony will be used to create a subset of existing validators who run <code>nym-api</code> alongside a Nyx full-node. As outlined above, they will be the ones taking part in the generation and verification of zk-nym credentials. The size of the ‘minimum viable quorum’ is 10 - we are aiming for a larger number than this for the initial quorum in order to have some redundancy in the case of a validator dropping or going offline.</p>
<p>We will be releasing more detailed step-by-step documentation for involved validators nearer to the ceremony itself, but at a high level it will involve:</p>
<ul>
<li>the deployment and initialisation of <a href="https://github.com/nymtech/nym/tree/develop/contracts/multisig/cw4-group"><code>group</code></a> and <a href="https://github.com/nymtech/nym/tree/develop/contracts/multisig"><code>multisig</code></a> contracts by Nym. Validators that are members of the <code>group</code> contract are the only ones that will be able to take part in the ceremony.</li>
<li>the deployment and initialisation of an instance of the <a href="https://github.com/nymtech/nym/tree/develop/contracts/coconut-dkg">DKG contract</a> by Nym.</li>
<li>Validators will update their <code>nym-api</code> configs with the address of the deployed contracts. They will also stop running their API instance in caching only mode, instead switching over run with the <code>--enabled-credentials-mode</code>.</li>
<li>From the perspective of operators, this is all they have to do. Under the hood, each <code>nym-api</code> instance will then take part in several rounds of key submission, verification, and derivation. This will continue until quorum is acheived.</li>
</ul>
<p><strong>We will be communicating individually with members of the existing validator set who have expressed interest in joining the quorum concerning the timing and specifics of the ceremony</strong>.</p>
<h2 id="current-version-1"><a class="header" href="#current-version-1">Current version</a></h2>
<pre><code>1.1.42
</code></pre>
<h2 id="setup-and-usage"><a class="header" href="#setup-and-usage">Setup and Usage</a></h2>
<h3 id="viewing-command-help"><a class="header" href="#viewing-command-help">Viewing command help</a></h3>
<p>You can check that your binary is properly compiled with:</p>
<pre><code>./nym-api --help
</code></pre>
<p>Which should return a list of all available commands.</p>
<details id="admonition-console-output" class="admonition admonish-example" role="note" aria-labelledby="admonition-console-output-title">
<summary class="admonition-title">
<div id="admonition-console-output-title">
<p>Console output</p>
</div>
<a class="admonition-anchor-link" href="nodes/nym-api.html#admonition-console-output"></a>
</summary>
<div>
<pre><code>Usage: nym-api [OPTIONS] &lt;COMMAND&gt;

Commands:
  init        Initialise a Nym Api instance with persistent config.toml file
  run         Run the Nym Api with provided configuration optionally overriding set parameters
  build-info  Show build information of this binary
  help        Print this message or the help of the given subcommand(s)

Options:
  -c, --config-env-file &lt;CONFIG_ENV_FILE&gt;
          Path pointing to an env file that configures the Nym API
      --no-banner
          A no-op flag included for consistency with other binaries (and compatibility with nymvisor, oops)
  -h, --help
          Print help
  -V, --version
          Print version
</code></pre>
</div>
</details>
<p>You can also check the various arguments required for individual commands with:</p>
<pre><code>./nym-api &lt;COMMAND&gt; --help
</code></pre>
<h3 id="initialising-your-nym-api-instance-in-caching-mode"><a class="header" href="#initialising-your-nym-api-instance-in-caching-mode">Initialising your Nym API Instance in caching mode</a></h3>
<p>Initialise your API instance with:</p>
<pre><code>./nym-api init
</code></pre>
<p>You can optionally pass a local identifier for this instance with the <code>--id</code> flag. Otherwise the ID of your instance defaults to <code>default</code>.</p>
<h3 id="enabling-credential-signing-on-your-nym-api-instance"><a class="header" href="#enabling-credential-signing-on-your-nym-api-instance">Enabling credential signing on your Nym API instance</a></h3>
<p>To engage in the Distributed Key Generation (DKG) ceremony, it’s essential to transition your <code>nym-api</code> instance from its default caching mode to the active credential signing mode. This section guides you through the process of enabling credential signing</p>
<h4 id="generate-a-new-wallet"><a class="header" href="#generate-a-new-wallet">Generate a new wallet</a></h4>
<p>Begin by generating a new wallet address specifically for your instance to use in credential signing mode. Utilize the <code>nyxd</code> command-line tool with the following command:</p>
<pre><code>nyxd keys add signer
</code></pre>
<div id="admonition-backup-your-keys" class="admonition admonish-warning" role="note" aria-labelledby="admonition-backup-your-keys-title">
<div class="admonition-title">
<div id="admonition-backup-your-keys-title">
<p>Backup your keys!</p>
</div>
<a class="admonition-anchor-link" href="nodes/nym-api.html#admonition-backup-your-keys"></a>
</div>
<div>
<p>It’s critical to securely back up the mnemonic phrase generated during this process. This mnemonic is your key to recovering the wallet in the future, so store it in a secure, offline location.</p>
</div>
</div>
<h4 id="fund-the-address"><a class="header" href="#fund-the-address">Fund the address</a></h4>
<p>Next, deposit NYM tokens into the newly created wallet address to ensure it can cover transaction fees incurred during the credential signing process. <code>nym-api</code> will not operate if the wallet’s balance falls below 10 NYM tokens, displaying an error message upon startup.</p>
<p>We recommand beginning with an initial deposit of 100 NYM tokens and monitoring the balance regularly, topping it up as necessary to maintain operational readiness.</p>
<h4 id="update-api-configuration"><a class="header" href="#update-api-configuration">Update API configuration</a></h4>
<p>With your new wallet ready and funded, proceed to update your <code>nym-api</code> configuration to enable credential signing:</p>
<p>Update your <code>config.toml</code> located in <code>&lt;HOME_DIR&gt;/.nym/nym-api/foo/config/config.toml</code> as below:</p>
<p>Enable the coconut signer:</p>
<pre><code>[coconut_signer]
# Specifies whether coconut signing protocol is enabled in this process.
enabled = true  # This was previously false
</code></pre>
<p>Set your announce address if it is empty. This is the URL you previously configured for your <code>nym-api</code> instance</p>
<pre><code># This is the address you previously configured for the nym-api
# Not to be confused with the Cosmos REST API URL
announce_address = 'https://nym-api.your.tld/'
</code></pre>
<p>Finally, input the mnemonic phrase generated during the wallet creation step into the mnemonic field</p>
<pre><code>mnemonic = '&lt;YOUR_MNEMONIC_HERE&gt;'
</code></pre>
<p>After completing these steps, your <code>nym-api</code> instance is configured to participate in credential signing and the DKG ceremony.</p>
<h3 id="running-your-nym-api-instance"><a class="header" href="#running-your-nym-api-instance">Running your Nym API Instance</a></h3>
<p>The API binary currently defaults to running in caching mode. You can run your API with:</p>
<pre><code>./nym-api run --id &lt;YOUR_ID&gt;
</code></pre>
<p>By default the API will be trying to query your full node running locally on <code>localhost:26657</code>. If your node is hosted elsewhere, you can specify the RPC location by using the <code>--nyxd-validator </code> flag on <code>run</code>:</p>
<pre><code>./nym-api run --id &lt;YOUR_ID&gt; --nyxd-validator https://rpc-nym.yourcorp.tld:443
</code></pre>
<blockquote>
<p>You can also change the value of <code>local_validator</code> in the config file found by default in <code>$HOME/.nym/nym-api/&lt;ID&gt;/config/config.toml</code>.</p>
</blockquote>
<p>This process is quite noisy, but informative:</p>
<details id="admonition-console-output-1" class="admonition admonish-example" role="note" aria-labelledby="admonition-console-output-1-title">
<summary class="admonition-title">
<div id="admonition-console-output-1-title">
<p>Console output</p>
</div>
<a class="admonition-anchor-link" href="nodes/nym-api.html#admonition-console-output-1"></a>
</summary>
<div>
<pre><code>Starting nym api...
 2023-12-12T14:29:55.800Z INFO  rocket::launch &gt; 🔧 Configured for release.
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; address: 127.0.0.1
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; port: 8000
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; workers: 4
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; max blocking threads: 512
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; ident: Rocket
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; IP header: X-Real-IP
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; limits: bytes = 8KiB, data-form = 2MiB, file = 1MiB, form = 32KiB, json = 1MiB, msgpack = 1MiB, string = 8KiB
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; temp dir: /tmp
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; http/2: true
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; keep-alive: 5s
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; tls: disabled
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; shutdown: ctrlc = true, force = true, signals = [SIGTERM], grace = 2s, mercy = 3s
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; log level: critical
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; cli colors: true
 2023-12-12T14:29:55.800Z INFO  rocket::launch    &gt; 📬 Routes:
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_registered_names) GET /v1/names
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_mixnodes) GET /v1/mixnodes
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_gateways) GET /v1/gateways
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_services) GET /v1/services
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /v1/openapi.json
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_full_circulating_supply) GET /v1/circulating-supply
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_current_epoch) GET /v1/epoch/current
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_active_set) GET /v1/mixnodes/active
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_mixnodes_detailed) GET /v1/mixnodes/detailed
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_rewarded_set) GET /v1/mixnodes/rewarded
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_gateways_described) GET /v1/gateways/described
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_interval_reward_params) GET /v1/epoch/reward_params
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_blacklisted_mixnodes) GET /v1/mixnodes/blacklisted
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_blacklisted_gateways) GET /v1/gateways/blacklisted
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_total_supply) GET /v1/circulating-supply/total-supply-value
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_circulating_supply) GET /v1/circulating-supply/circulating-supply-value
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_active_set_detailed) GET /v1/mixnodes/active/detailed
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_rewarded_set_detailed) GET /v1/mixnodes/rewarded/detailed
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /cors/&lt;status&gt;
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /swagger/
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /swagger/index.css
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /swagger/index.html
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /swagger/swagger-ui.css
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /swagger/oauth2-redirect.html
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /swagger/swagger-ui-bundle.js
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /swagger/swagger-ui-config.json
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /swagger/swagger-initializer.js
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; GET /swagger/swagger-ui-standalone-preset.js
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_mixnodes_detailed) GET /v1/status/mixnodes/detailed
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_mixnode_inclusion_probabilities) GET /v1/status/mixnodes/inclusion_probability
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_mixnode_status) GET /v1/status/mixnode/&lt;mix_id&gt;/status
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_active_set_detailed) GET /v1/status/mixnodes/active/detailed
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_rewarded_set_detailed) GET /v1/status/mixnodes/rewarded/detailed
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_mixnode_stake_saturation) GET /v1/status/mixnode/&lt;mix_id&gt;/stake-saturation
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (get_mixnode_inclusion_probability) GET /v1/status/mixnode/&lt;mix_id&gt;/inclusion-probability
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (network_details) GET /v1/network/details
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (nym_contracts) GET /v1/network/nym-contracts
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; (nym_contracts_detailed) GET /v1/network/nym-contracts-detailed
 2023-12-12T14:29:55.800Z INFO  rocket::launch    &gt; 📡 Fairings:
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; Validator Cache Stage (ignite)
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; Circulating Supply Cache Stage (ignite)
 2023-12-12T14:29:55.800Z INFO  rocket::launch::_ &gt; Shield (liftoff, response, singleton)
 2023-12-12T14:29:55.801Z INFO  rocket::launch::_ &gt; CORS (ignite, request, response)
 2023-12-12T14:29:55.801Z INFO  rocket::launch::_ &gt; Node Status Cache (ignite)
 2023-12-12T14:29:55.801Z INFO  rocket::shield::shield &gt; 🛡️ Shield:
 2023-12-12T14:29:55.801Z INFO  rocket::shield::shield::_ &gt; X-Content-Type-Options: nosniff
 2023-12-12T14:29:55.801Z INFO  rocket::shield::shield::_ &gt; X-Frame-Options: SAMEORIGIN
 2023-12-12T14:29:55.801Z INFO  rocket::shield::shield::_ &gt; Permissions-Policy: interest-cohort=()
 2023-12-12T14:29:55.801Z WARN  rocket::launch            &gt; 🚀 Rocket has launched from http://127.0.0.1:8000
 2023-12-12T14:29:56.375Z INFO  nym_api::nym_contract_cache::cache::refresher &gt; Updating validator cache. There are 888 mixnodes and 105 gateways
 2023-12-12T14:29:56.375Z INFO  nym_api::node_status_api::cache::refresher    &gt; Updating node status cache
 2023-12-12T14:29:57.359Z INFO  nym_api::circulating_supply_api::cache        &gt; Updating circulating supply cache
 2023-12-12T14:29:57.359Z INFO  nym_api::circulating_supply_api::cache        &gt; the mixmining reserve is now 220198535489690unym
 2023-12-12T14:29:57.359Z INFO  nym_api::circulating_supply_api::cache        &gt; the number of tokens still vesting is now 145054386857730unym
 2023-12-12T14:29:57.359Z INFO  nym_api::circulating_supply_api::cache        &gt; the circulating supply is now 634747077652580unym
 2023-12-12T14:30:00.803Z INFO  nym_api::support::caching::refresher          &gt; node-self-described-data-refresher: refreshing cache state
 2023-12-12T14:31:56.290Z INFO  nym_api::nym_contract_cache::cache::refresher &gt; Updating validator cache. There are 888 mixnodes and 105 gateways
 2023-12-12T14:31:56.291Z INFO  nym_api::node_status_api::cache::refresher    &gt; Updating node status cache
</code></pre>
</div>
</details>
<h2 id="automation"><a class="header" href="#automation">Automation</a></h2>
<p>You will most likely want to automate your validator restarting if your server reboots. Checkout the <a href="nodes/./maintenance.html">maintenance page</a> for an example <code>service</code> file.</p>
<p>You can also use <code>nymvisor</code> to automatically update the <code>nym-api</code> node. The steps to install Nymvisor can be found <a href="nodes/nymvisor-upgrade.html">here</a>.</p>
<h2 id="exposing-web-endpoint-using-https"><a class="header" href="#exposing-web-endpoint-using-https">Exposing web endpoint using HTTPS</a></h2>
<p>It is recommended to expose the webserver over HTTPS by using a webserver like Nginx. An example configuration for configuring Nginx is listed <a href="nodes/maintenance.html#nym-api-configuration">on the maintenance page</a>. If you’re using a custom solution, ensure to allow requests from anywhere by setting a permissive CORS policy.</p>
<p>For example, it is configured in Nginx using: <code>add_header 'Access-Control-Allow-Origin' '*';</code></p>
<footer id="last-change">Last change: 2024-04-09, commit: <a href="https://github.com/nymtech/nym/commit/30ffea19a">30ffea19a</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nyx-validator--nym-api-configuration"><a class="header" href="#nyx-validator--nym-api-configuration">Nyx Validator &amp; Nym API Configuration</a></h1>
<h2 id="automation-1"><a class="header" href="#automation-1">Automation</a></h2>
<h3 id="validator-systemd-automation"><a class="header" href="#validator-systemd-automation">Validator <code>systemd</code> Automation</a></h3>
<p>To automate with <code>systemd</code> use this init service file by saving it as <code>/etc/systemd/system/nymd.service</code> and follow the steps bellow..</p>
<ol>
<li>Open text editor</li>
</ol>
<pre><code class="language-sh">nano /etc/systemd/system/nymd.service
</code></pre>
<ol start="2">
<li>Paste this file</li>
</ol>
<pre><code class="language-ini">[Unit]
Description=Nyxd
StartLimitInterval=350
StartLimitBurst=10

[Service]
User=&lt;USER&gt;                                                       # change to your user
Type=simple
Environment="LD_LIBRARY_PATH=/home/&lt;USER&gt;/&lt;PATH_TO_NYX_BINARIES&gt;" # change to correct path
ExecStart=/home/&lt;USER&gt;/&lt;PATH_TO_NYX_BINARIES&gt;/nymd start          # change to correct path
Restart=on-failure
RestartSec=30
LimitNOFILE=infinity

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Proceed to start it with:</p>
<pre><code class="language-sh">systemctl daemon-reload # to pickup the new unit file
systemctl enable nymd   # to enable the service
systemctl start nymd    # to actually start the service
journalctl -f -u nymd # to monitor system logs showing the service start
</code></pre>
<p><strong>Note:</strong> if you make any changes to your <code>systemd</code> script after you’ve enabled it, you will need to run:</p>
<pre><code class="language-sh">systemctl daemon-reload
</code></pre>
<p>This lets your operating system know it’s ok to reload the service configuration. Then restart your <code>&lt;NODE&gt;</code>.</p>
<h3 id="nym-api-systemd-automation"><a class="header" href="#nym-api-systemd-automation">Nym API <code>systemd</code> Automation</a></h3>
<p>To automate with <code>systemd</code> use this init service file by saving it as <code>/etc/systemd/system/nym-api.service</code> and follow the steps bellow..</p>
<ol>
<li>Open text editor</li>
</ol>
<pre><code class="language-sh">nano /etc/systemd/system/nym-api.service
</code></pre>
<ol start="2">
<li>Paste this file</li>
</ol>
<pre><code class="language-ini">[Unit]
Description=NymAPI
StartLimitInterval=350
StartLimitBurst=10

[Service]
User=&lt;USER&gt;                                                       # change to your user
Type=simple
ExecStart=/home/&lt;USER&gt;/&lt;PATH_TO_BINARY&gt;/nym-api start             # change to correct path
Restart=on-failure
RestartSec=30
LimitNOFILE=infinity

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Proceed to start it with:</p>
<pre><code class="language-sh">systemctl daemon-reload  # to pickup the new unit file
systemctl enable nym-api # to enable the service
systemctl start nym-api  # to actually start the service
journalctl -f -u nym-api # to monitor system logs showing the service start
</code></pre>
<p><strong>Note:</strong> if you make any changes to your <code>systemd</code> script after you’ve enabled it, you will need to run:</p>
<pre><code class="language-sh">systemctl daemon-reload
</code></pre>
<p>This lets your operating system know it’s ok to reload the service configuration. Then restart your <code>&lt;NODE&gt;</code>.</p>
<h2 id="nym-api-previously-validator-api-endpoints"><a class="header" href="#nym-api-previously-validator-api-endpoints">Nym API (previously ‘Validator API’) endpoints</a></h2>
<p>Numerous API endpoints are documented on the Nym API (previously ‘Validator API’)’s <a href="https://validator.nymtech.net/api/swagger/index.html">Swagger Documentation</a>. There you can also try out various requests from your browser, and download the response from the API. Swagger will also show you what commands it is running, so that you can run these from an app or from your CLI if you prefer.</p>
<pre><code class="language-sh">sudo ufw allow 'Nginx Full'
</code></pre>
<p>Check nginx is running via systemctl:</p>
<pre><code class="language-sh">systemctl status nginx
</code></pre>
<p>Which should return:</p>
<pre><code class="language-sh">● nginx.service - A high performance web server and a reverse proxy server
   Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled)
   Active: active (running) since Fri 2018-04-20 16:08:19 UTC; 3 days ago
     Docs: man:nginx(8)
 Main PID: 2369 (nginx)
    Tasks: 2 (limit: 1153)
   CGroup: /system.slice/nginx.service
           ├─2369 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;
           └─2380 nginx: worker process
</code></pre>
<h2 id="full-node-configuration-1"><a class="header" href="#full-node-configuration-1">Full Node Configuration</a></h2>
<p>Proxying various full node services through port 80 can then be done by creating a file with the following at <code>/etc/nginx/sites-enabled/nyxd-webrequests.conf</code>:</p>
<p>Setting up a reverse proxy using a webserver such as Nginx allows you to easily configure SSL certificates for the endpoints. When running on mainnet, it is recommended to encrypt all web traffic to your node.</p>
<pre><code class="language-sh">### To expose RPC server
server {
  listen 80;
  listen [::]:80;
  server_name "&lt;rpc.nyx.yourdomain.tld&gt;";

  location / {
    proxy_pass http://127.0.0.1:26657;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }

  location /websocket {
      proxy_pass http://127.0.0.1:26657;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection "Upgrade";
      proxy_set_header Host $host;
    }
}

### To expose Cosmos API server
server {
  server_name "&lt;api.nyx.yourdomain.tld&gt;";
  location / {
    proxy_pass http://127.0.0.1:1317;
    proxy_set_header X-Forwarded-For $remote_addr;
    proxy_set_header Host $http_host;
    proxy_set_header Upgrade websocket;
    proxy_set_header Connection Upgrade;
  }
}

### To expose GRPC endpoint
server {
  server_name "&lt;grpc.nyx.yourdomain.tld&gt;";
  location / {
    grpc_pass 127.0.0.1:9090;
  }
}
</code></pre>
<h2 id="nym-api-configuration"><a class="header" href="#nym-api-configuration">nym-api Configuration</a></h2>
<pre><code class="language-sh">### To expose nym-api webserver
server {
  listen 80;
  listen [::]:80;
  server_name "&lt;nym-api.nyx.yourdomain.tld&gt;";
  add_header 'Access-Control-Allow-Origin' '*';

  location / {
    proxy_pass http://127.0.0.1:8000;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }
}
</code></pre>
<p>Followed by:</p>
<pre><code class="language-sh">sudo apt install certbot nginx python3
certbot --nginx -m &lt;you@yourdomain.com&gt; --agree-tos
</code></pre>
<div id="admonition-default" class="admonition admonish-warning" role="note">
<div>
<p>If using a VPS running Ubuntu 20: replace <code>certbot nginx python3</code> with <code>python3-certbot-nginx</code></p>
</div>
</div>
<p>These commands will get you an https encrypted nginx proxy in front of the various endpoints.</p>
<h2 id="configuring-prometheus-metrics-optional"><a class="header" href="#configuring-prometheus-metrics-optional">Configuring Prometheus metrics (optional)</a></h2>
<p>Configure Prometheus with the following commands (adapted from NodesGuru’s <a href="https://nodes.guru/agoric/setup-guide/en">Agoric setup guide</a>):</p>
<pre><code class="language-sh">echo 'export OTEL_EXPORTER_PROMETHEUS_PORT=9464' &gt;&gt; $HOME/.bashrc
source ~/.bashrc
sed -i '/\[telemetry\]/{:a;n;/enabled/s/false/true/;Ta}' $HOME/.nymd/config/app.toml
sed -i "s/prometheus-retention-time = 0/prometheus-retention-time = 60/g" $HOME/.nymd/config/app.toml
sudo ufw allow 9464
echo 'Metrics URL: http://'$(curl -s ifconfig.me)':26660/metrics'
</code></pre>
<p>Your validator’s metrics will be available to you at the returned ‘Metrics URL’.</p>
<details id="admonition-console-output" class="admonition admonish-example" role="note" aria-labelledby="admonition-console-output-title">
<summary class="admonition-title">
<div id="admonition-console-output-title">
<p>Console output</p>
</div>
<a class="admonition-anchor-link" href="nodes/nyx-configuration.html#admonition-console-output"></a>
</summary>
<div>
<pre><code># HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.
# TYPE go_gc_duration_seconds summary
go_gc_duration_seconds{quantile="0"} 6.7969e-05
go_gc_duration_seconds{quantile="0.25"} 7.864e-05
go_gc_duration_seconds{quantile="0.5"} 8.4591e-05
go_gc_duration_seconds{quantile="0.75"} 0.000115919
go_gc_duration_seconds{quantile="1"} 0.001137591
go_gc_duration_seconds_sum 0.356555301
go_gc_duration_seconds_count 2448
# HELP go_goroutines Number of goroutines that currently exist.
# TYPE go_goroutines gauge
go_goroutines 668
# HELP go_info Information about the Go environment.
# TYPE go_info gauge
go_info{version="go1.15.7"} 1
# HELP go_memstats_alloc_bytes Number of bytes allocated and still in use.
# TYPE go_memstats_alloc_bytes gauge
go_memstats_alloc_bytes 1.62622216e+08
# HELP go_memstats_alloc_bytes_total Total number of bytes allocated, even if freed.
# TYPE go_memstats_alloc_bytes_total counter
go_memstats_alloc_bytes_total 2.09341707264e+11
# HELP go_memstats_buck_hash_sys_bytes Number of bytes used by the profiling bucket hash table.
# TYPE go_memstats_buck_hash_sys_bytes gauge
go_memstats_buck_hash_sys_bytes 5.612319e+06
# HELP go_memstats_frees_total Total number of frees.
# TYPE go_memstats_frees_total counter
go_memstats_frees_total 2.828263344e+09
# HELP go_memstats_gc_cpu_fraction The fraction of this program's available CPU time used by the GC since the program started.
# TYPE go_memstats_gc_cpu_fraction gauge
go_memstats_gc_cpu_fraction 0.03357798610671518
# HELP go_memstats_gc_sys_bytes Number of bytes used for garbage collection system metadata.
# TYPE go_memstats_gc_sys_bytes gauge
go_memstats_gc_sys_bytes 1.3884192e+07
</code></pre>
</div>
</details>
<h2 id="validator-port-reference-1"><a class="header" href="#validator-port-reference-1">Validator port reference</a></h2>
<p>All validator-specific port configuration can be found in <code>$HOME/.nymd/config/config.toml</code>. If you do edit any port configs, remember to restart your validator.</p>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td>1317</td><td>REST API server endpoint</td></tr>
<tr><td>26656</td><td>Listen for incoming peer connections</td></tr>
<tr><td>26660</td><td>Listen for Prometheus connections</td></tr>
</tbody></table>
</div><footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="maintenance"><a class="header" href="#maintenance">Maintenance</a></h1>
<h2 id="useful-commands"><a class="header" href="#useful-commands">Useful commands</a></h2>
<blockquote>
<p>Adding <code>--no-banner</code> startup flag will prevent Nym banner being printed even if run in tty environment.</p>
</blockquote>
<p><strong>build-info</strong></p>
<p>A <code>build-info</code> command prints the build information like commit hash, rust version, binary version just like what command <code>--version</code> does. However, you can also specify an <code>--output=json</code> flag that will format the whole output as a json, making it an order of magnitude easier to parse.</p>
<p>For example <code>./target/debug/nym-network-requester --no-banner build-info --output json</code> will return:</p>
<pre><code class="language-sh">{"binary_name":"nym-network-requester","build_timestamp":"2023-07-24T15:38:37.00657Z","build_version":"1.1.23","commit_sha":"c70149400206dce24cf20babb1e64f22202672dd","commit_timestamp":"2023-07-24T14:45:45Z","commit_branch":"feature/simplify-cli-parsing","rustc_version":"1.71.0","rustc_channel":"stable","cargo_profile":"debug"}
</code></pre>
<h2 id="configure-your-firewall-1"><a class="header" href="#configure-your-firewall-1">Configure your firewall</a></h2>
<p>Although your <code>&lt;NODE&gt;</code> is now ready to receive traffic, your server may not be. The following commands will allow you to set up a firewall using <code>ufw</code>.</p>
<pre><code class="language-sh"># check if you have ufw installed
ufw version

# if it is not installed, install with
sudo apt install ufw -y

# enable ufw
sudo ufw enable

# check the status of the firewall
sudo ufw status
</code></pre>
<p>Finally open your <code>&lt;NODE&gt;</code> p2p port, as well as ports for ssh and ports for verloc and measurement pings:</p>
<pre><code class="language-sh"># for nym-node
sudo ufw allow 1789,1790,8000,9000,9001,22/tcp

# in case of setting up WSS on Gateway add:
sudo ufw allow 9001/tcp

# In case of reverse proxy for the Gateway swagger page add:
sudo ufw allow 8080,80/443

# for validator
sudo ufw allow 1317,26656,26660,22,80,443/tcp
</code></pre>
<p>Check the status of the firewall:</p>
<pre><code class="language-sh">sudo ufw status
</code></pre>
<p>For more information about your node’s port configuration, check the <a href="nodes/./maintenance.html#gateway-port-reference">port reference table</a> below.</p>
<h2 id="vps-setup-and-automation-1"><a class="header" href="#vps-setup-and-automation-1">VPS Setup and Automation</a></h2>
<blockquote>
<p>Replace <code>&lt;NODE&gt;</code> variable with type of node you run, preferably <code>nym-node</code> (depreciated <code>nym-mixnode</code>, <code>nym-gateway</code> or <code>nym-network-requester</code>).</p>
</blockquote>
<h3 id="automating-your-node-with-nohup-tmux-and-systemd-1"><a class="header" href="#automating-your-node-with-nohup-tmux-and-systemd-1">Automating your node with nohup, tmux and systemd</a></h3>
<p>Although it’s not totally necessary, it’s useful to have the Mix Node automatically start at system boot time. We recommend to run your remote operation via <a href="nodes/maintenance.html#tmux"><code>tmux</code></a> for easier management and a handy return to your previous session. For full automation, including a failed node auto-restart and <code>ulimit</code> setup, <a href="nodes/maintenance.html#systemd"><code>systemd</code></a> is a good choice.</p>
<blockquote>
<p>Do any of these steps and run your automated node before you start bonding process!</p>
</blockquote>
<h4 id="nohup-1"><a class="header" href="#nohup-1">nohup</a></h4>
<p><code>nohup</code> is a command with which your terminal is told to ignore the <code>HUP</code> or ‘hangup’ signal. This will stop the node process ending if you kill your session.</p>
<pre><code class="language-sh">nohup ./&lt;NODE&gt; run &lt;OTHER_FLAGS&gt; # use all the flags you use to run your node
</code></pre>
<h4 id="tmux-1"><a class="header" href="#tmux-1">tmux</a></h4>
<p>One way is to use <code>tmux</code> shell on top of your current VPS terminal. Tmux is a terminal multiplexer, it allows you to create several terminal windows and panes from a single terminal. Processes started in <code>tmux</code> keep running after closing the terminal as long as the given <code>tmux</code> window was not terminated.</p>
<p>Use the following command to get <code>tmux</code>.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Platform</th><th style="text-align: left">Install Command</th></tr></thead><tbody>
<tr><td style="text-align: left">Arch Linux</td><td style="text-align: left"><code>pacman -S tmux</code></td></tr>
<tr><td style="text-align: left">Debian or Ubuntu</td><td style="text-align: left"><code>apt install tmux</code></td></tr>
<tr><td style="text-align: left">Fedora</td><td style="text-align: left"><code>dnf install tmux</code></td></tr>
<tr><td style="text-align: left">RHEL or CentOS</td><td style="text-align: left"><code>yum install tmux</code></td></tr>
<tr><td style="text-align: left">macOS (using Homebrew</td><td style="text-align: left"><code>brew install tmux</code></td></tr>
<tr><td style="text-align: left">macOS (using MacPorts)</td><td style="text-align: left"><code>port install tmux</code></td></tr>
<tr><td style="text-align: left">openSUSE</td><td style="text-align: left"><code>zypper install tmux</code></td></tr>
</tbody></table>
</div>
<p>In case it didn’t work for your distribution, see how to build <code>tmux</code> from <a href="https://github.com/tmux/tmux#from-version-control">version control</a>.</p>
<p><strong>Running tmux</strong></p>
<p>Now you have installed tmux on your VPS, let’s run a Mix Node on tmux, which allows you to detach your terminal and let your <code>&lt;NODE&gt;</code> run on its own on the VPS.</p>
<ul>
<li>Pause your <code>&lt;NODE&gt;</code></li>
<li>Start tmux with the command</li>
</ul>
<pre><code class="language-sh">tmux
</code></pre>
<ul>
<li>The tmux terminal should open in the same working directory, just the layout changed into tmux default layout.</li>
<li>Start the <code>&lt;NODE&gt;</code> again with a command:</li>
</ul>
<pre><code class="language-sh">./&lt;NODE&gt; run &lt;OTHER_FLAGS&gt; # use all the flags you use to run your node
</code></pre>
<ul>
<li>Now, without closing the tmux window, you can close the whole terminal and the <code>&lt;NODE&gt;</code> (and any other process running in tmux) will stay active.</li>
<li>Next time just start your teminal, ssh into the VPS and run the following command to attach back to your previous session:</li>
</ul>
<pre><code class="language-sh">tmux attach-session
</code></pre>
<ul>
<li>To see keybinding options of tmux press <code>ctrl</code>+<code>b</code> and after 1 second <code>?</code></li>
</ul>
<h4 id="systemd-1"><a class="header" href="#systemd-1">systemd</a></h4>
<blockquote>
<p>Configuration of <code>systemd</code> service files for <code>nym-node</code> is under <a href="nodes/configuration.html#systemd">Nym Node - Configuration</a> page.</p>
</blockquote>
<h5 id="for-nymvisor"><a class="header" href="#for-nymvisor">For Nymvisor</a></h5>
<blockquote>
<p>Since you’re running your node via a Nymvisor instance, as well as creating a Nymvisor <code>.service</code> file, you will also want to <strong>stop any previous node automation process you already have running</strong>.</p>
</blockquote>
<p>To automate with <code>systemd</code> use this init service file by saving it as <code>/etc/systemd/system/nymvisor.service</code> and follow the <a href="nodes/maintenance.html#following-steps-for-nym-nodes-running-as-systemd-service">next steps</a>.</p>
<ol>
<li>Open text editor</li>
</ol>
<pre><code class="language-sh">nano /etc/systemd/system/nymvisor.service
</code></pre>
<ol start="2">
<li>Paste this file</li>
</ol>
<pre><code>[Unit]
Description=Nymvisor &lt;VERSION&gt;
StartLimitInterval=350
StartLimitBurst=10

[Service]
User=&lt;USER&gt; # replace this with whatever user you wish
LimitNOFILE=65536
ExecStart=/home/&lt;USER&gt;/&lt;PATH&gt;/nymvisor run --id &lt;ID&gt;
KillSignal=SIGINT
Restart=on-failure
RestartSec=30

[Install]
WantedBy=multi-user.target
</code></pre>
<ol start="3">
<li>Save the file</li>
</ol>
<div id="admonition-note" class="admonition admonish-note" role="note" aria-labelledby="admonition-note-title">
<div class="admonition-title">
<div id="admonition-note-title">
<p>Note</p>
</div>
<a class="admonition-anchor-link" href="nodes/maintenance.html#admonition-note"></a>
</div>
<div>
<p>Make sure your <code>ExecStart &lt;FULL_PATH&gt;</code> and <code>run</code> command are correct!</p>
<p>Example: If you have built nym in the <code>$HOME</code> directory on your server, your username is <code>jetpanther</code>, and node <code>&lt;ID&gt;</code> is <code>puma</code>, then the <code>ExecStart</code> line (command) in the script located in <code>/etc/systemd/system/nym-mixnode.service</code> for Nym Mixnode might look like this:
<code>ExecStart=/home/jetpanther/nym/target/release/nym-node run --id puma</code>.</p>
<p>Basically, you want the full <code>/&lt;PATH&gt;/&lt;TO&gt;/nym-mixnode run --id &lt;WHATEVER-YOUR-NODE-ID-IS&gt;</code>. If you are unsure about your <code>/&lt;PATH&gt;/&lt;TO&gt;/&lt;NODE&gt;</code>, then <code>cd</code> to your directory where you run your <code>&lt;NODE&gt;</code> from and run <code>pwd</code> command which returns the full path for you.</p>
</div>
</div>
<h4 id="following-steps-for-nym-nodes-running-as-systemd-service-1"><a class="header" href="#following-steps-for-nym-nodes-running-as-systemd-service-1">Following steps for Nym nodes running as <code>systemd</code> service</a></h4>
<p>Once your init file is save follow these steps:</p>
<ol>
<li>Reload systemctl to pickup the new unit file</li>
</ol>
<pre><code class="language-sh">systemctl daemon-reload
</code></pre>
<ol start="2">
<li>Enable the newly created service:</li>
</ol>
<pre><code class="language-sh">systemctl enable nym-node.service
</code></pre>
<ol start="3">
<li>Start your <code>&lt;NODE&gt;</code> as a <code>systemd</code> service:</li>
</ol>
<pre><code class="language-sh">service nym-node start
</code></pre>
<p>This will cause your <code>&lt;NODE&gt;</code> to start at system boot time. If you restart your machine, your <code>&lt;NODE&gt;</code> will come back up automatically.</p>
<p><strong>Useful systemd commands</strong></p>
<ul>
<li>You can monitor system logs of your node by running:</li>
</ul>
<pre><code class="language-sh">journalctl -u &lt;NODE&gt; -f
</code></pre>
<ul>
<li>Or check a status by running:</li>
</ul>
<pre><code class="language-sh">systemctl status &lt;NODE&gt;.service
# for example systemctl status nym-node.service
</code></pre>
<ul>
<li>You can also do <code>service &lt;NODE&gt; stop</code> or <code>service &lt;NODE&gt; restart</code>.</li>
</ul>
<p><strong>Note:</strong> if you make any changes to your <code>systemd</code> script after you’ve enabled it, you will need to run:</p>
<pre><code class="language-sh">systemctl daemon-reload
</code></pre>
<p>This lets your operating system know it’s OK to reload the service configuration. Then restart your <code>&lt;NODE&gt;</code>.</p>
<h2 id="backup-a-node"><a class="header" href="#backup-a-node">Backup a node</a></h2>
<p>Anything can happen to the server on which your node is running. To back up your <code>nym-node</code> keys and configuration protects the operators against the negative impact of unexpected events. To restart your node on another server, two essential pieces are needed:</p>
<ol>
<li>Node keys to initialise the same node on a new VPS</li>
<li>Access to the bonding Nym account (wallet seeds) to edit the IP on smart contract</li>
</ol>
<p>Assuming that everyone access their wallets from local machine and does <em>not</em> store their seeds on VPS, point #2 should be a given. To backup your <code>nym-node</code> keys and configuration in the easiest way possible, copy the entire config directory <code>.nym</code> from your VPS to your local desktop, using a special copy command <code>scp</code>:</p>
<ol>
<li>Create a directory where you want to store your backup</li>
</ol>
<pre><code class="language-sh">mkdir -pv &lt;PATH_TO_TARGET_DIRECTORY&gt;
</code></pre>
<ol start="2">
<li>Copy configuration folder <code>.nym</code> from your VPS to your newly created backup directory:</li>
</ol>
<pre><code class="language-sh">scp -r &lt;SOURCE_USER_NAME&gt;@&lt;SOURCE_HOST_ADDRESS&gt;:~/.nym/nym-nodes/&lt;YOUR_NODE_ID&gt; &lt;PATH_TO_TARGET_DIRECTORY&gt;
</code></pre>
<ol start="3">
<li>The <code>scp</code> command should print logs, an operator can see directly whether it was successful or if it encountered any error. However, double check that all your needed configuration is in the backup directory.</li>
</ol>
<h2 id="restoring-a-node"><a class="header" href="#restoring-a-node">Restoring a node</a></h2>
<p>In case your VPS shut down and you have a <a href="nodes/maintenance.html#backup-a-node">backup</a> of your node keys and access to your bonding wallet, you can easily restore your node on another server without losing your delegation.</p>
<ol>
<li>
<p>On VPS: Do all <a href="nodes/preliminary-steps.html">preliminary steps</a> needed to run a <code>nym-node</code>.</p>
</li>
<li>
<p>On VPS: Create a <code>.nym/nym-nodes</code> configuration folder:</p>
</li>
</ol>
<pre><code class="language-sh">mkdir -pv ~/.nym/nym-nodes
</code></pre>
<ol start="3">
<li>From machine where your node is backed up (usually local desktop): Copy the folder with your node keys and configuration to the newly created folder on your VPS using <code>scp</code> command. Make sure to grab the entire <code>nym-node</code> configuration folder, which is called after your local <code>nym-node</code> ID, the <code>-r</code> flag will take care of all sub-directories and their content:</li>
</ol>
<pre><code class="language-sh">scp -r &lt;LOCAL_NODE_CONFIGURATION_FOLDER&gt; &lt;VPS_USER_NAME&gt;@&lt;VPS_HOST_ADDRESS&gt;:~/.nym/nym-nodes/
</code></pre>
<ol start="4">
<li>
<p>The <code>scp</code> command should print logs, an operator can see directly whether it was successful or if it encountered any error. However, double check that all your needed configuration is in the target directory <code>.nym/nym-nodes</code> on your VPS.</p>
</li>
<li>
<p>Configure your node on the new VPS:</p>
</li>
</ol>
<ul>
<li>Edit <code>~/.nym/nym-nodes/&lt;ID&gt;/config/config.toml</code> config with the new listening address IP - it’s the one under the header <code>[host]</code>, called <code>public_ips = ['&lt;YOUR_PUBLIC_IP&gt;',]</code> and add your new location (field <code>location = &lt;LOCATION&gt;</code>, formats like: ‘Jamaica’, or two-letter alpha2 (e.g. ‘JM’), three-letter alpha3 (e.g. ‘JAM’) or three-digit numeric-3 (e.g. ‘388’) can be provided). You can see your IP by running a command <code>echo "$(curl -4 https://ifconfig.me)"</code>.</li>
<li>Try to run the node and see if everything works.</li>
<li>Setup the <a href="nodes/maintenance.html#systemd">systemd</a> automation (don’t forget to add the <a href="nodes/setup.html#terms--conditions">terms and conditions flag</a>) to <code>ExecStart</code> command, reload the daemon and run the service.</li>
</ul>
<ol start="6">
<li>And finally change the node smart contract info via the wallet interface. Open Nym Wallet, go to <em>Bonding</em>, open <em>Gateway Settings</em> or <em>Mixnode Settings</em> and change <em>Host</em> value to the new <code>nym-node</code> IP address. Otherwise the keys will point to the old IP address in the smart contract, and the node will not be able to be connected, and it will fail up-time checks, returning zero performance.</li>
</ol>
<h2 id="moving-a-node"><a class="header" href="#moving-a-node">Moving a node</a></h2>
<p>In case of a need to move a Nym Node from one machine to another and avoiding to lose the delegation, here are few steps how to do it.</p>
<p>Assuming both machines are remote VPS.</p>
<ul>
<li>Make sure your <code>~/.ssh/&lt;YOUR_KEY&gt;.pub</code> is in both of the servers <code>~/.ssh/authorized_keys</code> file</li>
<li>Create a <code>nym-nodes</code> folder in the target VPS. SSH in from your terminal and run:</li>
</ul>
<pre><code class="language-sh"># in case none of the nym configs was created previously
mkdir ~/.nym

#in case no nym Nym Node was initialized previously
mkdir ~/.nym/nym-nodes
</code></pre>
<ul>
<li>Move the node data (keys) and config file to the new machine by opening your <strong>local terminal</strong> (as that one’s ssh key is authorized in both of the VPS) and running:</li>
</ul>
<pre><code class="language-sh">scp -r -3 &lt;SOURCE_USER_NAME&gt;@&lt;SOURCE_HOST_ADDRESS&gt;:~/.nym/nym-nodes &lt;TARGET_USER_NAME&gt;@&lt;TARGET_HOST_ADDRESS&gt;:~/.nym/nym-nodes/
</code></pre>
<p><strong>On new/target VPS</strong></p>
<ul>
<li>Edit <code>~/.nym/nym-nodes/&lt;ID&gt;/config/config.toml</code> config with the new listening address IP - it’s the one under the header <code>[host]</code>, called <code>public_ips = ['&lt;YOUR_PUBLIC_IP&gt;',]</code> and add your new location (field <code>location = &lt;LOCATION&gt;</code>, formats like: ‘Jamaica’, or two-letter alpha2 (e.g. ‘JM’), three-letter alpha3 (e.g. ‘JAM’) or three-digit numeric-3 (e.g. ‘388’) can be provided). You can see your IP by running a command <code>echo "$(curl -4 https://ifconfig.me)"</code>.</li>
<li>Try to run the node and see if everything works.</li>
<li>Setup the <a href="nodes/maintenance.html#systemd">systemd</a> automation. If you want to use the exact same service config file, you can also copy it from one VPS to another following the same logic by opening your <strong>local terminal</strong> (as that one’s ssh key is authorized in both of the VPS) and running:</li>
</ul>
<pre><code class="language-sh">scp -r -3 &lt;SOURCE_USER_NAME&gt;@&lt;SOURCE_HOST_ADDRESS&gt;:/etc/systemd/system/nym-node.service &lt;TARGET_USER_NAME&gt;@&lt;TARGET_HOST_ADDRESS&gt;:/etc/systemd/system/nym-node.service
</code></pre>
<p>Note: <a href="nodes/setup.html#terms--conditions">Accepting T&amp;Cs</a> is done via a flag <code>--accept-operator-terms-and-conditions</code> added explicitly to <code>nym-node run</code> command every time. If you use <a href="nodes/configuration.html#systemd">systemd</a> automation, add the flag to your service file’s <code>ExecStart</code> line.</p>
<p><strong>In your desktop wallet</strong></p>
<ul>
<li>Change the node smart contract info via the wallet interface. Open Nym Wallet, go to <em>Bonding</em>, open <em>Gateway Settings</em> or <em>Mixnode Settings</em> and change <em>Host</em> value to the new <code>nym-node</code> IP address. Otherwise the keys will point to the old IP address in the smart contract, and the node will not be able to be connected, and it will fail up-time checks, returning zero performance.</li>
</ul>
<p>Make sure to stop the old node.</p>
<h2 id="rename-node-local-id"><a class="header" href="#rename-node-local-id">Rename node local ID</a></h2>
<p>Local node ID (not the identity key) is a name chosen by operators which defines where the nodes configuration data will be stored, where the ID determines the path to <code>~/.nym/nym-nodes/&lt;ID&gt;/</code>. This ID is never shared on the network.</p>
<p>Since migrating to <a href="nodes/nym-node.html"><code>nym-node</code></a>, specifying an with <code>--ID &lt;ID&gt;</code> when starting a new node is no longer necessary. Nodes without a specified ID will be asigned the default ID <code>default-nym-node</code>. This streamlines node management, particularly for operators handling multiple nodes via ansible and other automation scripts, as all data is stored at <code>~/.nym/nym-nodes/default-nym-node</code>.</p>
<p>If you already operate a <code>nym-node</code> and wish to change the local ID to <code>default-nym-node</code> or anything else, follow the steps below to do so.</p>
<div id="admonition-note-1" class="admonition admonish-note" role="note" aria-labelledby="admonition-note-1-title">
<div class="admonition-title">
<div id="admonition-note-1-title">
<p>Note</p>
</div>
<a class="admonition-anchor-link" href="nodes/maintenance.html#admonition-note-1"></a>
</div>
<div>
<p>In the example we use <code>default-nym-node</code> as a target <code>&lt;ID&gt;</code>, if you prefer to use another name, edit the syntax in the commands accordingly.</p>
</div>
</div>
<ol>
<li>Copy the configuration directory to the new one</li>
</ol>
<pre><code class="language-sh">cp -r  ~/.nym/nym-nodes/&lt;SOURCE_ID&gt; ~/.nym/nym-nodes/default-nym-node/
</code></pre>
<ol start="2">
<li>Rename all <code>&lt;SOURCE_ID&gt;</code> occurences in <code>config.toml</code> to <code>default-nym-node</code></li>
</ol>
<pre><code class="language-sh"># check occurences of the &lt;SOURCE_ID&gt;
grep -r  "&lt;SOURCE_ID&gt;" ~/.nym/nym-nodes/default-nym-node/*
</code></pre>
<div id="admonition-caution" class="admonition admonish-bug" role="note" aria-labelledby="admonition-caution-title">
<div class="admonition-title">
<div id="admonition-caution-title">
<p>Caution!</p>
</div>
<a class="admonition-anchor-link" href="nodes/maintenance.html#admonition-caution"></a>
</div>
<div>
<p>If your node <code>&lt;SOURCE_ID&gt;</code> is too generic (like <code>gateway</code> etc) and it occurs elsewhere than just a custom value, <strong>do not use <code>sed</code> command but rewrite the values manually using a text editor!</strong></p>
</div>
</div>
<pre><code class="language-sh"># rename it by using sed command
sed -i -e "s/&lt;SOURCE_ID&gt;/default-nym-node/g" ~/.nym/nym-nodes/default-nym-node/config/config.toml

# or manually by opening config.toml and rewriting each occurence of &lt;SOURCE_ID&gt;
nano ~/.nym/nym-nodes/default-nym-node/config/config.toml
</code></pre>
<ol start="3">
<li>Validate by rechecking the config file content</li>
</ol>
<pre><code class="language-sh"># either re-run
grep -r  "&lt;SOURCE_ID&gt;" ~/.nym/nym-nodes/default-nym-node/*

# or by reading the config file
less ~/.nym/nym-nodes/default-nym-node/config/config.toml
</code></pre>
<ul>
<li>Pay extra attention to the <code>hostname</code> line. In case its value was somehow correlated with the <code>&lt;SOURCE_ID&gt;</code> string you may need to correct it back</li>
</ul>
<ol start="4">
<li>
<p>Reload your <a href="nodes/maintenance.html#systemd">systemd service daemon</a> and restart the service, or if automation isn’t your thing, simply reboot the node</p>
</li>
<li>
<p>If you double-checked that everything works fine, you can consider removing your old config directory</p>
</li>
</ol>
<h2 id="ports"><a class="header" href="#ports">Ports</a></h2>
<p>All <code>&lt;NODE&gt;</code>-specific port configuration can be found in <code>$HOME/.nym/&lt;NODE&gt;/&lt;YOUR_ID&gt;/config/config.toml</code>. If you do edit any port configs, remember to restart your client and node processes.</p>
<h3 id="nym-node-port-reference-1"><a class="header" href="#nym-node-port-reference-1">Nym Node Port Reference</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td><code>1789</code></td><td>Listen for Mixnet traffic</td></tr>
<tr><td><code>1790</code></td><td>Listen for VerLoc traffic</td></tr>
<tr><td><code>8080</code></td><td>Metrics http API endpoint</td></tr>
<tr><td><code>1789</code></td><td>Listen for Mixnet traffic</td></tr>
<tr><td><code>9000</code></td><td>Listen for Client traffic</td></tr>
<tr><td><code>9001</code></td><td>WSS</td></tr>
<tr><td><code>51822/udp</code></td><td>WireGuard</td></tr>
</tbody></table>
</div>
<h3 id="validator-port-reference-2"><a class="header" href="#validator-port-reference-2">Validator Port Reference</a></h3>
<p>All validator-specific port configuration can be found in <code>$HOME/.nymd/config/config.toml</code>. If you do edit any port configs, remember to restart your validator.</p>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td>1317</td><td>REST API server endpoint</td></tr>
<tr><td>26656</td><td>Listen for incoming peer connections</td></tr>
<tr><td>26660</td><td>Listen for Prometheus connections</td></tr>
</tbody></table>
</div><footer id="last-change">Last change: 2024-08-13, commit: <a href="https://github.com/nymtech/nym/commit/da8e51362">da8e51362</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="manual-node-upgrade"><a class="header" href="#manual-node-upgrade">Manual Node Upgrade</a></h1>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable. Exchange with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<p><strong>Upgrading your node is a straight forward two-step process:</strong></p>
<h4 id="1-updating-the-binary-and-nymnodeyour_idconfigconfigtoml-on-your-vps"><a class="header" href="#1-updating-the-binary-and-nymnodeyour_idconfigconfigtoml-on-your-vps">1. Updating the binary and <code>~/.nym/&lt;NODE&gt;/&lt;YOUR_ID&gt;/config/config.toml</code> on your VPS</a></h4>
<h4 id="2-updating-the-node-information-in-the-mixnet-smart-contract-this-is-the-information-that-is-present-on-the-mixnet-explorer"><a class="header" href="#2-updating-the-node-information-in-the-mixnet-smart-contract-this-is-the-information-that-is-present-on-the-mixnet-explorer">2. Updating the node information in the <a href="https://nymtech.net/docs/nyx/mixnet-contract.html">mixnet smart contract</a>. This is the information that is present on the <a href="https://explorer.nymtech.net">mixnet explorer</a>.</a></h4>
<h2 id="step-1-upgrading-your-binary"><a class="header" href="#step-1-upgrading-your-binary">Step 1: Upgrading your binary</a></h2>
<p>Follow these steps to upgrade your node binary and update its config file:</p>
<ol>
<li>Pause your node process.
<ul>
<li>if you see the terminal window with your node, press <code>ctrl + c</code></li>
<li>if you run it as <code>systemd</code> service, run: <code>service &lt;NODE&gt; stop</code></li>
</ul>
</li>
<li>Replace the existing <code>&lt;NODE&gt;</code> binary with the newest binary (which you can either <a href="nodes/../binaries/building-nym.html">compile yourself</a> or <a href="nodes/../binaries/pre-built-binaries.html">download</a>.</li>
<li><a href="nodes/setup.html#initialise--run">Re-run with the same values</a> as you used initially for your <code>&lt;NODE&gt;</code>. <strong>This will just update the config file, it will not overwrite existing keys</strong>.
<ul>
<li>if your node is <em>not automated</em>, just <code>run</code> your <code>&lt;NODE&gt;</code> with <code>./&lt;NODE&gt; run --id &lt;ID&gt;</code>.</li>
<li>if you <em>automated</em> your node with systemd (recommended) run:</li>
</ul>
</li>
</ol>
<pre><code class="language-sh">systemctl daemon-reload # to pickup the new unit file

service &lt;NODE&gt; start &amp;&amp; journalctl -f -u &lt;NODE&gt;.service # to monitor log of you node
</code></pre>
<p>If you prefer to automate the process, try to setup your flow with <a href="nodes/nymvisor-upgrade.html">Nymvisor</a>.</p>
<h2 id="step-2-updating-your-node-information-in-the-smart-contract"><a class="header" href="#step-2-updating-your-node-information-in-the-smart-contract">Step 2: Updating your node information in the smart contract</a></h2>
<p>Follow these steps to update the information about your <code>&lt;NODE&gt;</code> which is publicly available from the <a href="https://validator.nymtech.net/api/swagger/index.html"><code>nym-api</code></a> and information displayed on the <a href="https://explorer.nymtech.net">Mixnet explorer</a>.</p>
<p>You can either do this graphically via the Desktop Wallet, or the CLI.</p>
<h3 id="updating-node-information-via-the-desktop-wallet-recommended"><a class="header" href="#updating-node-information-via-the-desktop-wallet-recommended">Updating node information via the Desktop Wallet (recommended)</a></h3>
<ol>
<li>Navigate to the <code>Bonding</code> page and click the <code>Node Settings</code> link in the top right corner:</li>
</ol>
<p><img src="nodes/../images/wallet-screenshots/bonding.png" alt="Bonding page" /></p>
<ol start="2">
<li>Update the fields in the <code>Node Settings</code> page (usually the field <code>Version</code> is the only one to change) and click <code>Submit changes to the blockchain</code>.</li>
</ol>
<p><img src="nodes/../images/wallet-screenshots/node_settings.png" alt="Node Settings Page" /></p>
<h3 id="updating-node-information-via-the-cli"><a class="header" href="#updating-node-information-via-the-cli">Updating node information via the CLI</a></h3>
<p>If you want to bond your <code>&lt;NODE&gt;</code> via the CLI, then check out the <a href="https://nymtech.net/docs/tools/nym-cli.html#upgrade-a-mix-node">relevant section in the Nym CLI</a> docs.</p>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="nodes/manual-upgrade.html#admonition-info"></a>
</div>
<div>
<p>If you run a Gateway, visit <a href="https://harbourmaster.nymtech.net/">Nym Harbour Master</a> to get all the probe info about your node directly from API.</p>
</div>
</div>
<h2 id="upgrading-your-validator-1"><a class="header" href="#upgrading-your-validator-1">Upgrading your validator</a></h2>
<p>Upgrading from <code>v0.31.1</code> -&gt; <code>v0.32.0</code> process is fairly simple. Grab the <code>v0.32.0</code> release tarball from the <a href="https://github.com/nymtech/nyxd/releases"><code>nyxd</code> releases page</a>, and untar it. Inside are two files:</p>
<ul>
<li>the new validator (<code>nyxd</code>) v0.32.0</li>
<li>the new wasmvm (it depends on your platform, but most common filename is <code>libwasmvm.x86_64.so</code>)</li>
</ul>
<p>Wait for the upgrade height to be reached and the chain to halt awaiting upgrade, then:</p>
<ul>
<li>copy <code>libwasmvm.x86_64.so</code> to the default LD_LIBRARY_PATH on your system (on Ubuntu 20.04 this is <code>/lib/x86_64-linux-gnu/</code>) replacing your existing file with the same name.</li>
<li>swap in your new <code>nyxd</code> binary and restart.</li>
</ul>
<p>You can also use something like <a href="https://github.com/cosmos/cosmos-sdk/tree/main/tools/cosmovisor">Cosmovisor</a> - grab the relevant information from the current upgrade proposal <a href="https://nym.explorers.guru/proposal/9">here</a>.</p>
<p>Note: Cosmovisor will swap the <code>nyxd</code> binary, but you’ll need to already have the <code>libwasmvm.x86_64.so</code> in place.</p>
<h3 id="common-reasons-for-your-validator-being-jailed-1"><a class="header" href="#common-reasons-for-your-validator-being-jailed-1">Common reasons for your validator being jailed</a></h3>
<p>The most common reason for your validator being jailed is that your validator is out of memory because of bloated syslogs.</p>
<p>Running the command <code>df -H</code> will return the size of the various partitions of your VPS.</p>
<p>If the <code>/dev/sda</code> partition is almost full, try pruning some of the <code>.gz</code> syslog archives and restart your validator process.</p>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="automatic-node-upgrade-nymvisor-setup-and-usage"><a class="header" href="#automatic-node-upgrade-nymvisor-setup-and-usage">Automatic Node Upgrade: Nymvisor Setup and Usage</a></h1>
<blockquote>
<p>The Nymvisor binary was built in the <a href="nodes/../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code, go there first. You can build just Nymvisor with <code>cargo build --release --bin nymvisor</code>.</p>
</blockquote>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable. Exchange with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<h2 id="what-is-nymvisor"><a class="header" href="#what-is-nymvisor">What is Nymvisor?</a></h2>
<p>Nymvisor is a process manager for Nym binaries that monitors the Nym release information for any newly released binaries. If it detects any changes, Nymvisor can automatically download the binary, stop the current binary, switch from the old binary to the new one, and finally restart the underlying process with the new binary.</p>
<p>In essence, it tries to mirror the behaviour of <a href="https://github.com/cosmos/cosmos-sdk/tree/main/tools/cosmovisor">Cosmovisor</a>, a tool used by Cosmos blockchain operators for managing/automating chain upgrades. Nymvisor, however, introduces some Nym-specific changes since, for example, upgrade information is obtained from our GitHub <a href="https://github.com/nymtech/nym/releases">releases page</a> instead of (in the case of Cosmos blockchains) governance proposals.</p>
<p>You can use Nymvisor to automate the upgrades of the following binaries:</p>
<ul>
<li><code>nym-api</code></li>
<li><code>nym-node</code></li>
<li><code>nym-client</code></li>
<li><code>nym-socks5-client</code></li>
</ul>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="nodes/nymvisor-upgrade.html#admonition-warning"></a>
</div>
<div>
<p>Nymvisor is an early and experimental software. Users should use it at their own risk.</p>
</div>
</div>
<h2 id="current-version-2"><a class="header" href="#current-version-2">Current version</a></h2>
<pre><code>0.1.5
</code></pre>
<h2 id="preliminary-steps-1"><a class="header" href="#preliminary-steps-1">Preliminary steps</a></h2>
<p>You need to have at least one Nym Node / client / Nym API instance already set up on the <strong>same VPS</strong> that you wish to run Nymvisor on.</p>
<blockquote>
<p>Using Nymvisor presumes your VPS is running an operating system that is compatible with the pre-compiled binaries availiable on the <a href="https://github.com/nymtech/nym/releases">Github releases page</a>. If you’re not, then until we’re packaging for a greater variety of operating systems, you’re stuck with <a href="nodes/manual-upgrade.html">manually upgrading your node</a>.</p>
</blockquote>
<h2 id="setup-and-usage-1"><a class="header" href="#setup-and-usage-1">Setup and Usage</a></h2>
<h3 id="viewing-command-help-1"><a class="header" href="#viewing-command-help-1">Viewing command help</a></h3>
<p>You can check that your binaries are properly compiled with:</p>
<pre><code>./nymvisor --help
</code></pre>
<p>Which should return a list of all available commands.</p>
<details id="admonition-console-output" class="admonition admonish-example" role="note" aria-labelledby="admonition-console-output-title">
<summary class="admonition-title">
<div id="admonition-console-output-title">
<p>Console output</p>
</div>
<a class="admonition-anchor-link" href="nodes/nymvisor-upgrade.html#admonition-console-output"></a>
</summary>
<div>
<pre><code>Usage: nymvisor [OPTIONS] &lt;COMMAND&gt;

Commands:
  init               Initialise a nymvisor instance with persistent Config.toml file
  run                Run the associated daemon with the preconfigured settings
  build-info         Show build information of this binary
  daemon-build-info  Show build information of the associated daemon
  add-upgrade        Queues up another upgrade for the associated daemon
  config             Show configuration options being used by this instance of nymvisor
  help               Print this message or the help of the given subcommand(s)

Options:
  -c, --config-env-file &lt;CONFIG_ENV_FILE&gt;
          Path pointing to an env file that configures the nymvisor and overrides any preconfigured values
  -h, --help
          Print help
  -V, --version
          Print version
</code></pre>
</div>
</details>
<p>You can also check the various arguments required for individual commands with:</p>
<pre><code>./nymvisor &lt;COMMAND&gt; --help
</code></pre>
<h3 id="initialising-your-nymvisor-instance"><a class="header" href="#initialising-your-nymvisor-instance">Initialising your Nymvisor Instance</a></h3>
<blockquote>
<p>This example will use the Nym Node binary as an example - however replacing <code>nym-node</code> with any other supported binary will work the same.</p>
</blockquote>
<p>Initialise your Nymvisor instance with the following command. You must initialise Nymvisor with the binary you wish to add upgrades for:</p>
<pre><code>./nymvisor init --daemon-home ~/.nym/&lt;NODE_TYPE&gt;/&lt;NODE_ID&gt; &lt;PATH_TO_NODE_BINARY&gt;
</code></pre>
<p>Where the value of <code>--daemon-home</code> might be <code>~/.nym/nym-nodes/default-nym-node</code> and <code>&lt;PATH_TO_NODE_BINARY&gt;</code> might be <code>/home/my_user/nym/target/release/nym-node</code>, or wherever your node binary is located.</p>
<details id="admonition-console-output-1" class="admonition admonish-example" role="note" aria-labelledby="admonition-console-output-1-title">
<summary class="admonition-title">
<div id="admonition-console-output-1-title">
<p>Console output</p>
</div>
<a class="admonition-anchor-link" href="nodes/nymvisor-upgrade.html#admonition-console-output-1"></a>
</summary>
<div>
<pre><code>[2m2024-09-17T08:12:55.535520Z[0m [32m INFO[0m [2mtools/nymvisor/src/cli/init.rs[0m[2m:[0m[2m416[0m[2m:[0m enabled nymvisor logging
[2m2024-09-17T08:12:55.535529Z[0m [32m INFO[0m [2mtools/nymvisor/src/cli/init.rs[0m[2m:[0m[2m419[0m[2m:[0m initialising the nymvisor
[2m2024-09-17T08:12:55.535548Z[0m [32m INFO[0m [1mget_build_information[0m: [2mtools/nymvisor/src/daemon/mod.rs[0m[2m:[0m[2m63[0m[2m:[0m attempting to obtain daemon build information [2m[3mself.executable_path[0m[2m=[0m"../../../../target/release/nym-node"[0m
[2m2024-09-17T08:12:55.540642Z[0m [32m INFO[0m [2mtools/nymvisor/src/cli/init.rs[0m[2m:[0m[2m217[0m[2m:[0m initialising the directory structure
[2m2024-09-17T08:12:55.540702Z[0m [32m INFO[0m [2mtools/nymvisor/src/cli/init.rs[0m[2m:[0m[2m250[0m[2m:[0m setting up the genesis binary
[2m2024-09-17T08:12:55.540718Z[0m [32m INFO[0m [1mget_build_information[0m: [2mtools/nymvisor/src/daemon/mod.rs[0m[2m:[0m[2m63[0m[2m:[0m attempting to obtain daemon build information [2m[3mself.executable_path[0m[2m=[0m"/home/strix/.nym/nymvisors/data/nym-node/genesis/bin/nym-node"[0m
</code></pre>
</div>
</details>
<p>By default this will create config files at <code>~/.nym/nymvisors/instances/&lt;NODE_TYPE&gt;-default/config/config.toml</code> as shown in the console output above. For config options look at the different <code>--flags</code> available, or the <a href="nodes/nymvisor-upgrade.html#environment-variables">environment variables</a> section below.</p>
<h3 id="running-your-nymvisor-instance"><a class="header" href="#running-your-nymvisor-instance">Running your Nymvisor Instance</a></h3>
<p>Nymvisor acts as a wrapper around the specified node process - it has to do this in order to be able to pause and restart this process. As such, you need to run your node <em>via</em> Nymvisor!</p>
<p>The interface to the <code>nymvisor run &lt;ARGS&gt;</code> command is quite simple. Any argument passed after the <code>run</code> command will be passed directly to the underlying daemon, for example: <code>nymvisor run run --id default-nym-node</code> will run the <code>$DAEMON_NAME run --id default-nym-node</code> command (where <code>DAEMON_NAME</code> is the name of the binary itself (e.g. <code>nym-api</code>, <code>nym-node</code>, etc.)).</p>
<p><code>run</code> Nymvisor and start your node via the following command. Make sure to stop any existing node before running this command.</p>
<pre><code>./nymvisor run run --id &lt;NODE_ID&gt;
</code></pre>
<details id="admonition-console-output-2" class="admonition admonish-example" role="note" aria-labelledby="admonition-console-output-2-title">
<summary class="admonition-title">
<div id="admonition-console-output-2-title">
<p>Console output</p>
</div>
<a class="admonition-anchor-link" href="nodes/nymvisor-upgrade.html#admonition-console-output-2"></a>
</summary>
<div>
<pre><code></code></pre>
</div>
</details>
<p>Nymvisor will now manage your node process (for an in-depth overview of this command check the <a href="nodes/./nymvisor-upgrade.html#commands-in-depth">in-depth command information</a> below). It will periodically poll <a href="https://nymtech.net/.wellknown/nym-node/upgrade-info.json">this endpoint</a> (replace <code>nym-node</code> with whatever node you may actually be running via Nymvisor) and check for a new <code>version</code> of the binary it is watching. If this exists, it will then, using the information there:</p>
<ul>
<li>pause your node process</li>
<li>grab the new binary (<code>version</code>)</li>
<li>verify it against the provided <code>checksum</code></li>
<li>perform a data backup of the existing node</li>
<li>replace the old binary with the new one</li>
<li>restart the process</li>
</ul>
<p>And that’s it! Check the <a href="nodes/./maintenance.html#for-nymvisor">maintenance page</a> for information on Nymvisor process maintenance and automation, and you can find more in-depth information about the various aspects of Nymvisor such as what happens <a href="nodes/nymvisor-upgrade.html#commands-in-depth">under the hood</a> for various commands.</p>
<h3 id="creating-an-adhoc-upgrade"><a class="header" href="#creating-an-adhoc-upgrade">Creating an Adhoc Upgrade</a></h3>
<p><code>nymvisor add-upgrade &lt;PATH_TO_EXECUTABLE&gt; --upgrade-name=&lt;NAME&gt; --arg1=value1 --arg2=value2 ...</code> can be used to amend an existing <code>upgrade-plan.json</code> by creating new entries or to add an executable to an existing scheduled upgrade so that it would not have to be downloaded.</p>
<blockquote>
<p>Generally users <strong>will not have to use this command</strong>. Situations in which this command might be used are:</p>
<ul>
<li>an adhoc upgrade if e.g. a patched version of a binary was required</li>
<li>if a user doesn’t trust the verification process of Nymvisor’s pipeline and wishes to build/verify the binary themselves before using Nymvisor to perform the upgrade</li>
<li>if a user isn’t using a currently supported operating system and needs to manually specify a binary they have built themselves</li>
</ul>
</blockquote>
<p>Similarly to <code>init</code>, <code>add-upgrade</code> requires a positional argument specifying a valid path to the upgrade binary. Furthermore, the <code>--upgrade-name</code> keyword argument must be set in order to declare the upgrade name. The remaining arguments are optional. They include:</p>
<ul>
<li><code>--force</code> - if specified, will allow Nymvisor to overwrite existing upgrade binary / <code>upgrade-info.json</code> files if they already exist</li>
<li><code>--add-binary</code> - indicate that this command should only add binary to an existing scheduled upgrade</li>
<li><code>--now</code> - if specified will force the upgrade to be performed immediately (technically not ‘immediately’ within few seconds). It can’t be specified alongside either <code>--upgrade-time</code> or <code>--upgrade-delay</code> arguments</li>
<li><code>--publish-date</code> - if a new <code>upgrade-info.json</code> file is going to be created, this argument will specify the <code>publish_date</code> metadata field. Otherwise, the current time will be used. The <a href="https://www.rfc-editor.org/rfc/rfc3339">RFC3339 datetime</a> format is expected</li>
<li><code>--upgrade-time</code> - specifies the time at which the provided upgrade will be performed (RFC3339 formatted). If left unset, the upgrade will be performed in 15 minutes. It can’t be specified alongside either <code>--now</code> or <code>--upgrade-delay</code> arguments.</li>
<li><code>--upgrade-delay</code> - specifies delay until the provided upgrade is going to get performed. If let unset, the upgrade will be performed in 15 minutes. It can’t be specified alongside either <code>--upgrade_time</code> or <code>--now</code> arguments.</li>
</ul>
<h2 id="config"><a class="header" href="#config">Config</a></h2>
<p>The output format of <code>nymvisor config</code> can be further configured with <code>--output</code> argument. By default a human-readable text representation is used:</p>
<pre><code>id:                                nym-node-default
daemon name:                       nym-node
daemon home:                       /home/nym/.nym/nym-nodes/default-nym-node
upstream base upgrade url:         https://nymtech.net/.wellknown/
disable nymvisor logs:             false
CUSTOM upgrade data directory      ""
upstream absolute upgrade url:     ""
allow binaries download:           true
enforce download checksum:         true
restart after upgrade:             true
restart on failure:                false
on failure restart delay:          10s
max startup failures:              10
startup period duration:           2m
shutdown grace period:             10s
CUSTOM backup data directory       ""
UNSAFE skip backups                false
</code></pre>
<p>Adding <code>--output=json</code> would format the same data into JSON which can be more easily parsed programmatically to e.g. pipe the output into <code>jq</code> for further processing.</p>
<pre><code>nymvisor config --output=json
</code></pre>
<p>outputs:</p>
<pre><code>{"nymvisor":{"id":"nym-node-default","upstream_base_upgrade_url":"https://nymtech.net/.wellknown/","upstream_polling_rate":"1h","disable_logs":false,"upgrade_data_directory":null},"daemon":{"name":"nym-node","home":"/home/nym/.nym/nym-nodes/default-nym-nodee","absolute_upstream_upgrade_url":null,"allow_binaries_download":true,"enforce_download_checksum":true,"restart_after_upgrade":true,"restart_on_failure":false,"failure_restart_delay":"10s","max_startup_failures":10,"startup_period_duration":"2m","shutdown_grace_period":"10s","backup_data_directory":null,"unsafe_skip_backup":false}}
</code></pre>
<h2 id="cli-overview"><a class="header" href="#cli-overview">CLI Overview</a></h2>
<p>Command options are:</p>
<ul>
<li><code>help</code>, <code>--help</code>, or <code>-h</code> - Output Nymvisor help information and display the available commands.</li>
<li><code>config</code> - Display the current Nymvisor configuration, that means displaying the current configuration file that might have been overridden with environment variables value that Nymvisor is using.</li>
<li><code>init</code> - Generate a <code>config.toml</code> file for this instance of Nymvisor that will use the provided arguments alongside any environmental variables that are set.</li>
<li><code>add-upgrade</code> - Add an upgrade manually to Nymvisor. This command allows you to easily add the binary corresponding to an upgrade or amend the existing <code>upgrade-plan.json</code> whilst creating new <code>upgrade-info.json</code> file.</li>
<li><code>build-info</code> - Output the build information.</li>
<li><code>daemon-build-info</code> - Output the build information of the current binary used by the associated daemon.</li>
<li><code>run</code> - Run the configured binary using the rest of the provided arguments.</li>
<li><code>-V</code> or <code>--version</code> - Output the Nymvisor version</li>
</ul>
<p>Similarly to other Nym binaries, Nymvisor supports a global <code>--config-env-file</code> or <code>-c</code> flag that allows specifying path to a <code>.env</code> file defining any relevant environmental variables that are going to be applied to any of the Nymvisor commands as described in the <a href="nodes/./nymvisor-upgrade.html#environment-variables">Environment section</a>.</p>
<p>For commands that depend on Nymvisor config file (i.e. all but <code>init</code>), the configuration file is loaded as follows:</p>
<ul>
<li>if available, reading <code>$NYMVISOR_CONFIG_PATH</code></li>
<li>otherwise, if <code>$NYMVISOR_ID</code> is set, a default path will be used, i.e. <code>$HOME/.nym/nymvisors/instances/$NYMVISOR_ID/config/config.toml</code></li>
<li>finally, if there’s only a single <code>nymvisor</code> instance instantiated (as defined by directories in <code>$HOME/.nym/nymvisors/instances</code>), that one will be loaded</li>
<li>if all of the above fails, an error is returned</li>
</ul>
<p>Nymvisor attempts to load the file from the derived path. If it fails, it attempts to use one of the older schemas to and upgrade it as it goes, the loaded configuration is then overridden with any value that might have been set in the environment.</p>
<h2 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h2>
<blockquote>
<p>Please note environmental variables take precedence over any arguments passed, i.e. if one were to specify <code>--daemon_home="/foo"</code> and set <code>DAEMON_HOME="bar"</code>, the value of <code>"bar"</code> would end up being used.</p>
</blockquote>
<p>For any of its commands as described in <a href="nodes/./nymvisor-upgrade.html#cli-overview">CLI Overview section</a>, Nymvisor reads its configuration from the following environment variables:</p>
<ul>
<li><code>NYMVISOR_ID</code> is the human-readable identifier of the particular Nymvisor instance.</li>
<li><code>NYMVISOR_CONFIG_PATH</code> is used to manually override path to the configuration file of the Nymvisor instance.</li>
<li><code>NYMVISOR_UPSTREAM_BASE_UPGRADE_URL</code> (defaults to https://nymtech.net/.wellknown/) is the base url of the upstream source for obtaining upgrade information for the daemon. It will be used fo constructing the full url, i.e. <code>$NYMVISOR_UPSTREAM_BASE_UPGRADE_URL/$DAEMON_NAME/upgrade-info.json</code>.</li>
<li><code>NYMVISOR_UPSTREAM_POLLING_RATE</code> (defaults to 1h) is polling rate the upstream url for upgrade information.</li>
<li><code>NYMVISOR_DISABLE_LOGS</code> (defaults to <code>false</code>). If set to <code>true</code>, this will disable Nymvisor logs (but not the underlying process) completely.</li>
<li><code>NYMVISOR_UPGRADE_DATA_DIRECTORY</code> is the custom directory for upgrade data - binaries and upgrade plans. If not set, the global Nymvisors’ data directory will be used instead.</li>
<li><code>DAEMON_NAME</code> is the name of the binary itself (e.g. <code>nym-api</code>, <code>nym-node</code>, etc.).</li>
<li><code>DAEMON_HOME</code> is the location where the <code>nymvisor/</code> directory is kept that contains the auxiliary files associated with the underlying daemon instance, such as any backups or current version information, e.g. <code>$HOME/.nym/nym-api/my-nym-api</code>, <code>$HOME/.nym/nym-nodes/default-nym-node</code>, etc.</li>
<li><code>DAEMON_ABSOLUTE_UPSTREAM_UPGRADE_URL</code> is the absolute (i.e. the full url) upstream source for upgrade plans for this daemon. The url has to point to an endpoint containing a valid <code>UpgradeInfo</code> json file. If set it takes precedence over <code>NYMVISOR_UPSTREAM_BASE_UPGRADE_URL</code>.</li>
<li><code>DAEMON_ALLOW_BINARIES_DOWNLOAD</code> (defaults to <code>true</code>), if set to <code>true</code>, it will enable auto-downloading of new binaries (as declared by urls in corresponding <code>upgrade-info.json</code> files). For security reasons one might wish to disable it and instead manually provide binaries by either placing them in the appropriate directory or by invoking <code>add-upgrade</code> command.</li>
<li><code>DAEMON_ENFORCE_DOWNLOAD_CHECKSUM</code> (defaults to <code>true</code>), if set to <code>true</code> Nymvisor will require that a checksum is provided in the upgrade plan for the upgrade binary to be downloaded. If disabled, Nymvisor will not require a checksum to be provided, but still check the checksum if one is provided.</li>
<li><code>DAEMON_RESTART_AFTER_UPGRADE</code> (defaults to <code>true</code>), if set to <code>true</code> Nymvisor will restart the subprocess with the same command-line arguments and flags (but with the new binary) after a successful upgrade. Otherwise (<code>false</code>), Nymvisor stops running after an upgrade and requires the system administrator to manually restart it. <strong>Note restart is only after the upgrade and does not auto-restart the subprocess after an error occurs.</strong> That is controlled via <code>DAEMON_RESTART_ON_FAILURE</code>.</li>
<li><code>DAEMON_RESTART_ON_FAILURE</code> (defaults to <code>true</code>), if set to <code>true</code>, Nymvisor will restart the subprocess with the same command-line arguments and flags if it has terminated with a non-zero exit code.</li>
<li><code>DAEMON_FAILURE_RESTART_DELAY</code> (defaults to 10s), if <code>DAEMON_RESTART_ON_FAILURE</code> is set to <code>true</code>, this will specify a delay between the process shutdown (with a non-zero exit code) and it being restarted.</li>
<li><code>DAEMON_MAX_STARTUP_FAILURES</code> (defaults to 10) if <code>DAEMON_RESTART_ON_FAILURE</code> is set to <code>true</code>, this defines the maximum number of startup failures the subprocess can experience in a quick succession before no further restarts will be attempted and Nymvisor will terminate.</li>
<li><code>DAEMON_STARTUP_PERIOD_DURATION</code> (defaults to 120s) if <code>DAEMON_RESTART_ON_FAILURE</code> is set to <code>true</code>, this defines the length of time during which the subprocess is still considered to be in the startup phase when its failures are going to be counted towards the limit defined in <code>DAEMON_MAX_STARTUP_FAILURES</code>.</li>
<li><code>DAEMON_SHUTDOWN_GRACE_PERIOD</code> (defaults to 10s), specifies the amount of time Nymvisor is willing to wait for the subprocess to undergo graceful shutdown after receiving an interrupt before it sends a kill signal.</li>
<li><code>DAEMON_BACKUP_DATA_DIRECTORY</code> specifies custom backup directory for daemon data. If not set, <code>DAEMON_HOME/nymvisor/backups</code> is used instead.</li>
<li><code>DAEMON_UNSAFE_SKIP_BACKUP</code> (defaults to <code>false</code>), if set to <code>true</code>, all upgrades will be performed directly without performing any backups. Otherwise (<code>false</code>), Nymvisor will back up the contents of <code>DAEMON_HOME</code> before trying the upgrade.</li>
</ul>
<h2 id="dir-structure"><a class="header" href="#dir-structure">Dir structure</a></h2>
<p>The folder structure of Nymvisor is heavily inspired by Cosmovisor, but with some notable changes to accommodate our binaries having possibly multiple instances due to their different <code>--id</code> flags. The data is spread through three main directories:</p>
<ul>
<li>in a global <code>nymvisors</code> data directory shared by all Nymvisor instances (default: <code>$HOME/.nym/nymvisors/data</code>) that contains daemon upgrade plans, binaries and upgrades histories. It includes a subdirectory for each version of the application (i.e. <code>genesis</code> or <code>upgrades&lt;name&gt;</code>). Within each subdirectory is the application binary (i.e. <code>bin/$DAEMON_NAME</code>), the associated <code>upgrade-info.json</code> and any additional auxiliary files associated with each binary. <code>current</code> is a symbolic link to the currently active directory (i.e. <code>genesis</code> or <code>upgrades/&lt;NAME&gt;</code>)</li>
<li>in a home directory of a particular <code>nymvisor</code> instance (e.g. <code>$HOME/.nym/nymvisors/instances/&lt;nymvisor-instance-id&gt;/</code>). It includes subdirectories for its configuration file (i.e. <code>config/config.toml</code>), that preconfigures the instance, and for any additional persistent data that might be added in the future (i.e. <code>data</code>)</li>
<li>in a <code>nymvisor</code> data directory inside the home directory of the managed daemon instance (default: <code>$HOME/.nym/$DAEMON_NAME/nymvisor</code>) that contains subdirectories for data backups (i.e. <code>backups/&lt;name&gt;</code>) and current version information (<code>current-version-info.json</code>)</li>
</ul>
<p>A sample full structure looks as follows:</p>
<pre><code>~/.nym
├── nymvisors
│   ├── instances
│   │   ├── &lt;id1&gt;
│   │   │   ├── config
│   │   │   │   └── config.toml
│   │   │   └── data
│   │   │       └── ...
│   │   └── &lt;id2&gt;
│   │       └── ...
│   └── data
│       ├── nym-api
│       │   ├── current -&gt; genesis or upgrades/&lt;name&gt;
│       │   ├── genesis
│       │   │   ├── bin
│       │   │   │   └── nym-api
│       │   │   └── upgrade-info.json
│       │   ├── upgrades
│       │   │   └── &lt;upgrade-name&gt;
│       │   │       ├── bin
│       │   │       │   └── nym-api
│       │   │       └── upgrade-info.json
│       │   ├── upgrade-history.json
│       │   └── upgrade-plan.json
│       ├── nym-node
│       │   └── ...
│       └── $DAEMON_NAME
│           └── ...
└── nym-api
├── &lt;id1&gt;
│   ├── config
│   │   └── &lt;nym-api-config-data&gt;
│   ├── data
│   │   └── &lt;nym-api-data&gt;
│   └── nymvisor
│       ├── backups
│       │   └── &lt;upgrade-name&gt;
│       │       └── ....
│       └── current-version-info.json
└── &lt;id2&gt;
└── ...
</code></pre>
<h2 id="commands-in-depth"><a class="header" href="#commands-in-depth">Commands In-Depth</a></h2>
<p>This section outlines what happens under the hood with the following commands:</p>
<h3 id="init"><a class="header" href="#init">Init</a></h3>
<p><code>init</code> does the following:</p>
<ul>
<li>executes the <code>$DAEMON_NAME build-info</code> command on the daemon executable to check its validity and obtain its name</li>
<li>creates the required directory structure:
<ul>
<li><code>$DAEMON_HOME/nymvisor</code> folder if it doesn’t yet exist</li>
<li><code>$DAEMON_BACKUP_DATA_DIRECTORY</code> folder if it doesn’t yet exist</li>
<li><code>$NYMVISOR_UPGRADE_DATA_DIRECTORY</code> folder if it doesn’t yet exist</li>
<li><code>$NYMVISOR_UPGRADE_DATA_DIRECTORY/$DAEMON_NAME/genesis/bin</code> folder if it doesn’t yet exist</li>
<li><code>$NYMVISOR_UPGRADE_DATA_DIRECTORY/$DAEMON_NAME/upgrades</code> folder if it doesn’t yet exist</li>
</ul>
</li>
<li>copies the provided executable to <code>$NYMVISOR_UPGRADE_DATA_DIRECTORY/$DAEMON_NAME/genesis/bin/$DAEMON_NAME</code></li>
<li>generates initial <code>$NYMVISOR_UPGRADE_DATA_DIRECTORY/$DAEMON_NAME/genesis/upgrade-info.json</code> file based on the provided binary</li>
<li>generates initial <code>$DAEMON_HOME/nymvisor/current-version-info.json</code> file based on the provided binary</li>
<li>creates a <code>$NYMVISOR_UPGRADE_DATA_DIRECTORY/$DAEMON_NAME/current</code> symlink pointing to <code>$NYMVISOR_UPGRADE_DATA_DIRECTORY/$DAEMON_NAME/genesis</code></li>
<li>saves the Nymvisor instance’s config file to <code>$NYMVISOR_CONFIG_PATH</code> and creates the full directory structure for the file</li>
<li>outputs (to <code>stdout</code>) the full configuration used</li>
</ul>
<blockquote>
<p><code>nymvisor init</code> is specifically for initializing Nymvisor, and should <strong>not</strong> be confused with a daemon’s <code>init</code> command - such as <code>nym-node init</code> (e.g. <code>cosmovisor run init</code>).</p>
</blockquote>
<h3 id="run"><a class="header" href="#run">Run</a></h3>
<p><code>nymvisor run</code> is a lightweight wrapper around the underlying daemon. It uses only a single thread and spawns three simple tasks:</p>
<ul>
<li>an upstream poller that checks the upstream source (as defined by <code>DAEMON_ABSOLUTE_UPSTREAM_UPGRADE_URL</code> or derived from <code>NYMVISOR_UPSTREAM_BASE_UPGRADE_URL</code>) for any recently released upgrades. It then creates appropriate <code>upgrade-info.json</code> file and updates the <code>upgrade-plan.json</code></li>
<li>a file watcher for the <code>upgrade-plan.json</code> file that can notify the main run loop of upgrades that were added by either the above upstream poller task or via the <code>add-upgrade</code> command,</li>
<li>the daemon run loop that:
<ul>
<li>runs the <code>DAEMON_NAME</code> with the provided arguments until:
<ul>
<li>it completes the execution (with any exit code),</li>
<li>Nymvisor receives a <code>SIGINT</code>, <code>SIGTERM</code> or <code>SIGQUIT</code>,</li>
<li>a new upgrade is scheduled to be performed (by other task watching for changes in <code>upgrade-plan.json</code> and waiting until the <code>upgrade_time</code>,</li>
</ul>
</li>
<li>if <code>DAEMON_UNSAFE_SKIP_BACKUP</code> is not set to <code>true</code>, it backups the content of <code>DAEMON_HOME</code> directory,</li>
<li>performs the binary upgrade by:
<ul>
<li>creating a temporary, exclusive and non-blocking, <code>upgrade.lock</code> file for the <code>DAEMON_NAME</code>. <code>flock</code> with <code>LOCK_EX | LOCK_NB</code> is used for that purpose. The file is created in case users didn’t read any warnings and attempted to run multiple instances of <code>nymvisor</code> managing the same <code>DAEMON_NAME</code>,</li>
<li>downloading the upgrade binary for the runners architecture using one of the urls defined in <code>upgrade-info.json</code>. Note, however, that this is only done if the binary associated with the <code>&lt;UPGRADE-NAME&gt;</code> does not already exist and <code>DAEMON_ALLOW_DOWNLOAD_BINARIES</code> is set to <code>true</code>,
<ul>
<li>if the binary has been downloaded and <code>DAEMON_ENFORCE_DOWNLOAD_CHECKSUM</code> is set to true, the file checksum is verified using the specified algorithm,</li>
</ul>
</li>
<li>verifying the upgrade binary - checking if it’s a valid executable with expected <code>build-info</code>. Note that this will also set <code>a+x</code> bits on the file if those permissions have not already been set,
<ul>
<li>removing the queued upgrade from <code>upgrade-plan.json</code>,</li>
<li>inserting new upgrade into the <code>upgrade-history.json</code>,</li>
<li>updating the <code>current-version-info.json</code>,</li>
<li>updating the <code>$NYMVISOR_UPGRADE_DATA_DIRECTORY/$DAEMON_NAME/current</code> symlink to the upgrade directory,</li>
<li>removing the <code>upgrade.lock</code> file.</li>
</ul>
</li>
</ul>
</li>
<li>the above loop is repeated if either:
<ul>
<li>the daemon has crashed and <code>DAEMON_MAX_STARTUP_FAILURES</code> has not been reached yet,</li>
<li>the daemon has successfully been upgraded, <code>DAEMON_RESTART_AFTER_UPGRADE</code> has been set to <code>true</code> and the manual flag on the performed upgrade has been set to <code>false</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="add-upgrade"><a class="header" href="#add-upgrade">Add-Upgrade</a></h3>
<p><code>nymvisor add-upgrade</code> does the following:</p>
<ul>
<li>executes the <code>$DAEMON_NAME build-info</code> command on the daemon executable to check its validity and obtain its name</li>
<li>attempts to load existing <code>upgrade-info.json</code> for the provided <code>&lt;upgrade-name&gt;</code>. If it already exists and neither <code>--force</code> nor <code>--add-binary</code> was specified, Nymvisor will terminate</li>
<li>checks if <code>upgrades/&lt;upgrade-name&gt;/$DAEMON_NAME</code> binary already exists. If it does and <code>--force</code> flag was not specified, Nymvisor will terminate the provided upgrade binary is copied to its appropriate location</li>
<li>if applicable, new <code>upgrade-info.json</code> is created and written to its appropriate location</li>
<li><code>upgrade-plan.json</code> is updated with the new upgrade details. If there’s an active Nymvisor instance running, this change will be detected to initialise upgrade process</li>
</ul>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="performance-monitoring--testing"><a class="header" href="#performance-monitoring--testing">Performance Monitoring &amp; Testing</a></h1>
<p>Nym Mixnet has been running on mainnet for quite some time. There is still work to be done in order for the network to meet its full potential - mass adoption of privacy through fully distributed Mixnet.</p>
<p>As developers we need to be constantly improving the software. Operators have as much important role, keep their nodes up to date, monitor their performance and share their feedback with the rest of the community and core developers.</p>
<p>Therefore <a href="testing/performance.html#monitoring">monitoring</a> and <a href="testing/performance.html#testing">testing</a> are essential pieces of our common work. We call out all Nym operators to join the efforts!</p>
<h2 id="monitoring"><a class="header" href="#monitoring">Monitoring</a></h2>
<p>There are multiple ways to monitor performance of nodes and the machines on which they run. For the purpose of maximal privacy and decentralisation of the data - preventing Nym Mixnet from any global adversary takeover - we created these pages as a source of mutual empowerment, a place where operators can share and learn new skills to <strong>setup metrics monitors on their own infrastructure</strong>.</p>
<h3 id="guides-to-setup-own-metrics"><a class="header" href="#guides-to-setup-own-metrics">Guides to Setup Own Metrics</a></h3>
<p>A list of different scripts, templates and guides for easier navigation:</p>
<ul>
<li><a href="testing/gateway-probe.html"><code>nym-gateway-probe</code></a> - a useful tool used under the hood of <a href="https://harbourmaster.nymtech.net">harbourmaster.nymtech.net</a></li>
<li><a href="testing/prometheus-grafana.html">Prometheus and Grafana</a> self-hosted setup</li>
<li><a href="https://gist.github.com/tommyv1987/97e939a7adf491333d686a8eaa68d4bd">Nym-node CPU cron service</a> - an easy bash script by Nym core developer <a href="https://gist.github.com/tommyv1987">@tommy1987</a>, designed to monitor a CPU usage of your node, running locally</li>
<li>Nym’s script <a href="https://github.com/nymtech/nym/blob/develop/scripts/prom_targets.py"><code>prom_targets.py</code></a> - a useful python program to request data from API and can be run on its own or plugged to more sophisticated flows</li>
</ul>
<h3 id="collecting-testing-metrics"><a class="header" href="#collecting-testing-metrics">Collecting Testing Metrics</a></h3>
<p>For the purpose of the performance testing Nym core developers plan to run instances of Prometheus and Grafana connected to Node explorer in the house. The network overall key insights we seek from these tests are primarily internal. We’re focused on pinpointing bottlenecks, capacity loads, and monitoring cpu usage on the nodes’ machines.</p>
<h2 id="testing"><a class="header" href="#testing">Testing</a></h2>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="testing/performance.html#admonition-info"></a>
</div>
<div>
<p>For the moment we paused Fast and Furious <code>perf</code> environment. Nym Mainnet environment will be used for future tests, please wait for further instructions.</p>
</div>
</div>
<p>Nym asks its decentralised community of operators to join a series of performance testing events in order to <strong>increase the overall quality of the Mixnet</strong>. The main takeaways of such event are:</p>
<ol>
<li>Understanding of the network behavior under full load
<ul>
<li>How many mixnet client users can all active set entry gateways handle simultaneously?</li>
<li>How much sustained IP traffic can a subset of mainnet nodes sustain?</li>
</ul>
</li>
<li>Needed improvements of Nym Node binaries to improve the throughput on mainnet</li>
<li>Measurement of required machine specs</li>
<li>Raw data record</li>
<li>Increase quality of Nym Nodes</li>
<li>Show each operator a way to monitor their nodes in a distributed fashion</li>
</ol>
<p>Visit <a href="https://nymtech.net/events/fast-and-furious">Fast and Furious web page</a> and <a href="https://harbourmaster.nymtech.net/">Nym Harbour Master</a> Gateways monitoring page to read more about the performance testing and the results of it.</p>
<!--- THIS NEEDS A REDO:
## Performance Testing Work Flow

* Nym runs a paralel network environment with a chain ID `perf`
* Operators of Nym Nodes join by following easy steps on [performance testing web page](https://nymtech.net/events/fast-and-furious), including simplified node authentication signature (while keep running their nodes on the mainnet)
* Once signed in, operators will be asked to swap their binary for the modified version with metrics endpoint to be able to connect their own [monitoring system](#monitoring)
* Core node data will be fed to a unique mixnet contract for the `perf` side chain
* Nym starts a new API and start packet transition in high load through these nodes in both settings
* Nym tracks packet flow using Prometheus and Grafana
* Nym creates a large number of clients to the [performance validator network](http://validator.performance.nymte.ch/), intensifying the packet traffic
* Observe and record the metrics - this will probably put more strain on mainnet as well as many nodes spec is minimal
--->
<footer id="last-change">Last change: 2024-08-06, commit: <a href="https://github.com/nymtech/nym/commit/aaf3dca5b">aaf3dca5b</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nym-gateway-probe"><a class="header" href="#nym-gateway-probe">Nym Gateway Probe</a></h1>
<p>Nym Node operators running Gateway functionality are already familiar with the monitoring tool <a href="https://harbourmaster.nymtech.net">Harbourmaster.nymtech.net</a>. Under the hood of Nym Harbourmaster runs iterations of <code>nym-gateway-probe</code> doing various checks and displaying the results on the interface. Operators don’t have to rely on the probe ran by Nym and wait for the data to refresh. With <code>nym-gateway-probe</code> everyone can check any Gateway’s networking status from their own computer at any time. In one command the client queries data from:</p>
<ul>
<li><a href="https://validator.nymtech.net/api/v1/gateways"><code>nym-api</code></a></li>
<li><a href="https://explorer.nymtech.net/api/v1/gateways"><code>explorer-api</code></a></li>
<li><a href="https://harbourmaster.nymtech.net/"><code>harbour-master</code></a></li>
</ul>
<h2 id="preparation"><a class="header" href="#preparation">Preparation</a></h2>
<p>We recommend to have install all <a href="testing/../binaries/building-nym.html#prerequisites">the prerequisites</a> needed to build <code>nym-node</code> from source including latest <a href="https://www.rust-lang.org/tools/install">Rust Toolchain</a>.</p>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p><code>nym-gateway-probe</code> source code is in <a href="https://github.com/nymtech/nym-vpn-client"><code>nym-vpn-client</code></a> repository. The client needs to be build from source.</p>
<ol>
<li>Clone the repository:</li>
</ol>
<pre><code class="language-sh">git clone https://github.com/nymtech/nym-vpn-client.git
</code></pre>
<ol start="2">
<li>Build <code>nym-gateway-probe</code>:</li>
</ol>
<pre><code class="language-sh">cd nym-vpn-client/nym-vpn-core

cargo build --release -p nym-gateway-probe
</code></pre>
<h2 id="running-the-client"><a class="header" href="#running-the-client">Running the client</a></h2>
<pre><code class="language-sh">./target/release/nym-gateway-probe --help
</code></pre>
<details id="admonition-nym-gateway-probe---help" class="admonition admonish-example" role="note" aria-labelledby="admonition-nym-gateway-probe---help-title">
<summary class="admonition-title">
<div id="admonition-nym-gateway-probe---help-title">
<p><code>nym-gateway-probe --help</code></p>
</div>
<a class="admonition-anchor-link" href="testing/gateway-probe.html#admonition-nym-gateway-probe---help"></a>
</summary>
<div>
<pre><code>Usage: nym-gateway-probe [OPTIONS]

Options:
  -c, --config-env-file &lt;CONFIG_ENV_FILE&gt;  Path pointing to an env file describing the network
  -g, --gateway &lt;GATEWAY&gt;
  -n, --no-log
  -h, --help                               Print help
  -V, --version                            Print version

</code></pre>
</div>
</details>
<p>To run the client, simply add a flag <code>--gateway</code> with a targeted gateway identity key.</p>
<pre><code class="language-sh">./target/release/nym-gateway-probe --gateway &lt;GATEWAY_IDENTITY_KEY&gt;
</code></pre>
<p>For any <code>nym-node --mode exit-gateway</code> the aim is to have this outcome:</p>
<pre><code class="language-sh">{
  "gateway": "&lt;GATEWAY_IDENTITY_KEY&gt;",
  "outcome": {
    "as_entry": {
      "can_connect": true,
      "can_route": true
    },
    "as_exit": {
      "can_connect": true,
      "can_route_ip_v4": true,
      "can_route_ip_external_v4": true,
      "can_route_ip_v6": true,
      "can_route_ip_external_v6": true
    }
  }
}
</code></pre>
<p>If your Gateway is blacklisted, the probe will not work.</p>
<p>If you don’t provide a <code>--gateway</code> flag it will pick a random one to test.</p>
<footer id="last-change">Last change: 2024-08-06, commit: <a href="https://github.com/nymtech/nym/commit/7e36595d8">7e36595d8</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="node-api-check"><a class="header" href="#node-api-check">Node API Check</a></h1>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable/version. Exchange with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<p>Operating a <code>nym-node</code> is not a <em>“set and forget”</em> endeavor, it takes some work. To diagnose node performance querying APIs is a good knowledge to have. There are two main places to look for API endpoints regarding <code>nym-node</code>:</p>
<ul>
<li><a href="https://validator.nymtech.net/api/v1/openapi.json"><code>openapi.json</code></a>: a list of all endpoints</li>
<li><a href="https://validator.nymtech.net/api/swagger/index.html">Swagger UI page</a></li>
</ul>
<p>Besides that, Gateway operators can check out their node performance, connectivity and much more on <a href="https://harbourmaster.nymtech.net/">harbourmaster.nymtech.net</a>.</p>
<h3 id="basic-api-usage"><a class="header" href="#basic-api-usage">Basic API usage</a></h3>
<p>For information about available endpoints and their status, you can refer to:</p>
<pre><code class="language-sh"># sustitude &lt;NODE_IP_ADDRESS&gt; or &lt;NODE_DOMAIN&gt; with a real one
# for http
http://&lt;NODE_IP_ADDRESS&gt;:8080/api/v1/swagger/#/
# or
http://&lt;NODE_IP_ADDRESS&gt;/api/v1/swagger/#/

# for reversed proxy/WSS
https://&lt;NODE_DOMAIN&gt;/api/v1/swagger/#/
</code></pre>
<p>For example to determine which mode your node is running, you can check <code>:8080/api/v1/roles</code> endpoint:</p>
<pre><code class="language-sh"># sustitude &lt;NODE_IP_ADDRESS&gt; or &lt;NODE_DOMAIN&gt; with a real one
# for http
http://&lt;NODE_IP_ADDRESS&gt;:8080/api/v1/roles
# or
http://&lt;NODE_IP_ADDRESS&gt;/api/v1/roles

# for reversed proxy/WSS
https://&lt;NODE_DOMAIN&gt;/api/v1/roles
</code></pre>
<h2 id="node_api_checkpy"><a class="header" href="#node_api_checkpy"><code>node_api_check.py</code></a></h2>
<p>To make this a bit easier, we made a CLI tool querying all available API endpoints based on node <code>Identity Key</code> (further denoted as <code>&lt;ID_KEY&gt;</code>) called <code>node_api_check.py</code>. To diagnose your node performance, whether by yourself or by sharing an output in our <a href="https://matrix.to/#/#operators:nymtech.chat">operator channel</a>, this tool provides you with a quick overview of live data. We recommend to run this checker alongside <a href="testing/gateway-probe.html"><code>nym_gateway_probe</code></a> to triage both performance and an actual routing.</p>
<p>Besides querying any bonded node APIs, <code>nym_api_check</code> has a function counting all existing nodes in provided version.</p>
<h3 id="setup"><a class="header" href="#setup">Setup</a></h3>
<h4 id="pre-requsities"><a class="header" href="#pre-requsities">Pre-requsities</a></h4>
<p><strong>Python3</strong></p>
<ol>
<li>Start with installing Python3:</li>
</ol>
<pre><code class="language-sh">sudo apt install python3
</code></pre>
<ol start="2">
<li>Make sure Python3 is your default Python version:</li>
</ol>
<pre><code class="language-sh">update-alternatives --install  /usr/bin/python python /usr/bin/python3 1

# controll
python --version

# should return higher than 3
</code></pre>
<ol start="3">
<li>Install Python modules <code>tabulate</code>, <code>pandas</code> and <code>argparse</code>:</li>
</ol>
<ul>
<li>either using <a href="https://python.land/virtual-environments/installing-packages-with-pip"><code>pip</code></a> and then running:</li>
</ul>
<pre><code class="language-sh">pip install tabulate pandas argparse
</code></pre>
<ul>
<li>or if you installed Python3 system-wide you can install modules directly:</li>
</ul>
<pre><code class="language-sh">sudo apt install python3-tabulate python3-pandas python3-argparse
</code></pre>
<p><strong>Installation</strong></p>
<ol start="4">
<li>Get <a href="https://github.com/nymtech/nym/tree/develop/scripts/node_api_check.py"><code>node_api_check.py</code></a> and <a href="https://github.com/nymtech/nym/tree/develop/scripts/api_endpoints.json"><code>api_endpoints.json</code></a>. If you <a href="testing/../binaries/building-nym.html">compiled from source</a>, you already have both of these files. If you prefer to download them individually, do it by opening terminal in your desired location and running:</li>
</ol>
<pre><code class="language-sh">wget https://raw.githubusercontent.com/nymtech/nym/tree/develop/node_api_check.py

wget https://raw.githubusercontent.com/nymtech/nym/tree/develop/api_endpoints.json
</code></pre>
<ol start="5">
<li>Make executable:</li>
</ol>
<pre><code class="language-sh">chmod u+x node_api_check.py
</code></pre>
<p>Now you are ready to check your node.</p>
<h3 id="usage-1"><a class="header" href="#usage-1">Usage</a></h3>
<p>Run with <code>--help</code> flag to see the available commands:</p>
<details id="admonition-node_api_checkpy---help" class="admonition admonish-example" role="note" aria-labelledby="admonition-node_api_checkpy---help-title">
<summary class="admonition-title">
<div id="admonition-node_api_checkpy---help-title">
<p>./node_api_check.py –help</p>
</div>
<a class="admonition-anchor-link" href="testing/node-api-check.html#admonition-node_api_checkpy---help"></a>
</summary>
<div>
<pre><code class="language-python">usage: Nym-node API check [-h] [-V]
                          {query_stats,q,query,version_count,v,version} ...

Run through all endpoints and print results.

positional arguments:
  {query_stats,q,query,version_count,v,version}
    query_stats (q, query)
                        Get all nodes API endpoints
    version_count (v, version)
                        Sum of nodes in given version(s)

options:
  -h, --help            show this help message and exit
  -V, --version         show program's version number and exit
</code></pre>
</div>
</details>
<h4 id="query_stats"><a class="header" href="#query_stats"><code>query_stats</code></a></h4>
<p>When you want to see all the options connected to a command, add a <code>--help</code> flag after the command of your choice, like in this example:</p>
<details id="admonition-node_api_checkpy-query_stats---help" class="admonition admonish-example" role="note" aria-labelledby="admonition-node_api_checkpy-query_stats---help-title">
<summary class="admonition-title">
<div id="admonition-node_api_checkpy-query_stats---help-title">
<p>./node_api_check.py query_stats –help</p>
</div>
<a class="admonition-anchor-link" href="testing/node-api-check.html#admonition-node_api_checkpy-query_stats---help"></a>
</summary>
<div>
<pre><code class="language-python">usage: Nym-node API check query_stats [-h] [--no_routing_history]
                                      [--no_verloc_metrics] [-m] [-o [OUTPUT]]
                                      id

positional arguments:
  id                    supply nym-node identity key

options:
  -h, --help            show this help message and exit
  --no_routing_history  Display node stats without routing history
  --no_verloc_metrics   Display node stats without verloc metrics
  -m, --markdown        Display results in markdown format
  -o [OUTPUT], --output [OUTPUT]
                        Save results to file (in current dir or supply with
                        path without filename)
</code></pre>
</div>
</details>
<p>The most common usage may be <code>./node_api_check.py query_stats &lt;ID_KEY&gt;</code> where <code>&lt;ID_KEY&gt;</code> is required, substitute it with node Identity Key.</p>
<p><strong>Optional arguments</strong></p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Flag</th><th style="text-align: left">Shortcut</th><th style="text-align: left">Description</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>--markdown</code></td><td style="text-align: left"><code>-m</code></td><td style="text-align: left">returns output in markdown format</td></tr>
<tr><td style="text-align: left"><code>--no_routing_history</code></td><td style="text-align: left">None</td><td style="text-align: left">returns output without routing history which can be lengthy</td></tr>
<tr><td style="text-align: left"><code>--no_verloc_metrics</code></td><td style="text-align: left">None</td><td style="text-align: left">returns output without verloc measurement which can be lengthy</td></tr>
<tr><td style="text-align: left"><code>--output</code></td><td style="text-align: left"><code>-o</code></td><td style="text-align: left">exports output to a file, possible to add a target path</td></tr>
</tbody></table>
</div>
<h4 id="version_count"><a class="header" href="#version_count"><code>version_count</code></a></h4>
<p>Another command is <code>version_count</code> where at least one <code>nym-node</code> version is required. In case of multiple version count, separate the versions with space. We recommend to run this command with <code>--markdown</code> flag for a nicer output. This is an example where we want to look up how many registered nodes are on versions <code>1.1.0</code>, <code>1.1.1</code>, <code>1.1.2</code> and <code>1.1.3</code>:</p>
<pre><code class="language-sh">./node_api_check version_count 1.1.0 1.1.1 1.1.2 1.1.3 --markdown
</code></pre>
<div id="admonition-tip" class="admonition admonish-tip" role="note" aria-labelledby="admonition-tip-title">
<div class="admonition-title">
<div id="admonition-tip-title">
<p>Tip</p>
</div>
<a class="admonition-anchor-link" href="testing/node-api-check.html#admonition-tip"></a>
</div>
<div>
<p>To see a quick overview of <code>nym-node</code> version distribution in numbers and graph, visit <a href="https://harbourmaster.nymtech.net">Nym Harbourmaster</a>.</p>
</div>
</div>
<footer id="last-change">Last change: 2024-09-03, commit: <a href="https://github.com/nymtech/nym/commit/330094252">330094252</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="prometheus--grafana"><a class="header" href="#prometheus--grafana">Prometheus &amp; Grafana</a></h1>
<p>The combination of Prometheus and Grafana is a common stack used by Nym team for internal monitoring as well as by core community operators like <a href="https://github.com/ExploreNYM/self-hosted-monitor">ExploreNym</a> or <a href="https://status.notrustverify.ch/d/CW3L7dVVk/nym-mixnet?orgId=1">No Trust Verify</a>.</p>
<h2 id="prometheus"><a class="header" href="#prometheus">Prometheus</a></h2>
<p><a href="https://prometheus.io">Prometheus</a> is a free and open source monitoring systems. It allows operators to have their metrics, events, and alerts under full control. This ecosystem offers multiple advantages:</p>
<ul>
<li>collects and records metrics from servers, containers, and applications</li>
<li>provides a <a href="https://prometheus.io/docs/prometheus/latest/querying/basics/">flexible query language (PromQL)</a></li>
<li>multiple modes visualization tools</li>
<li>an alerting mechanism that sends notifications</li>
</ul>
<p>Prometheus collects and stores its metrics as time series data, i.e. metrics information is stored with the timestamp at which it was recorded, alongside optional key-value pairs called labels.</p>
<h2 id="grafana"><a class="header" href="#grafana">Grafana</a></h2>
<p><a href="https://grafana.com/docs/grafana/latest/">Grafana</a> is an open-source analytics and interactive front end. It is widely used for its easy to manage dashboards with visualizations like graphs, charts and alerts, all connected to live data sources.</p>
<h2 id="setup-guides"><a class="header" href="#setup-guides">Setup Guides</a></h2>
<p>There are various ways how to setup this stack. You can chose based on your preferences to do your own flow or follow some of the documented ones:</p>
<ul>
<li><a href="testing/explorenym-scripts.html">ExploreNYM scripts</a> for self-hosted monitoring</li>
<li>Setup monitoring in a Docker container (<em>detailed guide will be published soon</em>)</li>
</ul>
<!--- [Run in a Docker](docker-monitor.md) -->
<h2 id="references-and-further-reading"><a class="header" href="#references-and-further-reading">References and further reading</a></h2>
<ul>
<li><a href="https://prometheus.io/download/">Prometheus release page</a></li>
<li><a href="https://prometheus.io/docs/introduction/overview/">Prometheus documentation</a></li>
<li>Installation <a href="https://www.cherryservers.com/blog/install-prometheus-ubuntu">guide to install Prometheus</a> on Ubuntu by cherryservers</li>
<li><a href="https://grafana.com/docs/grafana/latest/setup-grafana/installation/debian/">Grafana installation guide</a></li>
<li>Nym’s script <a href="https://github.com/nymtech/nym/blob/develop/scripts/prom_targets.py"><code>prom_targets.py</code></a> - a python program to request data from API and can be plugged to this stack</li>
</ul>
<footer id="last-change">Last change: 2024-08-06, commit: <a href="https://github.com/nymtech/nym/commit/7e36595d8">7e36595d8</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="explorenym-monitoring-scripts"><a class="header" href="#explorenym-monitoring-scripts">ExploreNym Monitoring Scripts</a></h1>
<h2 id="community-monitoring-tools"><a class="header" href="#community-monitoring-tools">Community Monitoring Tools</a></h2>
<p>Individual operators, node families and squads are the foundation of distributed network. There has been a great number of tools coming out of this community some of which can be deployed for the node monitoring setup.</p>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="testing/explorenym-scripts.html#admonition-warning"></a>
</div>
<div>
<p>Make sure you understand and properly evaluate what degree of control you give permission to before granting access to your data to any tools running on someone else’s servers.</p>
</div>
</div>
<h2 id="explorenym-tools"><a class="header" href="#explorenym-tools">ExploreNYM Tools</a></h2>
<p>Long term involved operator Pawnflake, an author of <a href="https://explorenym.net/">ExploreNYM</a> explorer, created a monitoring flow, which can be used by other operators called <a href="https://github.com/ExploreNYM/self-hosted-monitor"><code>self-hosted-monitor</code></a>. It utilises bash scripts to enable operators setup <a href="https://github.com/ExploreNYM/self-hosted-monitor/blob/main/prometheus.sh">Prometheus</a> and <a href="https://github.com/ExploreNYM/self-hosted-monitor/blob/main/grafana.sh">Grafana</a> together with <a href="https://github.com/ExploreNYM/self-hosted-monitor/blob/main/node-exporter.sh">Node Exporter</a> and <a href="https://github.com/ExploreNYM/self-hosted-monitor/blob/main/nginx-certbot.sh">Nginx</a> to run their metrics monitoring stack locally.</p>
<p>In collaboration with ExploreNYM we published a <a href="testing/explorenym-scripts.html#setup">step by step guide</a> to set this up.</p>
<p>ExploreNYM also has a network measuring instance called <code>enym-monitor</code>. This setup is very simple for users, however it means that their data are all aggregated into one server and that is a design we would like to discourage from using as a primary one because such setup always brings a risk of centralisation of distributed node’s data into one computer.</p>
<h2 id="setup-1"><a class="header" href="#setup-1">Setup</a></h2>
<div id="admonition-warning-1" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-1-title">
<div class="admonition-title">
<div id="admonition-warning-1-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="testing/explorenym-scripts.html#admonition-warning-1"></a>
</div>
<div>
<p>This setup and the scripts included were not written by Nym developers. As always do your own audit before installing any scripts on your machine and familiarize yourself with the security risks involved when opening ports or allowing http access.</p>
</div>
</div>
<p>According to ExploreNYM the system requirements of the monitor stack are:</p>
<ul>
<li>2 CPU</li>
<li>4 GB RAM</li>
<li>20 GB of free disk space.</li>
</ul>
<h3 id="the-monitoring-part-setup"><a class="header" href="#the-monitoring-part-setup">The monitoring part setup</a></h3>
<p>This can be setup on another VPS than the node if desired. We recommend to try to set this up on the same VPS, as your node as we expect the machine to be strong enough to handle the node with enough capacity reserve for monitor.</p>
<ol>
<li>Install git</li>
</ol>
<pre><code class="language-sh">apt install git
</code></pre>
<ol start="2">
<li>Clone the repository to <code>~/self-hosted-monitor</code></li>
</ol>
<pre><code class="language-sh">git clone https://github.com/ExploreNYM/self-hosted-monitor ~/self-hosted-monitor
</code></pre>
<ol start="3">
<li>Give permissions to <a href="https://github.com/ExploreNYM/self-hosted-monitor/blob/main/prometheus.sh"><code>prometheus.sh</code></a> script and run it to setup Prometheus</li>
</ol>
<pre><code class="language-sh">chmod +x ~/self-hosted-monitor/prometheus.sh &amp;&amp; ~/self-hosted-monitor/prometheus.sh
</code></pre>
<ol start="4">
<li>Give permissions to <a href="https://github.com/ExploreNYM/self-hosted-monitor/blob/main/grafana.sh"><code>grafana.sh</code></a> script and run it to setup Grafana</li>
</ol>
<pre><code class="language-sh">chmod +x ~/self-hosted-monitor/grafana.sh &amp;&amp; ~/self-hosted-monitor/grafana.sh
</code></pre>
<ol start="5">
<li>Open port <code>3000</code> to allow access to Grafana</li>
</ol>
<pre><code class="language-sh">sudo ufw allow 3000
</code></pre>
<ol start="6">
<li>
<p>You can now access Grafana at <code>http://&lt;YOUR_IP_ADDRESS&gt;:3000</code>.</p>
</li>
<li>
<p>(<em>Optional step</em>) If you have a registered domain and prefer to use  it with <code>https</code>, give permissions to <a href="https://github.com/ExploreNYM/self-hosted-monitor/blob/main/nginx-certbot.sh"><code>nginx-certbot.sh</code></a> script and run it to setup Nginx and Certbot</p>
</li>
</ol>
<pre><code class="language-sh">chmod +x ~/self-hosted-monitor/nginx-certbot.sh &amp;&amp; ~/self-hosted-monitor/nginx-certbot.sh
</code></pre>
<ol start="8">
<li>Give permissions to <a href="https://github.com/ExploreNYM/self-hosted-monitor/blob/main/prometheus-target.sh"><code>prometheus-target.sh</code></a> script and run it to add a scrape target. This can be run multiple times to add a new server to be monitored via Prometheus/</li>
</ol>
<pre><code class="language-sh">chmod +x ~/self-hosted-monitor/prometheus-target.sh &amp;&amp; ~/self-hosted-monitor/prometheus-target.sh
</code></pre>
<h3 id="the-target-server-the-part-to-be-monitored-setup"><a class="header" href="#the-target-server-the-part-to-be-monitored-setup">The target server (the part to be monitored) setup</a></h3>
<p>If you run a monitoring stack and your node on two different VPS, the steps 9 and 10 need to be done on the VPS with the running node. In case you do it on the same VPS, skip directly to step 11 and continue.</p>
<ol start="9">
<li>Install git</li>
</ol>
<pre><code class="language-sh">apt install git
</code></pre>
<ol start="10">
<li>Clone the repository to <code>~/self-hosted-monitor</code></li>
</ol>
<pre><code class="language-sh">git clone https://github.com/ExploreNYM/self-hosted-monitor ~/self-hosted-monitor
</code></pre>
<ol start="11">
<li>Give permissions to <a href="https://github.com/ExploreNYM/self-hosted-monitor/blob/main/node-exporter.sh"><code>node-exporter.sh</code></a> script and run it to setup Node exporter.</li>
</ol>
<pre><code class="language-sh">chmod +x ~/self-hosted-monitor/node-exporter.sh &amp;&amp; ~/self-hosted-monitor/node-exporter.sh
</code></pre>
<h3 id="grafana-dashboard-setup"><a class="header" href="#grafana-dashboard-setup">Grafana dashboard setup</a></h3>
<p>Finally we need to access Grafana dashboards.</p>
<ol start="12">
<li>
<p>Open a browser at <code>http://&lt;YOUR_IP_ADDRESS&gt;:3000</code> or <code>https://&lt;YOUR_DOMAIN&gt;</code> (depends on your setup), enter username <code>admin</code> and password <code>admin</code> and setup new credentials on prompt</p>
</li>
<li>
<p>Setup <em>Data source</em> by opening menu -&gt; <code>Connections</code> -&gt; <code>Data sources</code> -&gt; <code>+ Add new data source</code> -&gt; <code>Prometheus</code></p>
</li>
</ol>
<p><img src="testing/../images/grafana/add-data-sources.png" alt="" />
<img src="testing/../images/grafana/add-data-source-prometheus.png" alt="" /></p>
<ol start="14">
<li>
<p>In the field <em>Connection</em> next to <code>Prometheus server URL</code> enter <code>http://localhost:9090</code> (regardless if you accessing Grafana via <code>http</code> or <code>https</code> as this is for internal connection on the server). When you are done in the bottom confirm by <code>Save &amp; Test</code></p>
</li>
<li>
<p>In the menu open: <code>Dashboards</code> -&gt; <code>+ Create dashboard</code> -&gt; <code>Import dashboard</code></p>
</li>
</ol>
<p><img src="testing/../images/grafana/import-dashboard.png" alt="" /></p>
<ol start="16">
<li>ID field: enter <code>1860</code> -&gt; <code>Load</code></li>
</ol>
<p><img src="testing/../images/grafana/id-1860.png" alt="" /></p>
<ol start="17">
<li>In <em>Import dashboard</em> page select Prometheus in the bottom and finally <code>Import</code></li>
</ol>
<p><img src="testing/../images/grafana/add-prometheus.png" alt="" /></p>
<p>Now you have your Prometheus panels displayed via Grafana dashboard for a simple monitoring of your node.</p>
<h2 id="verification-and-troubleshooting"><a class="header" href="#verification-and-troubleshooting">Verification and Troubleshooting</a></h2>
<p>To ensure that your services are running correctly, you can verify that by running <code>systemctl status &lt;SERVICE&gt;</code> or run a <code>journalctl -f -u &lt;SERVICE&gt;</code> to print service logs. It shall return status <code>Active: active (running)</code>. For example:</p>
<pre><code class="language-sh"># to check if Prometheus service is active
systemctl status prometheus

# to check if Grafana service is active
systemctl status grafana-server

# to check if node-exporter service is active
systemctl status node_exporter

# to run journal log
journalctl -f -u prometheus # or any other service you want to see
</code></pre>
<footer id="last-change">Last change: 2024-03-28, commit: <a href="https://github.com/nymtech/nym/commit/6fc4a06b3">6fc4a06b3</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="troubleshooting-vps-setup"><a class="header" href="#troubleshooting-vps-setup">Troubleshooting VPS Setup</a></h1>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="troubleshooting/vps-isp.html#admonition-info"></a>
</div>
<div>
<p>To monitor the connectivity of your Exit Gateway, use results of probe testing displayed in <a href="https://harbourmaster.nymtech.net">harbourmaster.nymtech.net</a>.</p>
</div>
</div>
<h2 id="ipv6-troubleshooting"><a class="header" href="#ipv6-troubleshooting">IPv6 troubleshooting</a></h2>
<h3 id="incorrect-gateway-network-check"><a class="header" href="#incorrect-gateway-network-check">Incorrect Gateway Network Check</a></h3>
<p>Nym operators community is working on a Nym version of tors <a href="https://community.torproject.org/relay/community-resources/good-bad-isps/">good bad ISP table</a>. There is no one solution fits all when it comes to connectivity setup. The operation of <code>nym-node</code> will vary depending on your ISP and chosen system/distribution.  While few machines will work out of the box, most will work after uisng our connectivity configuration guide, some need more adjustments.</p>
<p>Begin with the steps listed in <a href="troubleshooting/../nodes/vps-setup.html#connectivity-test-and-configuration"><em>Connectivity Test and Configuration</em></a> chapter of VPS Setup page. If you still have a problem with the IPv6 connectivity try:</p>
<ol>
<li>Tor community created a helpful <a href="https://community.torproject.org/relay/community-resources/good-bad-isps/">table of ISPs</a>. Make sure your one is listed there as a <em>“good ISP”</em>. If not, consider migrating!</li>
<li>Checkout your VPS dashboard and make sure your IPv6-public enabled.</li>
<li>If you are able to add IPv6 address <code>/64</code> range, do it.</li>
</ol>
<p><strong>Update:</strong> Nym community started an ISP table called <a href="troubleshooting/../legal/isp-list.html"><em>Where to host your nym node?</em></a>, check it out and add your findings!</p>
<p><img src="troubleshooting/../images/ipv6_64.png" alt="" /></p>
<ol start="4">
<li>Search or ask your ISP for additional documentation related to IPv6 routing and ask them to provide you with <code>IPv6 IP address</code> and <code>IPv6 IP gateway address</code></li>
</ol>
<ul>
<li>For example Digital Ocean setup isn’t the most straight forward, but it’s <a href="https://docs.digitalocean.com/products/networking/ipv6/how-to/enable/#on-existing-droplets">well documented</a> and it works.</li>
</ul>
<ol start="5">
<li>Search for guides regarding your particular system and distribution. For Debian based distributions using systemd, some generic guides such as <a href="https://cloudzy.com/blog/configure-ipv6-on-ubuntu/">this one</a> or <a href="https://help.ovhcloud.com/csm/en-ie-vps-configuring-ipv6?id=kb_article_view&amp;sysparm_article=KB0047567">this one</a> work as well.</li>
</ol>
<h3 id="network-configuration"><a class="header" href="#network-configuration">Network configuration</a></h3>
<p>On modern Debian based Linux distributions, the network is configured by either <a href="https://netplan.io/">Netplan</a> or <a href="https://manpages.debian.org/testing/ifupdown/ifup.8.en.html">ifup/ifdown</a> utilities . It is very easy to check which one you have.</p>
<ol>
<li>If you have the following folder <code>/etc/netplan</code> which has got a YAML file - you are likely to have Netplan.</li>
<li>If you have the following folder <code>/etc/network</code> and it is not empty - you are likely to have ifup/down.</li>
</ol>
<p>Most contemporary Ubuntu/Debian distributions come with Netplan, however it is possible that your hosting provider is using a custom version of ISO. For example, Debian 12 (latest version as of June 2024) may come with ifup/down.</p>
<p>Nym operator community members have tested a VPS with Netplan and where in some cases <code>nym-node --mode exit-gateway</code> was not routing IP packets properly even after running <code>network_tunnel_manager.sh</code> script. We are working on a guide to setup Netplan configuration manually for such cases.</p>
<p>Configuration of ifup/ifdown is a bit simpler. If the <code>network_tunnel_manager.sh</code> script doesn’t do the job, open <code>/etc/network/interfaces</code> file (research if your system uses a different naming for it) and configure it similarly to this:</p>
<pre><code class="language-sh">auto lo
iface lo inet loopback

auto eth0
iface eth0 inet static
address &lt;YOUR_IPV4_ADDRESS&gt;
netmask NETMASK

gateway &lt;YOUR_IPV4_GATEWAY&gt;
iface eth0 inet6 static
        accept_ra 0
        address &lt;YOUR_IPV6_ADDRESS&gt;
        netmask 64
        gateway &lt;YOUR_IPV6_GATEWAY&gt;
post-up /sbin/ip -r route add &lt;YOUR_IPV6_GATEWAY&gt; dev eth0
post-up /sbin/ip -r route add default via &lt;YOUR_IPV6_GATEWAY&gt;
</code></pre>
<p>Last two lines are particularly important as they enable IPv6 routing. You can find YOUR_IPV6_GATEWAY using your server’s control panel. There is no single way to find the gateway, so please access your control panel to find yours or open a support ticket. Here is an example of how it looks on <a href="https://help.ovhcloud.com/csm/en-ie-vps-configuring-ipv6?id=kb_article_view&amp;sysparm_article=KB0047567">OVH</a>.</p>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>WARNING</p>
</div>
<a class="admonition-anchor-link" href="troubleshooting/vps-isp.html#admonition-warning"></a>
</div>
<div>
<p>Be extra careful editing this file since you may lock yourself out of the server. If it happens, you can always access the server via the hoster’s VNC panel.</p>
</div>
</div>
<p>Once finished, save the file and reboot the server. Now, running <code>ip a</code> command should return correct IPv4 and IPv6 addresses.</p>
<p>Finally re-run <code>network_tunnel_manager.sh</code> script, following the steps in node <a href="troubleshooting/../nodes/configuration.html#ipv6-configuration">IPv6 configuration chapter</a>.</p>
<h2 id="other-vps-troubleshooting"><a class="header" href="#other-vps-troubleshooting">Other VPS troubleshooting</a></h2>
<h3 id="virtual-ips-and-hosting-via-google--aws"><a class="header" href="#virtual-ips-and-hosting-via-google--aws">Virtual IPs and hosting via Google &amp; AWS</a></h3>
<p>For true internet decentralization we encourage operators to use diverse VPS providers instead of the largest companies offering such services. If for some reasons you have already running AWS or Google and want to setup a <code>&lt;NODE&gt;</code> there, please read the following.</p>
<p>On some services (AWS, Google, etc) the machine’s available bind address is not the same as the public IP address. In this case, bind <code>--host</code> to the local machine address returned by <code>$(curl -4 https://ifconfig.me)</code>, but that may not the public IP address to bond your <code>&lt;NODE&gt;</code> in the wallet.</p>
<p>You can run <code>ifconfig</code> command. For example, on a Google machine, you may see the following output:</p>
<pre><code class="language-sh">ens4: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1460
        inet 10.126.5.7  netmask 255.255.255.255  broadcast 0.0.0.0
        ...
</code></pre>
<p>The <code>ens4</code> interface has the IP <code>10.126.5.7</code>. But this isn’t the public IP of the machine, it’s the IP of the machine on Google’s internal network. Google uses virtual routing, so the public IP of this machine is something else, maybe <code>36.68.243.18</code>.</p>
<p>To find the right IP configuration, contact your VPS provider for support to find the right public IP and use it to bond your <code>&lt;NODE&gt;</code> with the <code>nym-api</code> via Nym wallet.</p>
<p>On self-hosted machine it’s a bit more tricky. In that case as an operator you must be sure that your ISP allows for public IPv4 and IPv6 and then it may be a bit of playing around to find the right configuration. One way may be to bind your binary with the <code>--host</code> flag to local address <code>127.0.0.1</code> and run <code>echo "$(curl -4 https://ifconfig.me)"</code> to get a public address which you use to bond your Mix Node to <code>nym-api</code> via Nym wallet.</p>
<p>It’s up to you as a node operator to ensure that your public and private IPs match up properly.</p>
<h3 id="pruning-logs"><a class="header" href="#pruning-logs">Pruning Logs</a></h3>
<p>Running a <code>nym-node</code> as a standalone process or wrapped in a service can produce gigabytes of logs. Eventually your operation can malfunction due to the logs chewing up too much disk space or memory. Below are two scripts that can help you clean this up.</p>
<div id="admonition-warning-1" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-1-title">
<div class="admonition-title">
<div id="admonition-warning-1-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="troubleshooting/vps-isp.html#admonition-warning-1"></a>
</div>
<div>
<p><code>rm</code> is a powerful tool, without an easy way of revoking. If you need to extract or backup anything, do it now. Make sure you understand what you removing before you execute these commands.</p>
</div>
</div>
<pre><code class="language-sh"># I WANT TO SEE WHATS EATING ALL MY DISKSPACE
sudo find /var -type f -printf "%s\t%p\n" | sort -n -r | head -n 20 | ls -lh
sudo find /var -type f -exec ls -lh {} + 2&gt;/dev/null | sort -k 5 -n -r | head -n 20

sudo du -h --max-depth=1 /var
sudo du -h /var/log

#PRUNE THOSE LOGS
sudo rm -f /var/log/syslog.1
sudo rm -f /var/log/syslog
journalctl --disk-usage
sudo journalctl --vacuum-time=3d
sudo journalctl --vacuum-size=50M

#ENFORCE LOG ROTATION
sudo logrotate --force /etc/logrotate.conf
sudo service rsyslog restart

# REMOVE ALL THOSE OLD PACKAGES...
sudo apt-get clean
sudo apt-get autoremove

sudo apt-get clean
sudo rm -rf /var/lib/apt/lists/*
sudo apt-get update

for snap in $(sudo snap list --all | awk '/disabled/{print $1, $3}'); do
    sudo snap remove $snap
done
</code></pre>
<footer id="last-change">Last change: 2024-08-06, commit: <a href="https://github.com/nymtech/nym/commit/7e36595d8">7e36595d8</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nym-node-troubleshooting"><a class="header" href="#nym-node-troubleshooting">Nym Node Troubleshooting</a></h1>
<h2 id="binary-build-problems"><a class="header" href="#binary-build-problems">Binary Build Problems</a></h2>
<h3 id="i-am-trying-to-build-from-the-github-archive-files-and-the-build-fails"><a class="header" href="#i-am-trying-to-build-from-the-github-archive-files-and-the-build-fails">I am trying to build from the GitHub archive files and the build fails</a></h3>
<p>GitHub automatically includes .zip and tar.gz files of the Nym repository in its release. You cannot extract these and build - you’ll see something like this:</p>
<pre><code>  process didn't exit successfully: `/build/nym/src/nym-0.12.1/target/release/build/nym-socks5-client-c1d0f76a8c7d7e9a/build-script-build` (exit status: 101)
  --- stderr
  thread 'main' panicked at 'failed to extract build metadata: could not find repository from '/build/nym/src/nym-0.12.1/clients/socks5'; class=Repository (6); code=NotFound (-3)', clients/socks5/build.rs:7:31
  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
warning: build failed, waiting for other jobs to finish...
error: build failed
</code></pre>
<p>Why does this happen?</p>
<p>We have scripts which automatically include the Git commit hash and Git tag in the binary for easier debugging later. If you download a .zip and try building from that, it’s not a Git repository and build will fail as above.</p>
<p>What to do?</p>
<ul>
<li>Open terminal in the directory where you want to have a git repository</li>
<li>To get Nym repository for the first time, run:</li>
</ul>
<pre><code>git clone https://github.com/nymtech/nym.git
</code></pre>
<ul>
<li>Follow the instructions to build the platform</li>
<li>To upgrade, pause your nodes, in the same terminal window run <code>git pull</code>, follow the upgrade instructions and re-start your nodes.</li>
</ul>
<h2 id="general-node-config"><a class="header" href="#general-node-config">General Node Config</a></h2>
<h3 id="where-can-i-find-my-private-and-public-keys-and-config"><a class="header" href="#where-can-i-find-my-private-and-public-keys-and-config">Where can I find my private and public keys and config?</a></h3>
<p>All config and keys files are stored in a directory named after your <code>id</code> which you chose during the <code>init</code> process, and can be found at the following PATH: <code>$HOME/.nym/&lt;NODE_TYPE&gt;/&lt;NODE_ID&gt;</code> where <code>$HOME</code> is a home directory of the user (your current user in this case) that launched the node or client.</p>
<p>The directory structure for each node will be roughly as follows:</p>
<pre><code>bob@desktop:~/nym/target/release# tree ~/.nym/nym-nodes/
~/.nym/nym-nodes/
└── default-nym-node
    ├── config
    │   └── config.toml
    └── data
        ├── aes128ctr_ipr_ack
        ├── aes128ctr_nr_ack
        ├── clients.sqlite
        ├── cosmos_mnemonic
        ├── description.toml
        ├── ed25519_identity
        ├── ed25519_identity.pub
        ├── ed25519_ipr_identity
        ├── ed25519_ipr_identity.pub
        ├── ed25519_nr_identity
        ├── ed25519_nr_identity.pub
        ├── ipr_gateways_info_store.sqlite
        ├── nr_gateways_info_store.sqlite
        ├── nr_persistent_reply_store.sqlite
        ├── x25519_ipr_dh
        ├── x25519_ipr_dh.pub
        ├── x25519_noise
        ├── x25519_noise.pub
        ├── x25519_nr_dh
        ├── x25519_nr_dh.pub
        ├── x25519_sphinx
        └── x25519_sphinx.pub
</code></pre>
<blockquote>
<p>If you <code>cat</code> the <code>public_sphinx.pem</code> key, the output will be different from the public key you will see on Nym <a href="https://sandbox-explorer.nymtech.net/">dashboard</a>. The reason for this is that <code>.pem</code> files are encoded in <strong>base64</strong>, however on the web they are in <strong>base58</strong>. Don’t be confused if your keys look different. They are the same keys, just with different encoding :)</p>
</blockquote>
<h2 id="mixnode-mode"><a class="header" href="#mixnode-mode">Mixnode Mode</a></h2>
<h3 id="how-can-i-tell-my-node-is-up-and-running-and-mixing-traffic"><a class="header" href="#how-can-i-tell-my-node-is-up-and-running-and-mixing-traffic">How can I tell my node is up and running and mixing traffic?</a></h3>
<p>First of all check the ‘Mixnodes’ section of either of the Nym Network Explorers:</p>
<ul>
<li><a href="https://explorer.nymtech.net/">Mainnet</a></li>
<li><a href="https://sandbox-explorer.nymtech.net/">Sandbox testnet</a></li>
</ul>
<p>Enter your <strong>identity key</strong> to find your node. Check the contents of the <code>Mixnode stats</code> and <code>Routing score</code> sections.</p>
<p>There are 2 community explorers currently, which have been created by <a href="https://nodes.guru">Nodes Guru</a>:</p>
<ul>
<li><a href="https://mixnet.explorers.guru/">Mainnet</a></li>
<li><a href="https://sandbox.mixnet.explorers.guru/">Sandbox testnet</a></li>
</ul>
<p>You can run <a href="troubleshooting/../testing/node-api-check.html">Node API Check CLI</a> to query all API endpoints of your node at once.</p>
<p><a href="https://github.com/cosmos/chain-registry/blob/master/nyx/chain.json#L158-L187">Here</a> is a dictionary with Nyx chain registry entry regarding all explorers.</p>
<p>If you want more information, or if your node isn’t showing up on the explorer of your choice and you want to double-check, here are some examples on how to check if the node is configured properly.</p>
<h4 id="check-from-your-vps"><a class="header" href="#check-from-your-vps">Check from your VPS</a></h4>
<p>Additional details can be obtained via various methods after you connect to your VPS:</p>
<h5 id="socket-statistics-with-ss"><a class="header" href="#socket-statistics-with-ss">Socket statistics with <code>ss</code></a></h5>
<pre><code>sudo ss -s -t | grep 1789 # if you have specified a different port in your Mix Node config, change accordingly
</code></pre>
<p>This command should return a lot of data containing <code>ESTAB</code>. This command should work on every unix based system.</p>
<h5 id="list-open-files-and-reliant-processes-with-lsof"><a class="header" href="#list-open-files-and-reliant-processes-with-lsof">List open files and reliant processes with <code>lsof</code></a></h5>
<pre><code># check if lsof is installed:
lsof -v
# install if not installed
sudo apt install lsof
# run against nym-mix-node node port
sudo lsof -i TCP:1789 # if you have specified a different port in your mixnode config, change accordingly
</code></pre>
<p>This command should return something like this:</p>
<pre><code>nym-node 103349 root   53u  IPv6 1333229972      0t0  TCP [2a03:b0c0:3:d0::ff3:f001]:57844-&gt;[2a01:4f9:c011:38ae::5]:1789 (ESTABLISHED)
nym-node 103349 root   54u  IPv4 1333229973      0t0  TCP nym:57104-&gt;194.5.78.73:1789 (ESTABLISHED)
nym-node 103349 root   55u  IPv4 1333229974      0t0  TCP nym:48130-&gt;static.236.109.119.168.clients.your-server.de:1789 (ESTABLISHED)
nym-node 103349 root   56u  IPv4 1333229975      0t0  TCP nym:52548-&gt;vmi572614.contaboserver.net:1789 (ESTABLISHED)
nym-node 103349 root   57u  IPv6 1333229976      0t0  TCP [2a03:b0c0:3:d0::ff3:f001]:43244-&gt;[2600:1f18:1031:2401:c04b:2f25:ca79:fef3]:1789 (ESTABLISHED)
</code></pre>
<h5 id="query-systemd-journal-with-journalctl"><a class="header" href="#query-systemd-journal-with-journalctl">Query <code>systemd</code> journal with <code>journalctl</code></a></h5>
<pre><code class="language-sh">sudo journalctl -u nym-node -o cat | grep "Since startup mixed"
</code></pre>
<p>If you have created <code>nym-node.service</code> file (i.e. you are running your Ny, Node via <code>systemd</code>) then this command shows you how many packets have you mixed so far, and should return a list of messages like this:</p>
<pre><code class="language-sh">2021-05-18T12:35:24.057Z INFO  nym_node::node::metrics                      &gt; Since startup mixed 233639 packets!
2021-05-18T12:38:02.178Z INFO  nym_node::node::metrics                      &gt; Since startup mixed 233739 packets!
2021-05-18T12:40:32.344Z INFO  nym_node::node::metrics                      &gt; Since startup mixed 233837 packets!
2021-05-18T12:46:08.549Z INFO  nym_node::node::metrics                      &gt; Since startup mixed 234081 packets!
2021-05-18T12:56:57.129Z INFO  nym_node::node::metrics                      &gt; Since startup mixed 234491 packets!
</code></pre>
<p>You can add <code> | tail</code> to the end of the command to watch for new entries in real time if needed.</p>
<h5 id="build-info"><a class="header" href="#build-info">build-info</a></h5>
<p>A <code>build-info</code> command prints the build information like commit hash, rust version, binary version just like what command <code>--version</code> does. However, you can also specify an <code>--output=json</code> flag that will format the whole output as a json, making it an order of magnitude easier to parse.</p>
<p>For example <code>./target/debug/nym-node --no-banner build-info --output json</code> will return:</p>
<pre><code class="language-sh">{"binary_name":"nym-network-requester","build_timestamp":"2023-07-24T15:38:37.00657Z","build_version":"1.1.23","commit_sha":"c70149400206dce24cf20babb1e64f22202672dd","commit_timestamp":"2023-07-24T14:45:45Z","commit_branch":"feature/simplify-cli-parsing","rustc_version":"1.71.0","rustc_channel":"stable","cargo_profile":"debug"}
</code></pre>
<h4 id="check-from-your-local-machine"><a class="header" href="#check-from-your-local-machine">Check from your local machine</a></h4>
<h5 id="scan-ports-with-nmap"><a class="header" href="#scan-ports-with-nmap">Scan ports with <code>nmap</code>:</a></h5>
<pre><code class="language-sh">nmap -p 1789 &lt;IP ADDRESS&gt; -Pn
</code></pre>
<p>If your Nym Node is configured properly it should output something like this:</p>
<pre><code class="language-sh">bob@desktop:~$ nmap -p 1789 95.296.134.220 -Pn

Host is up (0.053s latency).

PORT     STATE SERVICE
1789/tcp open  hello
</code></pre>
<h5 id="check-with-telnet"><a class="header" href="#check-with-telnet">Check with <code>telnet</code></a></h5>
<p>Your node should connect to telnet when running:</p>
<pre><code class="language-sh">telnet &lt;IP_ADDRESS&gt; &lt;PORT&gt;
</code></pre>
<h5 id="query-online-nodes"><a class="header" href="#query-online-nodes">Query online nodes:</a></h5>
<pre><code class="language-sh">curl --location --request GET 'https://validator.nymtech.net/api/v1/mixnodes/'
</code></pre>
<p>Will return a list all nodes currently online.</p>
<p>You can query Gateways by replacing <code>nym-mixnodes</code> with <code>nym-gateways</code> in the above command, and can query for the Mix Nodes and Gateways on the Sandbox testnet by replacing <code>validator</code> with <code>sandbox-validator</code>.</p>
<h4 id="check-with-network-api"><a class="header" href="#check-with-network-api">Check with Network API</a></h4>
<p>We currently have an API set up returning our metrics tests of the network. There are two endpoints to ping for information about your Mix Node, <code>report</code> and <code>history</code>. Find more information about this in the <a href="troubleshooting/../nodes/maintenance.html#metrics--api-endpoints">Mixnodes metrics documentation</a>.</p>
<p>For more information about available endpoints and their status, you can refer to:</p>
<pre><code class="language-sh"># for http
http://&lt;IP&gt;:8080/api/v1/swagger/#/

# for https reversed proxy
https://&lt;DOMAIN&gt;/api/v1/swagger/#/
</code></pre>
<h3 id="why-is-my-node-not-mixing-any-packets"><a class="header" href="#why-is-my-node-not-mixing-any-packets">Why is my node not mixing any packets?</a></h3>
<p>If you are still unable to see your node on the dashboard, or your node is declaring it has not mixed any packets, there are several potential issues:</p>
<ul>
<li>The firewall on your host machine is not configured properly. Checkout the <a href="troubleshooting/../nodes/vps-setup.html#configure-your-firewall">instructions</a>.</li>
<li>You provided incorrect information when bonding your node.</li>
<li>You are running your node from a VPS without IPv6 support.</li>
<li>You did not configure your router firewall while running the node from your local machine behind NAT, or you are lacking IPv6 support</li>
<li>Your Mix Node is not running at all, it has either exited / panicked or you closed the session without making the node persistent. Check out the <a href="troubleshooting/../nodes/configuration.html#automating-your-node-with-tmux-and-systemd">instructions</a>.</li>
</ul>
<div id="admonition-default" class="admonition admonish-warning" role="note">
<div>
<p>Your Nym Node <strong>must speak both IPv4 and IPv6</strong> in order to cooperate with other nodes and route traffic. This is a common reason behind many errors we are seeing among node operators, so check with your provider that your VPS is able to do this!</p>
</div>
</div>
<h4 id="check-ipv6-connectivity"><a class="header" href="#check-ipv6-connectivity">Check IPv6 Connectivity</a></h4>
<p>You can always check IPv6 address and connectivity by using some of these methods:</p>
<pre><code class="language-sh"># locally listed IPv6 addresses
ip -6 addr

# globally reachable IPv6 addresses
ip -6 addr show scope global

# with DNS
dig -6 TXT +short o-o.myaddr.l.google.com @ns1.google.com
dig -t aaaa +short myip.opendns.com @resolver1.opendns.com

# https check
curl -6 https://ifconfig.co
curl -6 https://ipv6.icanhazip.com

# using telnet
telnet -6 ipv6.telnetmyip.com
</code></pre>
<p>If your connection doesn’t work make sure to follow <a href="troubleshooting/../nodes/configuration.html#connectivity-test-and-configuration">VPS IPv6 setup</a>. If there is more troubleshooting needed, check out <a href="troubleshooting/vps-isp.html#ipv6-troubleshooting">VPS IPv6 troubleshooting</a> page.</p>
<h4 id="incorrect-bonding-information"><a class="header" href="#incorrect-bonding-information">Incorrect bonding information</a></h4>
<p>Check that you have provided the correct information when bonding your Nym Node in the web wallet interface. When in doubt, un-bond and then re-bond your node!</p>
<blockquote>
<p>All delegated stake will be lost when un-bonding! However the Nym Node must be operational in the first place for the delegation to have any effect.</p>
</blockquote>
<h3 id="running-on-a-local-machine-behind-nat-with-no-fixed-ip-address"><a class="header" href="#running-on-a-local-machine-behind-nat-with-no-fixed-ip-address">Running on a local machine behind NAT with no fixed IP address</a></h3>
<p>Your ISP has to be IPv6 ready if you want to run a Nym Node on your local machine. Sadly, in 2020, most of them are not and you won’t get an IPv6 address by default from your ISP. Usually it is an extra paid service or they simply don’t offer it.</p>
<p>Before you begin, check if you have IPv6 <a href="https://test-ipv6.cz/">here</a> or by running command explained in the <a href="troubleshooting/nodes.html#no-ipv6-connectivity">section above</a>. If not, then don’t waste your time to run a node which won’t ever be able to mix any packet due to this limitation. Call your ISP and ask for IPv6, there is a plenty of it for everyone!</p>
<p>If all goes well and you have IPv6 available, then you will need to <code>init</code> the Nym Node with an extra flag, <code>--announce-host</code>. You will also need to edit your <code>config.toml</code> file each time your IPv4 address changes, that could be a few days or a few weeks. Check the your IPv4 in the <a href="troubleshooting/nodes.html#no-ipv6-connectivity">section above</a>.</p>
<p>Additional configuration on your router might also be needed to allow traffic in and out to port 1789 and IPv6 support.</p>
<ul>
<li>
<p><code>--host 0.0.0.0</code> should work every time even if your local machine IPv4 address changes. For example on Monday your router gives your machine an address <code>192.168.0.13</code> and on Wednesday, the <a href="https://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol">DHCP</a> lease will end and you will be assigned <code>192.168.0.14</code>. Using <code>0.0.0.0</code> should avoid this without having to set any static IP in your router’s configuration.</p>
</li>
<li>
<p>you can get your current IPv4 address by either using <code>curl ipinfo.io</code> if you’re on MacOS or Linux or visiting <a href="https://www.whatsmyip.org/">whatsmyip site</a>. Simply copy it and use it as <code>--anounce-host</code> address.</p>
</li>
</ul>
<p>Make sure you check if your node is really mixing. We are aiming to improve the setup for operators running locally, however you may need a bit of patience to set this up from your home behind NAT.</p>
<h3 id="accidentally-killing-your-node-process-on-exiting-session"><a class="header" href="#accidentally-killing-your-node-process-on-exiting-session">Accidentally killing your node process on exiting session</a></h3>
<p>When you close your current terminal session, you need to make sure you don’t kill the Mix Node process! There are multiple ways on how to make it persistent even after exiting your ssh session, the easiest solution is to use <code>tmux</code> or <code>nohup</code>, and the more elegant solution is to run the node with <code>systemd</code>. Read the automation manual <a href="troubleshooting/../nodes/configuration.html#automating-your-node-with-tmux-and-systemd">here</a>.</p>
<h3 id="common-errors-and-warnings"><a class="header" href="#common-errors-and-warnings">Common errors and warnings</a></h3>
<p>Most of the <code>ERROR</code> and <code>WARN</code> messages in your node logs are benign - as long as your node outputs <code>since startup mixed X packets!</code> (<code>X</code> bust be &gt; 0) in your logs (and this number increases over time), your node is mixing packets. If you want to be sure, check the Nym <a href="https://sandbox-explorer.nymtech.net/">dashboard</a> or see other ways on how to check if your node is mixing properly as outlined in the section <a href="troubleshooting/nodes.html#how-can-i-tell-my-node-is-up-and-running-and-mixing-traffic?"><strong>How can I tell my node is up and running and mixing traffic?</strong></a> above.</p>
<p>More specific errors and warnings are covered below.</p>
<h3 id="what-is-verloc-and-do-i-have-to-configure-my-nym-node-to-implement-it"><a class="header" href="#what-is-verloc-and-do-i-have-to-configure-my-nym-node-to-implement-it">What is <code>verloc</code> and do I have to configure my Nym Node to implement it?</a></h3>
<p><code>verloc</code> is short for <em>verifiable location</em>. Mix Nodes and Gateways now measure speed-of-light distances to each other, in an attempt to verify how far apart they are. In later releases, this will allow us to algorithmically verify node locations in a non-fake-able and trustworthy manner.</p>
<p>You don’t have to do any additional configuration for your node to implement this, it is a passive process that runs in the background of the mixnet from version <code>0.10.1</code> onward.</p>
<h2 id="gateways-mode"><a class="header" href="#gateways-mode">Gateways Mode</a></h2>
<h3 id="my-exit-gateway-is-running-but-appears-offline-in-the-explorer"><a class="header" href="#my-exit-gateway-is-running-but-appears-offline-in-the-explorer">My <code>exit-gateway</code> is running but appears offline in the explorer</a></h3>
<p>Let your Gateway run and follow these steps:</p>
<ol>
<li>Check if your <a href="troubleshooting/../nodes/vps-setup.html#configure-your-firewall">firewall configuration</a> is active and if the necessary ports are open / allowed, including the ones for Swagger page and Reversed proxy/WSS if this is your case.</li>
<li>See if the Gateway is not on the <a href="https://validator.nymtech.net/api/v1/gateways/blacklisted">list of blacklisted Gateways</a></li>
<li>If it’s blacklisted, check out the <a href="troubleshooting/nodes.html#my-gateway-is-blacklisted">point below</a></li>
</ol>
<h3 id="my-gateway-is-blacklisted"><a class="header" href="#my-gateway-is-blacklisted">My Gateway is blacklisted</a></h3>
<p>Nym API measures performance by routing traffic through the Mixnet. If the average of a Gateway’s routing score in past 24h is less than 50%, the Gateway gets blacklisted and it remains so until its performance is higher than 50%.</p>
<p>In case your Gateway appeared on the <a href="https://validator.nymtech.net/api/v1/gateways/blacklisted">blacklist</a>, it’s because there is some flaw in the configuration. The most common sources of problems are:</p>
<ul>
<li>Outdated version of <code>nym-node</code></li>
<li>Bonding before starting the node/service</li>
<li>Bonding before opening <a href="troubleshooting/../nodes/vps-setup.html#configure-your-firewall">needed ports</a></li>
<li>VPS restarted without operator having a <a href="troubleshooting/../nodes/configuration.html#systemd">systemd automation</a> or some alert notification flow setup (so the operator doesn’t know the node was stopped)</li>
<li>IP address or host is incorrectly configured</li>
<li>Process logs grew too big</li>
<li>Node is wrapped in <a href="troubleshooting/../nodes/configuration.html#systemd">systemd service</a> and the operator forgot to run <code>systemctl daemon-reload</code> after last changes</li>
</ul>
<p><strong>What to do</strong></p>
<p>Begin with a sanity check by opening <a href="https://harbourmaster.nymtech.net">harbourmaster.nymtech.net</a> and check your node there. To query all API endpoints of your node at once, you can run <a href="troubleshooting/../testing/node-api-check.html">Node API Check CLI</a>. To see IPv4 and IPv6 routing in real time (harbourmaster can have a cache up to 90 min), run <a href="troubleshooting/../testing/gateway-probe.html">Gateway Probe CLI</a>.</p>
<p>Then follow these steps:</p>
<ol>
<li>Make sure your node is on the <a href="troubleshooting/../changelog.html">latest version</a> and it’s running . Do <em>not</em> stop it if there is no need!</li>
<li>Open all <a href="troubleshooting/../nodes/vps-setup.html#configure-your-firewall">needed ports</a></li>
<li>Check your <code>config.toml</code> - often people have filled <code>hostname</code> without the domain being registered to <code>nym-node</code> IP, or a wrong IP address after moving their node.</li>
<li><a href="troubleshooting/nodes.html#check-gateway-connectivity">Check Gateway Connectivity</a></li>
<li>See logs of your Gateway and search <a href="troubleshooting/nodes.html#nym-node-errors">for errors</a> - if you find any unusual one, you can ask in the <a href="https://matrix.to/#/#operators:nymtech.chat">Element Node Operators</a> channel</li>
</ol>
<ul>
<li>If your logs show that your Node has <code>cover down: 0.00</code> that means that the embedded IPR and NR is not sending any cover traffic.</li>
</ul>
<ol start="6">
<li><a href="troubleshooting/vps-isp.html#pruning-logs">Check out if your <code>syslog</code>s</a> aren’t eating all your disk space and prune them</li>
<li>When all problems are addressed: Restart the node/service (don’t forget <code>systemctl daemon-reload</code>) and wait until your node gets above 50% of performance (average of last 24h) - this will likely take 24-48 hours. During this time your node is tested by <code>nym-api</code> and every positive response picks up your routing score.</li>
<li>If your node doesn’t pick up the routing score within 24h at all and it was running in <code>--mode exit-gateway</code>, run it as <code>--mode entry-gateway</code>. When your node is above 75% performance (past 24h), switch back to <code>--mode exit-gateway</code>.</li>
</ol>
<p><strong>Do not repeatedly restart your Nym Node without reason, your routing score will only get worse!</strong></p>
<h3 id="check-gateway-connectivity"><a class="header" href="#check-gateway-connectivity">Check Gateway connectivity</a></h3>
<p><strong>1. Check out the API endpoints</strong></p>
<p>Start with checking if your Gateway IPR and NR is active. To determine which mode your node is running, you can check the <code>:8080/api/v1/roles</code> endpoint. For example:</p>
<pre><code class="language-sh"># sustitude &lt;NODE_IP_ADDRESS&gt; or &lt;NODE_DOMAIN&gt; with a real one
# for http
http://&lt;NODE_IP_ADDRESS&gt;:8080/api/v1/roles
# or
http://&lt;NODE_IP_ADDRESS&gt;/api/v1/roles

# for reversed proxy/WSS
https://&lt;NODE_DOMAIN&gt;/api/v1/roles
</code></pre>
<p>Everything necessary will exist on your node by default. For instance, if you’re running a mixnode, you’ll find that a NR (Network Requester) and IPR (IP Packet Router) address exist, but they will be ignored in <code>mixnode</code> mode.</p>
<p>For more information about available endpoints and their status, you can refer to:</p>
<pre><code class="language-sh"># sustitude &lt;NODE_IP_ADDRESS&gt; or &lt;NODE_DOMAIN&gt; with a real one
# for http
http://&lt;NODE_IP_ADDRESS&gt;:8080/api/v1/swagger/#/
# or
http://&lt;NODE_IP_ADDRESS&gt;/api/v1/swagger/#/

# for reversed proxy/WSS
https://&lt;NODE_DOMAIN&gt;/api/v1/swagger/#/
</code></pre>
<p><strong>2. Configure IPv4 and IPv6 tables and rules</strong></p>
<ul>
<li>In case you haven’t, follow the steps in the node <a href="troubleshooting/../nodes/configuration.html">configuration</a> chapter <a href="troubleshooting/../nodes/configuration.html#connectivity-test-and-configuration">connectivity test and configurastion</a>.</li>
</ul>
<p><strong>3. Test connectivity</strong></p>
<ul>
<li>Telnet - from your local machine try to connect to your VPS bu running:</li>
</ul>
<pre><code class="language-sh">telnet &lt;IP_ADDRESS&gt; &lt;PORT&gt;
</code></pre>
<ul>
<li><a href="https://github.com/websockets/wscat">Websocket wcat</a>:
<ul>
<li>Install on your local machine:</li>
</ul>
</li>
</ul>
<pre><code class="language-sh">sudo apt install node-ws
</code></pre>
<ul>
<li>Run <code>wscat</code> pointing to the IP of your VPS with port <code>9000</code>:</li>
</ul>
<pre><code>wscat -c ws://&lt;IP&gt;:&lt;PORT&gt;
</code></pre>
<h3 id="my-exit-gateway-is-still-not-online"><a class="header" href="#my-exit-gateway-is-still-not-online">My exit Gateway “is still not online…”</a></h3>
<p>The Nyx chain epoch takes up to 60 min. To prevent the Gateway getting blacklisted, it’s essential to start it before the bonding process and let it running. In case it already got <a href="troubleshooting/nodes.html#my-gateway-is-backlisted">blacklisted</a> check the steps above.</p>
<!-- THIS NEEDS TO BE REWORKED
### When enabling `ip_packet_router` (IPR) I get a `client-core error`

This error tells you that you already have IPR keys in your data storage, to activate them you have two options:

1. Open `~/.nym/nym-nodes/<ID>/config/config.toml` and **set the correct values**
```toml
[ip_packer_router_enabled]
enabled = true

# UNDER [storage_paths] CHANGE
ip_packet_router_config = '~/.nym/nym-nodes/<ID>/config/ip_packet_router_config.toml'
```

2. Or **remove the IPR data storage and initialise a new one** with these commands
```toml
rm -rf ~/.nym/nym-nodes/<ID>/data/ip-packet-router-data

./nym-gateway setup-ip-packet-router --id <ID>
```

### My `ip_packet_router` (IPR) seems to not work

There are a few steps to mitigate problems with IPR:

1. Check out the issue right above regarding the [Exit Gateway config](#when-enabling-ip_packet_router-ipr-i-get-a-client-core-error)
2. Open your browser and checkout the Swagger UI page and see if all the roles are enabled:
```sh
# in case of IP
http://<YOUR_LISTENING_IP_ADDRESS>:8080/api/v1/roles

# in case of hostname domain
https://<YOUR_DOMAIN>/api/v1/roles
```
3. Make sure all your [ports are open](https://nymtech.net/operators/nodes/maintenance.html#configure-your-firewall) properly
4. Make sure to run your Gateway with embedded IPR as root. Either in a root shell with your configs in `/root/.nym/` or with a command `sudo -E` which gives root privileges but looks for user config folder
5. If it's all good in the API but you don't see the right tick/badge in the [Performance testing list](https://nymtech.net/events/fast-and-furious), just wait some time and then try to refresh the page
-->
<footer id="last-change">Last change: 2024-06-27, commit: <a href="https://github.com/nymtech/nym/commit/789914b09">789914b09</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="validators-troubleshooting"><a class="header" href="#validators-troubleshooting">Validators Troubleshooting</a></h1>
<h3 id="common-reasons-for-your-validator-being-jailed-2"><a class="header" href="#common-reasons-for-your-validator-being-jailed-2">Common reasons for your validator being jailed</a></h3>
<p>The most common reason for your validator being jailed is that your validator is out of memory because of bloated syslogs.</p>
<p>Running the command <code>df -H</code> will return the size of the various partitions of your VPS.</p>
<p>If the <code>/dev/sda</code> partition is almost full, try pruning some of the <code>.gz</code> syslog archives and restart your validator process.</p>
<h2 id="where-can-i-get-more-help"><a class="header" href="#where-can-i-get-more-help">Where can I get more help?</a></h2>
<p>The fastest way to reach one of us or get a help from the community, visit our <a href="https://t.me/nymchan_help_chat">Telegram Node Setup Help Chat</a> or head to our <a href="https://nymtech.net/go/discord">Discord</a>.</p>
<p>For more tech heavy question join our <a href="https://matrix.to/#/#general:nymtech.chat">Matrix core community channel</a>, where you can meet other builders and Nym core team members.</p>
<footer id="last-change">Last change: 2024-07-15, commit: <a href="https://github.com/nymtech/nym/commit/3a053b8dd">3a053b8dd</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nyx-validator-rewards"><a class="header" href="#nyx-validator-rewards">Nyx Validator Rewards</a></h1>
<h2 id="summary-1"><a class="header" href="#summary-1">Summary</a></h2>
<ul>
<li>Nyx Validators are rewarded in NYM tokens from the Nym mixmining pool and increasingly from apps that run on the Nym mixnet, the first of which is the NymVPN.</li>
<li>Validators are rewarded for two different types of work: signing blocks in the Nyx chain and running the NymAPI to monitor mixnet routing and sign zk-nym credentials.</li>
<li>New validators can join via a NYM-to-NYX swap contract. The contract will not allow more than 1% of total stake increase per month to prevent sudden hostile takeovers. Current stake is 44.811 million Nyx. Rate: 1:4.8 ~ 288k NYX for 60k NYM =&gt; 0.64% voting power</li>
<li>NYX tokens serve no other purpose than self-delegation for voting power and governance. All rewards are in NYM and distributed directly to the validators self-delegation address and are not distributed to stakers.</li>
<li>The contract will only allow swapping NYM to NYX and will <strong>not</strong> allow exchanging NYX back to NYM. A NYX holder who wishes to sell their NYX stake will have to do so via OTC trades.</li>
</ul>
<h2 id="validator-rewards"><a class="header" href="#validator-rewards">Validator Rewards</a></h2>
<p>Nyx Validators perform two types of work for which they will be rewarded:</p>
<h3 id="1-signing-blocks-in-the-nyx-chain"><a class="header" href="#1-signing-blocks-in-the-nyx-chain">1. Signing blocks in the Nyx chain</a></h3>
<p>A “block signing monitor“ monitors blocks being produced on the Nyx chain and gathers the signatures present on every block. After an epoch ends, the monitor will assess performance of a validator and distribute tokens (to the self-delegation wallet) proportional to the voting period and uptime of the validator.</p>
<h3 id="2-running-the-nymapi-to-monitor-mixnet-routing-and-sign-zk-nyms-nyms-anonymous-credentials"><a class="header" href="#2-running-the-nymapi-to-monitor-mixnet-routing-and-sign-zk-nyms-nyms-anonymous-credentials">2. Running the NymAPI to monitor Mixnet routing and sign zk-nyms (Nym’s anonymous credentials)</a></h3>
<p>Validator rewards initially come from the Nym mixmining pool with additional rewards increasingly coming from paid applications running on the Nym mixnet. The first paid application is the NymVPN. Nyx validators will be rewarded for their work directly in NYM tokens to their validator self-delegation address.</p>
<ol>
<li>
<p><strong>From mixmining pool</strong> - at a rate of 1000 NYM per hour, of which 2/3 are distributed for signing blocks and 1/3 for zk-nyms. These are stable in NYM, and therefore will fluctuate in their fiat value depending on exchange rate.</p>
</li>
<li>
<p><strong>From vpn user subscriptions</strong> - the rate is tied to the growth of NymVPN subscriptions and will be stable in fiat, fluctuating in NYM depending on exchange rate. 1/3 will be distributed for signing blocks and 2/3 for zk-nyms.</p>
</li>
</ol>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Source</th><th style="text-align: right">Signing blocks</th><th style="text-align: right">Running NymAPI</th><th style="text-align: center">Currency</th></tr></thead><tbody>
<tr><td style="text-align: left">Mixmining pool</td><td style="text-align: right">2/3</td><td style="text-align: right">1/3</td><td style="text-align: center">NYM</td></tr>
<tr><td style="text-align: left">NymVPN</td><td style="text-align: right">1/3</td><td style="text-align: right">2/3</td><td style="text-align: center">fiat</td></tr>
</tbody></table>
</div>
<h4 id="zk-nyms"><a class="header" href="#zk-nyms">zk-nyms</a></h4>
<p>The zk-nyms enable people to anonymously prove access rights to the upcoming NymVPN client without having to reveal payment details that might compromise their privacy. This is the first of what we imagine to be many possible use-cases for the zk-nym scheme.</p>
<h3 id="allocation-of-rewards-from-nym-mixmining-pool"><a class="header" href="#allocation-of-rewards-from-nym-mixmining-pool">Allocation of Rewards from Nym mixmining pool</a></h3>
<p>Rewards for validators will be distributed at an hourly rate from the mixmining pool. The amount is 1000 NYM per hour to be distributed among all validators. The fraction of mixmining rewards received by each individual validator is proportional to its contributions to the network.</p>
<p>Two thirds of the available rewards (670 NYM per hour) are distributed proportionally to each validator’s share when signing blocks in the chain, for which tx fees are also received in the same proportion; while the last third (330 NYM per hour) is allocated to validators running the NymAPI, proportionally to their contribution to signing zk-nym credentials.</p>
<p>The rewards are stable in NYM and fluctuate in their fiat value depending on the exchange rate of NYM tokens.</p>
<h2 id="permissionless-nyx-chain"><a class="header" href="#permissionless-nyx-chain">Permissionless Nyx Chain</a></h2>
<p>To allow new validators to join Nyx chain a new smart contract will be set up to release NYX in exchange for NYM. This contract allows a limited amount of NYM tokens to be deposited per month. The deposited NYM tokens are added to the mixmining pool and thus contribute to future rewards of all nodes and validators.</p>
<p>The smart contract will have two parameters:</p>
<ol>
<li>the maximum amount of NYX available for purchase per month</li>
<li>the NYM-to-NYX exchange rate offered by the contract</li>
</ol>
<h3 id="maximum-amount-of-nyx-available-for-purchase-per-month"><a class="header" href="#maximum-amount-of-nyx-available-for-purchase-per-month">Maximum Amount of NYX Available for Purchase per Month</a></h3>
<p>The contract will not allow more than 1% of total stake increase per month to prevent sudden hostile takeovers. Current stake level is 44.811 million Nyx.</p>
<footer id="last-change">Last change: 2024-02-27, commit: <a href="https://github.com/nymtech/nym/commit/cb3e73fbd">cb3e73fbd</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="general-operators-faq"><a class="header" href="#general-operators-faq">General Operators FAQ</a></h1>
<h2 id="nym-mixnet"><a class="header" href="#nym-mixnet">Nym Mixnet</a></h2>
<p>To see different stats about Nym Mixnet live, we recommend you to visit <a href="https://status.notrustverify.ch/d/CW3L7dVVk/nym-mixnet?orgId=1">status.notrustverify.ch</a> built by <a href="https://notrustverify.ch/">No Trust Verify</a> crew, one of the squads within Nym core community.</p>
<iframe src="https://status.notrustverify.ch/d-solo/CW3L7dVVk/nym-mixnet?orgId=1&from=1702215592419&to=1704807592419&panelId=12" width="800" height="400" frameborder="0"></iframe>
<h3 id="is-there-an-explorer-for-nym-mixnet"><a class="header" href="#is-there-an-explorer-for-nym-mixnet">Is there an explorer for Nym Mixnet?</a></h3>
<p>Yes, there are several places, some are built by Nym core community:</p>
<ul>
<li><a href="https://explorer.nymtech.net/">Nym Explorer</a></li>
<li><a href="https://mixnet.explorers.guru/">Guru Explorer</a></li>
<li><a href="https://explorenym.net/">ExploreNYM</a></li>
</ul>
<h3 id="which-vps-providers-would-you-recommend"><a class="header" href="#which-vps-providers-would-you-recommend">Which VPS providers would you recommend?</a></h3>
<p>Consider in which jurisdiction you reside and where do you want to run a Mix Node. Do you want to pay by crypto or not and what are the other important particularities for your case? We always recommend operators to try to choose smaller and decentralised VPS providers over the most known ones controlling a majority of the internet. We receive some good feedback on these: Linode, Gandi, Flokinet and Exoscale. Do your own research and share with the community.</p>
<h3 id="why-is-a-node-setup-on-a-self-hosted-machine-so-tricky"><a class="header" href="#why-is-a-node-setup-on-a-self-hosted-machine-so-tricky">Why is a node setup on a self-hosted machine so tricky?</a></h3>
<p>We don’t recommend this setup because it’s really difficult to get a static IP and route IPv6 traffic.</p>
<h3 id="whats-the-sphinx-packet-size"><a class="header" href="#whats-the-sphinx-packet-size">What’s the Sphinx packet size?</a></h3>
<p>The sizes are shown in the configs <a href="https://github.com/nymtech/nym/blob/1ba6444e722e7757f1175a296bed6e31e25b8db8/common/nymsphinx/params/src/packet_sizes.rs#L12">here</a> (default is the one clients use, the others are for research purposes, not to be used in production as this would fragment the anonymity set). More info can be found <a href="https://github.com/nymtech/nym/blob/4844ac953a12b29fa27688609ec193f1d560c996/common/nymsphinx/anonymous-replies/src/reply_surb.rs#L80">here</a>.</p>
<h3 id="why-a-mix-node-and-a-gateway-cannot-be-bonded-with-the-same-wallet"><a class="header" href="#why-a-mix-node-and-a-gateway-cannot-be-bonded-with-the-same-wallet">Why a Mix Node and a Gateway cannot be bonded with the same wallet?</a></h3>
<p>Because of the way the smart contract works we keep it one-node one-address at the moment.</p>
<h3 id="which-nodes-are-the-most-needed-to-be-setup-to-strengthen-nym-infrastructure-and-which-ones-bring-rewards"><a class="header" href="#which-nodes-are-the-most-needed-to-be-setup-to-strengthen-nym-infrastructure-and-which-ones-bring-rewards">Which nodes are the most needed to be setup to strengthen Nym infrastructure and which ones bring rewards?</a></h3>
<p>Ath this point the most crutial component needed are <a href="faq/../legal/exit-gateway.html">Exit Gateways</a>.</p>
<h3 id="are-nym-nodes-whitelisted"><a class="header" href="#are-nym-nodes-whitelisted">Are Nym Nodes whitelisted?</a></h3>
<p>Nope, anyone can run a Nym Node. whether your node is chosen to mix is purely reliant on the node’s performance and reputation (self stake + delegations).</p>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nym-nodes-related-frequently-asked-questions"><a class="header" href="#nym-nodes-related-frequently-asked-questions">Nym Nodes related Frequently Asked Questions</a></h1>
<h3 id="what-determines-the-rewards-when-running-a-nym-node---mode-mixnode"><a class="header" href="#what-determines-the-rewards-when-running-a-nym-node---mode-mixnode">What determines the rewards when running a <code>nym-node --mode mixnode</code>?</a></h3>
<p>The stake required for a Mix Node to achieve maximum rewards is called Mix Node saturation point. This is calculated from the staking supply (all circulating supply + part of unlocked tokens). The target level of staking is to have 40% of the staking supply locked in Mix Nodes.</p>
<p>The node stake saturation point, which we denote by Nsat, is given by the stake supply, target level of staking divided between the rewarded nodes.</p>
<p>This design ensures the nodes aim to have a same size of stake (reputation) which can be done by delegation staking, as well as it secures a whale prevention and decentralization of staking, as any higher level of delegated $NYM than Nsat per node results in worsening reward ratio. On the contrary, the more Mix Nodes are active, the lower is Nsat. The equilibrium is reached when the staked tokens are delegated equally across the active Mix nodes and that’s our basis for this incentive system.</p>
<!--
<iframe src="https://status.notrustverify.ch/d-solo/CW3L7dVVk/nym-mixnet?orgId=1&from=1703074760986&to=1705666760986&panelId=5" width="800" height="400" frameborder="0"></iframe>
-->
<p>The rewarded nodes are the nodes which will receive some rewards by the end of the given epoch. These can be separated further separated into:</p>
<ol>
<li>
<p>Active: Top <em>N</em> nodes of the rewarded set (currently all of them but this can change), these are nodes which are used by the clients and mix packets.</p>
</li>
<li>
<p>Standby: Bottom <em>N</em> nodes of the rewarded set, they don’t mix data from the clients but are used for testing. Their reward is smaller.</p>
</li>
</ol>
<p>For more detailed calculation, read our blog post <a href="https://blog.nymtech.net/nym-token-economics-update-fedff0ed5267">Nym Token Economics update</a>. More info on staking can be found <a href="https://blog.nymtech.net/staking-in-nym-introducing-mainnet-mixmining-f9bb1cbc7c36">here</a>. And <a href="https://blog.nymtech.net/want-to-stake-in-nym-here-is-how-to-choose-a-mix-node-to-delegate-nym-to-c3b862add165">here</a> is more info on how to choose a Mix Node for delegation. And finally an <a href="https://blog.nymtech.net/quarterly-token-economic-parameter-update-b2862948710f">update</a> on token economics from July 2023.</p>
<!--
<iframe src="https://status.notrustverify.ch/d-solo/CW3L7dVVk/nym-mixnet?orgId=1&from=1703074829887&to=1705666829887&panelId=31" width="850" height="400" frameborder="0"></iframe>
-->
<iframe src="https://dashboard.notrustverify.ch/d-solo/l71MWkX7k/ntv-mixnode?orgId=1&from=1710949572440&to=1713537972440&panelId=18" width="850" height="400" frameborder="0"></iframe>
<p><em>More graphs and stats at <a href="https://status.notrustverify.ch/d/CW3L7dVVk/nym-mixnet?orgId=1&amp;from=1703074861988&amp;to=1705666862004">stats.notrustverify.ch</a>.</em></p>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h2 id="validators-and-tokens"><a class="header" href="#validators-and-tokens">Validators and tokens</a></h2>
<h3 id="whats-the-difference-between-nym-and-unym"><a class="header" href="#whats-the-difference-between-nym-and-unym">What’s the difference between NYM and uNYM?</a></h3>
<p>1 NYM = 1 000 000 uNYM</p>
<!--- Commenting for now as NYX is not publicly out yet
### What's the difference between NYM and NYX?
--->
<h3 id="why-some-nyx-blockchain-operations-take-one-hour-and-others-are-instant"><a class="header" href="#why-some-nyx-blockchain-operations-take-one-hour-and-others-are-instant">Why some Nyx blockchain operations take one hour and others are instant?</a></h3>
<p>This is based on the definition in <a href="https://github.com/nymtech/nym/tree/develop/common/cosmwasm-smart-contracts">Nym’s CosmWasm</a> smart contracts code.</p>
<p>Whatever is defined as <a href="https://github.com/nymtech/nym/blob/b07627d57e075b6de35b4b1a84927578c3172811/common/cosmwasm-smart-contracts/mixnet-contract/src/pending_events.rs#L35-L103">a pending epoch event</a> will get resolved at the end of the current epoch.</p>
<p>And whatever is defined as <a href="https://github.com/nymtech/nym/blob/b07627d57e075b6de35b4b1a84927578c3172811/common/cosmwasm-smart-contracts/mixnet-contract/src/pending_events.rs#L145-L172">a pending interval event</a> will get resolved at the end of the current interval.</p>
<h3 id="can-i-run-a-validator"><a class="header" href="#can-i-run-a-validator">Can I run a validator?</a></h3>
<p>We are currently working towards building up a closed set of reputable validators. You can ask us for coins to get in, but please don’t be offended if we say no - validators are part of our system’s core security and we are starting out with people we already know or who have a solid reputation.</p>
<h3 id="why-is-validator-set-entry-whitelisted"><a class="header" href="#why-is-validator-set-entry-whitelisted">Why is validator set entry whitelisted?</a></h3>
<p>We understand that the early days of the Nyx blockchain will face possible vulnerabilities in terms of size - easy to disrupt or halt the chain if a malicious party entered with a large portion of stake. Besides that, there are some legal issues we need to address before we can distribute the validator set in a fully permissions fashion.</p>
<h3 id="why-does-nym-do-airdrops"><a class="header" href="#why-does-nym-do-airdrops">Why does Nym do airdrops?</a></h3>
<p>It is part of ensuring decentralisation - we need to avoid a handful of people having too much control over the token and market. Of course ideally people will stake the tokens and contribute to the project at this stage. We run surveys to better understand what people are doing with their tokens and what usability issues there are for staking. Any feedback is appreciated as it helps us improve all aspects of using the token and participating in the ecosystem.</p>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="nym-operators-legal-forum-running-exit-gateway"><a class="header" href="#nym-operators-legal-forum-running-exit-gateway">Nym Operators Legal Forum: Running Exit Gateway</a></h1>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="legal/exit-gateway.html#admonition-info"></a>
</div>
<div>
<p>The entire content of this page is under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Public License</a>.</p>
</div>
</div>
<p>This page is a part of Nym Community Legal Forum and its content is composed by shared advices in <a href="https://matrix.to/#/!YfoUFsJjsXbWmijbPG:nymtech.chat?via=nymtech.chat&amp;via=matrix.org">Node Operators Legal Forum</a> (Matrix chat) as well as though pull requests done by the node operators directly to our <a href="https://github.com/nymtech/nym/tree/develop/documentation/operators/src">repository</a>, reviewed by Nym DevRels.</p>
<p>This document presents an initiative to further support Nym’s mission of allowing privacy for everyone everywhere. This would be achieved with the support of Nym node operators operating Gateways and opening these to any online service. Such setup needs a <strong>clear policy</strong>, one which will remain the <strong>same for all operators</strong> running Nym nodes. <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt"><strong>Nym exit policy</strong></a> is a combination of safeguards like (nowadays deprecated) <code>Tor Null deny list</code> and <code>Tor reduced policy</code> together with changes decided by Nym operators community through the governance (like in this <a href="https://forum.nymtech.net/t/poll-a-new-nym-exit-policy-for-exit-gateways-and-the-nym-mixnet-is-inbound/464">vote</a>). This policy aims to find a healthy compromise between protecting the operators and NymVPN users against attacks while allowing for as wide experience when accessing the internet through Nym Network.</p>
<p>All the technical changes on the side of Nym nodes - <em><strong>Project Smoosh</strong></em> - are described in the <a href="legal/../archive/faq/smoosh-faq.html">FAQ section</a>.</p>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="legal/exit-gateway.html#admonition-warning"></a>
</div>
<div>
<p>Nym core team cannot provide comprehensive legal advice across all jurisdictions. Knowledge and experience with the legalities are being built up with the help of our counsel and with you, the community of Nym node operators. We encourage Nym node operators to join the operator channels (<a href="https://matrix.to/#/#operators:nymtech.chat">Element</a>, <a href="https://nymtech.net/go/discord">Discord</a>, <a href="https://t.me/nymchan_help_chat">Telegram</a>) to share best practices and experiences.</p>
</div>
</div>
<h2 id="summary-2"><a class="header" href="#summary-2">Summary</a></h2>
<ul>
<li>
<p>This document outlines a plan to change Nym Gateways from operating with an ‘allow’ to a ‘deny’ list to enable broader uptake and usage of the Nym Mixnet. It provides operators with an overview of the plan, pros and cons, legal as well as technical advice.</p>
</li>
<li>
<p>Nym is committed to ensuring privacy for all users, regardless of their location and for the broadest possible range of online services. In order to achieve this aim, the Nym Mixnet needs to increase its usability across a broad range of apps and services.</p>
</li>
<li>
<p>Currently, Nym Gateway nodes only enable access to apps and services that are on an ‘allow’ list that is maintained by the core team.</p>
</li>
<li>
<p>To decentralise and enable privacy for a broader range of services, this initiative will have to transition from the current ‘allow’ list to a ‘deny’ list - <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">exit policy</a>. In accordance with the (nowadays deprecated) <code>Tor Null deny list</code> and <code>Tor reduced policy</code> together with changes decided by Nym operators community through the governance (like in this <a href="https://forum.nymtech.net/t/poll-a-new-nym-exit-policy-for-exit-gateways-and-the-nym-mixnet-is-inbound/464">vote</a>)</p>
</li>
<li>
<p>This will enhance the usage and appeal of Nym products for end users. As a result, increased usage will ultimately lead to higher revenues for Nym operators.</p>
</li>
<li>
<p>Nym core team cannot provide operators with definitive answers regarding the potential risks of operating open Gateways. However, there is online evidence of operating Tor exit relays:</p>
<ul>
<li>From a technical perspective, Nym node operators may need to implement additional controls, such as dedicated hardware and IP usage, or setting up an HTML exit notice on port 80.</li>
<li>From an operational standpoint, node operators may be expected to actively manage their relationship with their ISP or VPS provider and respond to abuse requests using the proposed templates.</li>
<li>Legally, exit relays are typically considered “telecommunication networks” and are subject to intermediary liability protection. However, there may be exceptions, particularly in cases involving criminal law and copyright claims. Operators could seek advice from local privacy associations and may consider running nodes under an entity rather than as individuals.</li>
</ul>
</li>
<li>
<p>This document serves as the basis for a consultation with Nym node operators on any concerns or additional support and information you need for this change to be successful and ensure maximum availability, usability and adoption.</p>
</li>
</ul>
<h2 id="goal-of-the-initiative"><a class="header" href="#goal-of-the-initiative">Goal of the initiative</a></h2>
<p><strong>Nym supports privacy for everyone, everywhere.</strong></p>
<p>To offer a better and more private everyday experience for its users, Nym would like them to use any online services they please, without limiting its access to a few messaging apps or crypto wallets.</p>
<p>To achieve this, operators running Exit Gateways would have to “open” their nodes to a wider range of online services, in a similar fashion to Tor exit relays following this <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">exit policy</a>.</p>
<h2 id="pros-and-cons-of-the-initiative"><a class="header" href="#pros-and-cons-of-the-initiative">Pros and cons of the initiative</a></h2>
<p>Previous setup: Running nodes supporting strict SOCKS5 app-based traffic</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left"><strong>Dimension</strong></th><th style="text-align: left"><strong>Pros</strong></th><th style="text-align: left"><strong>Cons</strong></th></tr></thead><tbody>
<tr><td style="text-align: left">Aspirational</td><td style="text-align: left"></td><td style="text-align: left">- Very limited use cases, not supportive of the “Privacy for everyone everywhere” aspiration<br>- Limited appeal to users, low competitiveness in the market, thus low usage</td></tr>
<tr><td style="text-align: left">Technical</td><td style="text-align: left">- No changes required in technical setup</td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left">Operational</td><td style="text-align: left">- No impact on operators operations (e.g., relationships with VPS providers)<br>- Low overhead<br>- Can be run as an individual</td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left">Legal</td><td style="text-align: left">- Limited legal risks for operators</td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left">Financial</td><td style="text-align: left"></td><td style="text-align: left">- Low revenues for operators due to limited product traction</td></tr>
</tbody></table>
</div>
<p>The new setup: Running nodes supporting traffic of any online service (with safeguards in the form of a denylist)</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left"><strong>Dimension</strong></th><th style="text-align: left"><strong>Pros</strong></th><th style="text-align: left"><strong>Cons</strong></th></tr></thead><tbody>
<tr><td style="text-align: left">Aspirational</td><td style="text-align: left">- Higher market appeal of a fully-fledged product able to answer all users’ use cases<br>- Relevance in the market, driving higher usage</td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left">Technical</td><td style="text-align: left">- Very limited changes required in the technical setup (changes in the allow -&gt; denylist)</td><td style="text-align: left">- Increased monitoring required to detect and prevent abuse (e.g. spam)</td></tr>
<tr><td style="text-align: left">Operational</td><td style="text-align: left"></td><td style="text-align: left">- Higher operational overhead, such as dealing with DMCA / abuse complaints, managing the VPS provider questions, or helping the community to maintain the denylist <br>- Administrative overhead if running nodes as a company or an entity</td></tr>
<tr><td style="text-align: left">Legal</td><td style="text-align: left"></td><td style="text-align: left">- Ideally requires to check legal environment with local privacy association or lawyer</td></tr>
</tbody></table>
</div>
<h2 id="exit-gateways-new-setup"><a class="header" href="#exit-gateways-new-setup">Exit Gateways: New setup</a></h2>
<p>In our previous technical setup, Network Requesters acted as a proxy, and only made requests that match an allow list. That was a default IP based list of allowed domains stored at Nym page in a centralised fashion possibly re-defined by any Network Requester operator.</p>
<p>This restricts the hosts that the NymConnect app can connect to and has the effect of selectively supporting messaging services (e.g. Telegram, Matrix) or crypto wallets (e.g. Electrum or Monero). Operators of Network Requesters can have confidence that the infrastructure they run only connects to a limited set of public internet hosts.</p>
<p>The principal change in the new configuration is to make this short allow list more permissive. Nym’s <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">exit policy</a> will restrict the hosts to which Nym Mixnet and Nym VPN users are permitted to connect. This will be done in an effort to protect the operators, as Gateways will act both as SOCKS5 Network Requesters, and exit nodes for IP traffic from Nym Mixnet VPN and VPN clients (both wrapped in the same app).</p>
<p>As of now we the Gateways will be defaulted to a combination of (nowadays deprecated) <code>Tor Null deny list</code> (note: Tornull is not affiliated with Tor Project) - reproduction permitted under Creative Commons Attribution 3.0 United States License which is IP-based, e.g., <code>ExitPolicy reject 5.188.10.0/23:*</code> and <code>Tor reduced policy</code> together with changes decided by Nym operators community through the governance (like in this <a href="https://forum.nymtech.net/t/poll-a-new-nym-exit-policy-for-exit-gateways-and-the-nym-mixnet-is-inbound/464">vote</a>). This policy will remain the same for all the nodes, without any option to modify it by Nym node operators individually, to secure stable and reliable service for the end users.</p>
<p>For exit relays on ports 80 and 443, the Gateways will exhibit an HTML page resembling the one proposed by <a href="https://gitlab.torproject.org/tpo/core/tor/-/raw/HEAD/contrib/operator-tools/tor-exit-notice.html">Tor</a>. By doing so, the operator will be able to disclose details regarding their Gateway, including the currently configured exit policy, all without the need for direct correspondence with regulatory or law enforcement agencies. It also makes the behavior of Exit Gateways transparent and even computable (a possible feature would be to offer a machine readable form of the notice in JSON or YAML).</p>
<p>We also recommend operators to check the technical advice from <a href="https://community.torproject.org/relay/setup/exit/">Tor</a>.</p>
<h2 id="tor-legal-advice"><a class="header" href="#tor-legal-advice">Tor legal advice</a></h2>
<p>Giving the legal similarity between Nym Exit Gateways and Tor Exit Relays, it is helpful to have a look in <a href="https://community.torproject.org/relay/community-resources/tor-exit-guidelines/">Tor community Exit Guidelines</a>. This chapter is an exert of tor page.</p>
<p>Note that Tor states:</p>
<blockquote>
<p>This FAQ is for informational purposes only and does not constitute legal advice.</p>
</blockquote>
<p><em>Check legal advice prior to running an exit relay</em></p>
<ul>
<li>Understand the risks associated with running an exit relay; E.g., know legal paragraphs relevant in the country of operations:
<ul>
<li>US <a href="https://www.law.cornell.edu/uscode/text/17/512">DMCA 512</a>; see <a href="https://community.torproject.org/relay/community-resources/eff-tor-legal-faq">EFF’s Legal FAQ for Tor Operators</a> (a very good and relevant read for other countries as well)</li>
<li>Germany’s <a href="https://www.gesetze-im-internet.de/tmg/__8.html">TeleMedienGesetz 8</a> and 15](https://www.gesetze-im-internet.de/tmg/__15.html)</li>
<li>Netherlands: <a href="http://wetten.overheid.nl/BWBR0005289/Boek6/Titel3/Afdeling4A/Artikel196c/">Artikel 6:196c BW</a></li>
<li>Austria: <a href="http://www.ris.bka.gv.at/Dokument.wxe?Abfrage=Bundesnormen&amp;Dokumentnummer=NOR40025809">E-Commerce-Gesetz 13</a></li>
<li>Sweden: <a href="https://lagen.nu/2002:562#P16S1">16-19 2002:562</a></li>
</ul>
</li>
<li>Top 3 advice
<ul>
<li>Have an abuse response letter</li>
<li>Run relay from a location that is not home</li>
<li>Read through the legal resources that Tor-supportive lawyers put together: <a href="https://www.eff.org/pages/legal-faq-tor-relay-operators">www.eff.org/pages/legal-faq-tor-relay-operators</a> or <a href="https://www.noisebridge.net/wiki/Noisebridge_Tor/FBI">www.noisebridge.net/wiki/Noisebridge_Tor/FBI</a></li>
</ul>
</li>
<li>Consult a lawyer / local digital rights association / the EFF prior to operating an exit relay, especially in a place where exit relay operators have been harassed or not operating before. Note that Tor DOES NOT provide legal advice for specific countries. It only provides general advice (itself or in partnership), eventually skewed towards <a href="https://www.eff.org/pages/legal-faq-tor-relay-operators">US audiences</a>.</li>
</ul>
<p><em>Run an exit relay within an entity</em></p>
<p>As an organisation - it might help from a liability perspective</p>
<ul>
<li>Within your university</li>
<li>With a node operators’ association (e.g., a Torservers.net partner)</li>
<li>Within a company</li>
</ul>
<p><em>Be ready to respond to abuse complaints</em></p>
<ul>
<li>Make your contact details (email, phone, or even fax) available, instead of those of the ISP</li>
<li>Reply in a timely manner (e.g., 24 hours) using the <a href="https://community.torproject.org/relay/community-resources/tor-abuse-templates">provided templates</a></li>
<li>Note that Tor states: <em>“We are not aware of any case that made it near a court, and we will do everything in our power to support you if it does.”</em></li>
<li>Document experience with ISPs at <a href="https://community.torproject.org/relay/community-resources/good-bad-isps/">community.torproject.org/relay/community-resources/good-bad-isps</a></li>
</ul>
<p>Useful links:</p>
<ul>
<li>
<p>Tor abuse templates:</p>
<ul>
<li><a href="https://community.torproject.org/relay/community-resources/tor-abuse-templates/">community.torproject.org/relay/community-resources/tor-abuse-templates/</a></li>
<li><a href="https://gitlab.torproject.org/legacy/trac/-/wikis/doc/TorAbuseTemplates">gitlab.torproject.org/legacy/trac/-/wikis/doc/TorAbuseTemplates</a> (from 2020)</li>
<li><a href="https://github.com/coldhakca/abuse-templates/blob/master/generic.template">github.com/coldhakca/abuse-templates/blob/master/generic.template</a></li>
</ul>
</li>
<li>
<p>DMCA response templates:</p>
<ul>
<li><a href="https://community.torproject.org/relay/community-resources/eff-tor-legal-faq/tor-dmca-response/">community.torproject.org/relay/community-resources/eff-tor-legal-faq/tor-dmca-response/</a></li>
<li><a href="https://2019.www.torproject.org/eff/tor-dmca-response.html">2019.www.torproject.org/eff/tor-dmca-response.html</a> (from 2011)</li>
<li><a href="https://github.com/coldhakca/abuse-templates/blob/master/dmca.template">github.com/coldhakca/abuse-templates/blob/master/dmca.template</a></li>
</ul>
</li>
</ul>
<h2 id="legal-environment-of-nym-exit-gateway"><a class="header" href="#legal-environment-of-nym-exit-gateway">Legal environment of Nym Exit Gateway</a></h2>
<p>The Node Operators Legal Forum pages are divided according <a href="legal/jurisdictions.html">jurisdictions</a>. Read below to learn <a href="legal/add-content.html">how to add</a> findings about your jurisdiction or edit existing info.</p>
<h2 id="community-counsel"><a class="header" href="#community-counsel">Community Counsel</a></h2>
<p>Nym Node operators are invited to add their legal findings or helpful suggestions directly through <a href="legal/add-content.html">pull requests</a>. This can be done as a new legal information (or entire new country) to the list of <a href="legal/jurisdictions.html">jurisdictions</a> or in a form of an advice to <a href="legal/community-counsel.html">Community counsel pages</a>, sharing examples of Exit Gateway <a href="legal/landing-pages.html">landing pages</a>, templates etcetra.</p>
<h2 id="how-to-add-content"><a class="header" href="#how-to-add-content">How to add content</a></h2>
<p>Our aim is to establish a strong community network, sharing legal findings and other suggestions with each other. We would like to encourage all of the current and future operators to do research about the situation in the jurisdiction they operate in as well as solutions to any challenges when running an Exit Gateway and add those through a pull request (PR). Please check out the <a href="legal/add-content.html">steps to make a pull request</a>.</p>
<footer id="last-change">Last change: 2024-08-07, commit: <a href="https://github.com/nymtech/nym/commit/1e01a8e63">1e01a8e63</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="community-counsel-1"><a class="header" href="#community-counsel-1">Community Counsel</a></h1>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="legal/community-counsel.html#admonition-info"></a>
</div>
<div>
<p>The entire content of this page is under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Public License</a>.</p>
</div>
</div>
<p>Running an Exit Gateway is a commitment and as such is exposed to various challenges. Besides different legal regulations typical difficulties may be dealing with VPS or ISP providers. Our strength lies in decentralised community of squads and individuals supporting each other. Sharing examples of <a href="legal/landing-pages.html">landing pages</a>, templates for communication and FAQs is a great way to empower other operators sharing the mission of liberating internet. Below is a simple way how to create a pull request directly to Nym Operator Guide book.</p>
<h2 id="how-to-add-content-1"><a class="header" href="#how-to-add-content-1">How to add content</a></h2>
<p>Our aim is to establish a strong community network, sharing legal findings and other suggestions with each other. We would like to encourage all of the current and future operators to do research about the situation in the jurisdiction they operate in as well as solutions to any challenges when running an Exit Gateway and add those through a pull request (PR). Please check out the <a href="legal/add-content.html">steps to make a pull request</a>.</p>
<footer id="last-change">Last change: 2024-02-01, commit: <a href="https://github.com/nymtech/nym/commit/c0337ec1d">c0337ec1d</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="where-to-host-your-nym-node"><a class="header" href="#where-to-host-your-nym-node">Where to host your <code>nym-node</code>?</a></h1>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="legal/isp-list.html#admonition-info"></a>
</div>
<div>
<p>The entire content of this page is under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Public License</a>.</p>
</div>
</div>
<p>Inspired by a valuable resource, done by Tor community - <a href="https://community.torproject.org/relay/community-resources/good-bad-isps/"><em>Good Bad ISPs</em></a>, LunarDAO squad initiated a table customised for Nym Exit Gateways operators.</p>
<p>This ISP list is fully managed by Nym operator community and it serves as a space to share their experience of running Exit Gateways on various Internet Service Providers (ISPs). The ISPs greatly differ in regards to services they offer as well as to their openess of hosting exit routing software.</p>
<p>Please share any experiences running a node like policies, complains, legal issues and solutions, discrepancy between offers and reality (bandwidth, IP range, locations) or anything regarding pricing or customer support.</p>
<p>If you came across any legal findings, please share them in our <a href="legal/jurisdictions.html">list of jurisdictions</a>.</p>
<p>While we trust that Nym node operators are honest, we would like to ask everyone to do your own research.</p>
<div id="admonition-default" class="admonition admonish-warning" role="note">
<div>
<p>To edit or add information to the ISP list, make changes to the csv file located <a href="https://github.com/nymtech/nym/blob/develop/documentation/operators/src/data/isp-sheet.csv">here</a> and submit your edits as a pull request according to <a href="legal/add-content.html">this guide</a>.</p>
</div>
</div>
<div id="admonition-default-1" class="admonition admonish-note" role="note">
<div>
<p>As of now the list is quite short. When it grows, we can divide it according the localities of the listed ISPs.</p>
</div>
</div>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left"><strong>ISP</strong></th><th style="text-align: left"><strong>Locations</strong></th><th style="text-align: left"><strong>Public IPv6</strong></th><th style="text-align: left"><strong>Crypto Payments</strong></th><th style="text-align: left"><strong>Comments</strong></th><th style="text-align: left"><strong>Last Updated</strong></th></tr></thead><tbody>
<tr><td style="text-align: left"><a href="https://alexhost.com">AlexHost</a></td><td style="text-align: left">Moldova, Bulgaria, Sweden, Netherlands</td><td style="text-align: left">Yes, on by default</td><td style="text-align: left">Yes</td><td style="text-align: left">They allow TOR Bridges, Relays. Exit nodes are only allowed on dedicated servers (prices start from 26 EUR)</td><td style="text-align: left">07/2024</td></tr>
<tr><td style="text-align: left"><a href="https://bitlaunch.io">BitLaunch</a></td><td style="text-align: left">Canada, USA, UK</td><td style="text-align: left">No</td><td style="text-align: left">Yes</td><td style="text-align: left">Expensive. Digial Ocean through BitLanch has IPv6</td><td style="text-align: left">05/2024</td></tr>
<tr><td style="text-align: left"><a href="https://www.cherryservers.com">Cherry Servers</a></td><td style="text-align: left">Lithuania, Netherlands, USA, Singapore</td><td style="text-align: left">No</td><td style="text-align: left">Yes</td><td style="text-align: left">Issued IP doesn’t match the location offered by the provider.</td><td style="text-align: left">05/2024</td></tr>
<tr><td style="text-align: left"><a href="https://flokinet.is">Flokinet</a></td><td style="text-align: left">Netherlands, Iceland, Romania,France</td><td style="text-align: left">Yes, needs a ticket and custom setup</td><td style="text-align: left">yes, including XMR</td><td style="text-align: left">Very slow customer support</td><td style="text-align: left">05/2024</td></tr>
<tr><td style="text-align: left"><a href="https://hostsailor.com">HostSailor</a></td><td style="text-align: left">USA</td><td style="text-align: left">Yes, based on ticket</td><td style="text-align: left">Yes</td><td style="text-align: left">The IPv6 setup needs custom research and is not documented</td><td style="text-align: left">05/2024</td></tr>
<tr><td style="text-align: left"><a href="https://hostiko.com.ua">Hostiko</a></td><td style="text-align: left">Ukraine, Germany</td><td style="text-align: left">Yes, on by default</td><td style="text-align: left">Yes</td><td style="text-align: left">Ukrainian provider. They allow Exit nodes on Germany boxes but limit the bandwidth, you also have to restrict certain ports like 25 and 587. Make sure you open a ticket.</td><td style="text-align: left">07/2024</td></tr>
<tr><td style="text-align: left"><a href="https://hostinger.com">Hostinger</a></td><td style="text-align: left">France, Lithuania, India, USA, Brazil</td><td style="text-align: left">Yes, out of the box</td><td style="text-align: left">Yes</td><td style="text-align: left">Crypto payments must be done per each server monthly or annually.</td><td style="text-align: left">05/2024</td></tr>
<tr><td style="text-align: left"><a href="https://hostslick.com">Hostslick</a></td><td style="text-align: left">Netherlands, Germany</td><td style="text-align: left">Yes, on by default</td><td style="text-align: left">Yes</td><td style="text-align: left">Good amount of bandwidth for the price. Make sure you open the ticket if you want to run Exit node</td><td style="text-align: left">07/2024</td></tr>
<tr><td style="text-align: left"><a href="https://incognet.io">Incognet</a></td><td style="text-align: left">Netherlands and USA</td><td style="text-align: left">Yes, on by default</td><td style="text-align: left">Yes</td><td style="text-align: left">They allow Tor exit nodes but you must adhere to their rules https://incognet.io/tor-exits</td><td style="text-align: left">07/2024</td></tr>
<tr><td style="text-align: left"><a href="https://ishosting.com/en">IsHosting</a></td><td style="text-align: left">Brazil, Netherlands</td><td style="text-align: left">Yes, based on ticket</td><td style="text-align: left">Yes</td><td style="text-align: left">Expensive</td><td style="text-align: left">05/2024</td></tr>
<tr><td style="text-align: left"><a href="https://linode.com">Linode</a></td><td style="text-align: left">USA, Canada, Japan, India, Indonesia, Sweden, Netherlands, Germany, Brazil, France, UK, Australia, Italy</td><td style="text-align: left">Yes out of the box</td><td style="text-align: left">No, only through <a href="https://bitlaunch.io">BitLAunch</a></td><td style="text-align: left">IPv6 sometimes need to be re-added in Networking tab, no reboot needed</td><td style="text-align: left">05/2024</td></tr>
<tr><td style="text-align: left"><a href="https://liteserver.nl">LiteServer</a></td><td style="text-align: left">Netherlands</td><td style="text-align: left">Yes, on by default</td><td style="text-align: left">Yes</td><td style="text-align: left">Very reliable Dutch provider. They do allow Relay nodes but for Exit nodes you need to contact them. Always check T&amp;C https://liteserver.nl/legal</td><td style="text-align: left">07/2024</td></tr>
<tr><td style="text-align: left"><a href="https://mevspace.com">Mevspace</a></td><td style="text-align: left">Poland</td><td style="text-align: left">Yes, on by default</td><td style="text-align: left">Yes</td><td style="text-align: left">Flexible Polish providers with 3 DCs in Poland. They do allow Tor Exit nodes but you may need a dedicated server for this. Make sure you open a ticket to check. As of today’s date, they have 48h for 1 EUR tariff</td><td style="text-align: left">07/2024</td></tr>
<tr><td style="text-align: left"><a href="https://www.misaka.io/">Misaka</a></td><td style="text-align: left">South Africa</td><td style="text-align: left">Yes, native support</td><td style="text-align: left">No</td><td style="text-align: left">Very Expensive</td><td style="text-align: left">05/2024</td></tr>
<tr><td style="text-align: left"><a href="https://nja.la">Njalla</a></td><td style="text-align: left">Sweden</td><td style="text-align: left">Yes</td><td style="text-align: left">Yes</td><td style="text-align: left">Privacy vandguards! The biggest VPS 45 is 3 cores only, but it works better than many “larger” servers on the market.</td><td style="text-align: left">05/2024</td></tr>
<tr><td style="text-align: left"><a href="https://rdp.sh">RDP</a></td><td style="text-align: left">Netherlands, USA, Poland</td><td style="text-align: left">Yes, on by default</td><td style="text-align: left">Yes</td><td style="text-align: left">German provider. Exit nodes are allowed, policy is here https://rdp.sh/docs/faq/tor ports 25,465,587 must be closed. Make sure you open a ticket before running an exit node.</td><td style="text-align: left">07/2024</td></tr>
<tr><td style="text-align: left"><a href="https://terrahost.no">TerraHost</a></td><td style="text-align: left">Norway</td><td style="text-align: left">Yes, on by default</td><td style="text-align: left">Yes</td><td style="text-align: left">Very reliable Norwegian provider. Only allow exit nodes on Dedicated servers subject to certain caveats (you must open a ticket). Always check T&amp;C https://terrahost.no/avtalebetingelser</td><td style="text-align: left">07/2024</td></tr>
<tr><td style="text-align: left"><a href="https://ihostart.com">iHostArt</a></td><td style="text-align: left">Romania</td><td style="text-align: left">Yes, on by default</td><td style="text-align: left">Yes</td><td style="text-align: left">Super permissive provider. They do allow Tor Exit/Relay/Bridge. Pro-free speech etc. Recently, IPv6 geolocation was set to North Korea, so be aware.</td><td style="text-align: left">07/2024</td></tr>
<tr><td style="text-align: left"><a href="https://vsys.host">vSys Host</a></td><td style="text-align: left">Ukraine, Netherlands, USA</td><td style="text-align: left">Yes, on by default</td><td style="text-align: left">Yes</td><td style="text-align: left">Pretty permissive provider registered in Ukraine. Should allow Relay/Exit nodes but nothing in T&amp;C, so better double check.</td><td style="text-align: left">07/2024</td></tr>
</tbody></table>
</div><footer id="last-change">Last change: 2024-05-20, commit: <a href="https://github.com/nymtech/nym/commit/0eb6eb855">0eb6eb855</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="exit-gateway---jurisdictions"><a class="header" href="#exit-gateway---jurisdictions">Exit Gateway - Jurisdictions</a></h1>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="legal/jurisdictions.html#admonition-info"></a>
</div>
<div>
<p>The entire content of this page is under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Public License</a>.</p>
</div>
</div>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="legal/jurisdictions.html#admonition-warning"></a>
</div>
<div>
<p>The following part is for informational purposes only. Nym core team cannot provide comprehensive legal advice across all jurisdictions. Knowledge and experience with the legalities are being built up with the help of our counsel and with you, the community of Nym node operators. We encourage Nym node operators to join the <a href="https://matrix.to/#/#operators:nymtech.chat">Node Operator</a> and <a href="https://matrix.to/#/!YfoUFsJjsXbWmijbPG:nymtech.chat?via=nymtech.chat&amp;via=matrix.org">Operators Legal Forum</a> channels on Element to share best practices and experiences.</p>
</div>
</div>
<p>There is no one silver bullet covering the entire globe. Every jurisdiction has different set of laws and practices regarding internet traffic routing. Therefore the Node Operators Legal Forum pages are divided per region.</p>
<p>These are some findings from our legal team as an example:</p>
<ul>
<li><a href="legal/swiss.html">Switzerland</a></li>
<li><a href="legal/united-states.html">United States</a></li>
</ul>
<blockquote>
<p>Nym Node operators are invited to add their legal findings directly through <a href="legal/add-content.html">pull requests</a>.</p>
</blockquote>
<footer id="last-change">Last change: 2024-02-01, commit: <a href="https://github.com/nymtech/nym/commit/f45ed7880">f45ed7880</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="legal-environment-switzerland"><a class="header" href="#legal-environment-switzerland">Legal environment: Switzerland</a></h1>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="legal/swiss.html#admonition-info"></a>
</div>
<div>
<p>The entire content of this page is under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Public License</a>.</p>
</div>
</div>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="legal/swiss.html#admonition-warning"></a>
</div>
<div>
<p>The following part is for informational purposes only. Nym core team cannot provide comprehensive legal advice across all jurisdictions. Knowledge and experience with the legalities are being built up with the help of our counsel and with you, the community of Nym node operators. We encourage Nym node operators to join the <a href="https://matrix.to/#/#operators:nymtech.chat">Node Operator</a> and <a href="https://matrix.to/#/!YfoUFsJjsXbWmijbPG:nymtech.chat?via=nymtech.chat&amp;via=matrix.org">Operators Legal Forum</a> channels on Element to share best practices and experiences.</p>
</div>
</div>
<h2 id="findings-from-our-legal-team"><a class="header" href="#findings-from-our-legal-team">Findings from our legal team</a></h2>
<blockquote>
<p><strong>Note:</strong> The information shared below is in the stage of conclusions upon final confirmation. The text is a not edited exert from a legal counsel. Nym core team is asking for more clarifications.</p>
</blockquote>
<h3 id="operators-of-exit-nodes"><a class="header" href="#operators-of-exit-nodes">Operators of Exit Nodes</a></h3>
<h4 id="telecoms-law"><a class="header" href="#telecoms-law">Telecoms Law</a></h4>
<p>As well as operators of normal mixnet nodes, operators of exit nodes might be considered telecommunications providers according to the broad term of the telecommunications act (TCA).
The regulatory consequences have already been laid out in section 5.1.2.2.1 above.</p>
<h4 id="telecoms-surveillance-law"><a class="header" href="#telecoms-surveillance-law">Telecoms Surveillance Law</a></h4>
<p>Unlike normal mixnet nodes, exit nodes might have information about the communication party which uses the respective exit node (in particular its IP address). They might therefore be a target for surveillance authorities, at least at first glance.</p>
<p>However, as the IP address of the communications party is disguised on the other side of the communications through the Nym encryption infrastructure, the usual situation, where an IP address or another trace of an Internet user is found in the connection with a criminal activity (e.g., in a web server protocol), and then used in cooperation with the user’s provider to identify the user, is not going to take place.</p>
<p>The same is true for the opposite side: The node operator does not see the communication party of his user.</p>
<p>Experience has shown that Swiss investigative authorities are aware of these limitations and do not conduct investigations against individuals who operate TOR nodes, for example. In one specific case that I know of, the investigation was stopped by the police as soon as it was clear that a TOR node was being operated.</p>
<p>I therefore consider the risk for an exit node operator to become involved in a SPTA proceeding as low.</p>
<p>Nevertheless, in such a situation, exit node operators providers would have to provide the authorities with the information already available to them (Art. 22 Para. 3 SPTA), and they would have to tolerate monitoring by the authorities or by the persons commissioned by the service of the data which the monitored person transmits or stores using derived communications services (Art. 27 Para. 1 SPTA; see above, 5.1.1.2). There is no duty of data retention for providers of derived communication services, though.</p>
<p>The risk for exit node operators of being upgraded according to Art. 22 Para. 4 SPTA is low to non existent for the reasons mentioned above.</p>
<h4 id="intelligence-service-law"><a class="header" href="#intelligence-service-law">Intelligence Service Law</a></h4>
<p>Operators of exit nodes do not provide wire-based telecommunications services either and therefore do not fall under the IntelSA.</p>
<h3 id="nym-as-vpn-provider"><a class="header" href="#nym-as-vpn-provider">Nym as VPN provider</a></h3>
<h4 id="telecoms-law-1"><a class="header" href="#telecoms-law-1">Telecoms Law</a></h4>
<p>Nym as a VPN operator might be considered a telecommunication provider under the newly revised TCA, as the term now also covers operators of Over-the-Top services which are carried out over the internet.</p>
<p>However I consider possible administrative burdens arising from this qualification as negligible (see above, 5.1.2.1).</p>
<h4 id="telecoms-surveillance-law-1"><a class="header" href="#telecoms-surveillance-law-1">Telecoms Surveillance Law</a></h4>
<p>VPN providers have information about the communication party which uses the respective exit node (in particular its IP address). They might therefore be a target for surveillance authorities, at least at first glance.</p>
<p>However, for the same reason I see a risk low for exit node operators to become involved in a SPTA proceeding (the IP address is not visible to the communication partner, which is exactly the reason the Nym VPN is being used at all), I also see a low risk for Nym itself to become involved in such a proceeding (see above, 5.1.3.2).</p>
<h4 id="intelligence-service-law-1"><a class="header" href="#intelligence-service-law-1">Intelligence Service Law</a></h4>
<p>VPN operators do not provide wire-based telecommunications services and therefore do not fall under the IntelSA.</p>
<h3 id="eu-chat-control-regulation-in-particular"><a class="header" href="#eu-chat-control-regulation-in-particular">EU chat control regulation in particular</a></h3>
<p>According to a EU commission proposal for a regulation laying down rules to prevent and combat child sexual abuse (https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX: 52022PC0209) hosting providers and providers of so-called interpersonal communication services should be obliged to perform an assessment of risks of online child sexual abuse. Additionally an obligation for certain providers should be established to detect such abuse, to report it via the EU Centre, to remove or disable access to, or to block online child sexual abuse material when so ordered.</p>
<p>’Interpersonal communications service’ means a service normally provided for remuneration that enables direct interpersonal and interactive exchange of information via electronic communications networks between a finite number of persons, whereby the persons initiating or participating in the communication determine its recipient(s) and does not include services which enable interpersonal and interactive communication merely as a minor ancillary feature that is intrinsically linked to another service (Art. 2 Point 5 Directive (EU) 2018/1972, which is also relevant for the mentioned proposal).</p>
<p>Interpersonal communications services are services that enable interpersonal and interactive exchange of information. Interactive communication entails that the service allows the recipient of the information to respond. The proposal therefore only covers services like traditional voice calls between two individuals but also all types of emails, messaging services, or group chats. Examples for services which do not meet those requirements are linear broadcasting, video on demand, websites, social networks, blogs, or exchange of information between machines (Directive (EU) 2018/1972, Consideration 17).</p>
<p>Neither the Nym encryption infrastructure nor the NYM VPN are used as means for an interactive exchange of information in the aforementioned sense (of e-mail, messaging, chats or similar).</p>
<p>I therefore consider the risk arising from the mentioned proposal for Nym as low, be it as software developer or VPN operator.</p>
<p>However, an application provider which uses the Nym encryption infrastructure to provide encrypted chat services or similar could still fall under the proposal. This might pose a commercial risk for Nym as the provider of the basic infrastructure for such services, because such services might lose their commercial value for end customers.</p>
<p>Currently the EU decision on chat control has been postponed because there is a blocking minority which can prevent the adoption of the respective parts of the law. In addition, even EU internal lawyers held that the proposal was clearly in violation of the EU charter of fundamental rights and would therefore be nullified by the EU courts in case it would still be enacted by the parliament.</p>
<p>I therefore consider the risk that the mentioned proposal is enacted by the EU authorities and finally upheld by the courts in its planned form as low.</p>
<footer id="last-change">Last change: 2024-08-15, commit: <a href="https://github.com/nymtech/nym/commit/d473e8743">d473e8743</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="legal-environment-united-states"><a class="header" href="#legal-environment-united-states">Legal environment: United States</a></h1>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="legal/united-states.html#admonition-info"></a>
</div>
<div>
<p>The entire content of this page is under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Public License</a>.</p>
</div>
</div>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="legal/united-states.html#admonition-warning"></a>
</div>
<div>
<p>The following part is for informational purposes only. Nym core team cannot provide comprehensive legal advice across all jurisdictions. Knowledge and experience with the legalities are being built up with the help of our counsel and with you, the community of Nym node operators. We encourage Nym node operators to join the <a href="https://matrix.to/#/#operators:nymtech.chat">Node Operator</a> and <a href="https://matrix.to/#/!YfoUFsJjsXbWmijbPG:nymtech.chat?via=nymtech.chat&amp;via=matrix.org">Operators Legal Forum</a> channels on Element to share best practices and experiences.</p>
</div>
</div>
<h2 id="findings-from-our-legal-team-1"><a class="header" href="#findings-from-our-legal-team-1">Findings from our legal team</a></h2>
<blockquote>
<p><strong>Note:</strong> The information shared below is in the stage of conclusions upon final confirmation. The text is a not edited exert from a legal counsel. Nym core team is asking for more clarifications.</p>
</blockquote>
<p>The US legal counsel have so far provided the following advice:</p>
<p>The legal risk faced by VPN operators subject to United States jurisdiction depends on various statutes and regulations related to privacy, anonymity, and electronic communications. The key areas to consider are: intermediary liability and exceptions, data protection, copyright infringement, export controls, criminal law, government requests for data and assistance, and third party liability.</p>
<p>As outlined in Part A, the United States treats VPNs as telecommunications networks subject to intermediary liability protection from wrongful conduct that occurs on its network. However, such protections do have exceptions including criminal law and copyright claims that are worth considering. In the United States, I am not aware of an individual ever being prosecuted or convicted for running a node for a dVPN or a Privacy Enhancing Network.</p>
<p>However, as discussed in Part B-C, VPN operators are subject to law enforcement requests for access or assistance in obtaining access to data relevant to an investigation into allegedly unlawful conduct that was facilitated by the network as an intermediary. As shown in Part C, governments may also request assistance from node operators for certain high-level and national security targets.</p>
<p>Finally, as outlined in Parts D-G, VPN operators may also be subject to non-criminal liability including (Part D) failing to respond to notices under the DMCA, (Part E) privacy and data protection law, (Part F) third party lawsuits stemming from wrongful acts committed using the network, and (G) export control violations.</p>
<footer id="last-change">Last change: 2023-10-26, commit: <a href="https://github.com/nymtech/nym/commit/3fdd89035">3fdd89035</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="landing-pages"><a class="header" href="#landing-pages">Landing Pages</a></h1>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="legal/landing-pages.html#admonition-info"></a>
</div>
<div>
<p>The entire content of this page is under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Public License</a>.</p>
</div>
</div>
<blockquote>
<p>Nym Node operators are invited to add their legal findings and suggestions directly through <a href="legal/add-content.html">pull requests</a>.</p>
</blockquote>
<p>Exit Gateway landing page is a great and transparent way to prevent possible troubles by providing people with basic facts, links to laws and regulations on a given topic as well as operator’s contact info. To inspire each other we share some examples how Nym community handled this issue below.</p>
<h2 id="avril-14th-exit-gateways"><a class="header" href="#avril-14th-exit-gateways">Avril 14th Exit Gateways</a></h2>
<p>Visit <a href="legal/../nodes/proxy-configuration.html#reversed-proxy-avril-14th-exit-gateways-guide">Reversed Proxy: Avril 14th Exit Gateways Guide</a> and follow the guide to setup your landing page.</p>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="adding-content-to-legal-forum"><a class="header" href="#adding-content-to-legal-forum">Adding Content to Legal Forum</a></h1>
<p>Our aim is to establish a strong community network, sharing legal findings and other suggestions with each other. We would like to encourage all of the current and future operators to do research about the situation in the jurisdiction they operate in, to share solutions to the challenges they encountered when running Exit Gateway, and create a pull request (PR).</p>
<p>First of all, please join our <a href="https://matrix.to/#/!YfoUFsJjsXbWmijbPG:nymtech.chat?via=nymtech.chat&amp;via=matrix.org">Node Operators Legal Forum</a> (Matrix chat) and post any information or questions there.</p>
<p>To add your information to this book, you can create a PR directly to our <a href="https://github.com/nymtech/nym/tree/develop/documentation/operators/src/legal">repository</a>.</p>
<p><strong>Steps to make a pull request:</strong></p>
<ol>
<li>
<p>Write down your legal findings, suggestions, communication templates, FAQ in a text editor</p>
</li>
<li>
<p>Clone <code>nymtech/nym</code> repository or pull in case you already have it and switch to <code>develop</code> branch</p>
</li>
</ol>
<pre><code class="language-sh"># clone the repository
git clone https://github.com/nymtech/nym

# go to the directory nym
cd nym

# switch to branch develop
git checkout develop

# update the repository
git pull origin develop
</code></pre>
<ol start="3">
<li>Make your own branch based off <code>develop</code> and switch to it</li>
</ol>
<pre><code class="language-sh"># choose a descriptive and consise name without using &lt;&gt;
git checkout -b operators/legal-forum/&lt;MY_BRANCH_NAME&gt;

# example: git checkout -b operators/legal-forum/alice-vps-faq-template

# you can double check that you are on the right branch
git branch
</code></pre>
<ol start="4">
<li>
<p>Save your legal findings as <code>&lt;JURISDICTION_NAME&gt;.md</code> to <code>/nym/documentation/operators/src/legal</code> or add info to an existing page</p>
</li>
<li>
<p><strong>Don’t change anything in <code>SUMMARY.md</code></strong>, the admins will do it when merging</p>
</li>
<li>
<p>Add, commit and push your changes</p>
</li>
</ol>
<pre><code class="language-sh">cd documentation/operators/src/legal
git add &lt;FILE_NAME&gt;.md
git commit -am "&lt;DESCRIBE YOUR CHANGES&gt;"
git push origin operators/legal-forum/&lt;MY_BRANCH_NAME&gt;
</code></pre>
<ol start="7">
<li>Open the git generated link in your browser, fill the description and click on <code>Create a Pull Request</code> button</li>
</ol>
<pre><code class="language-sh"># the url will look like this
 https://github.com/nymtech/nym/pull/new/operators/legal-forum/&lt;MY_BRANCH_NAME&gt;
</code></pre>
<ol start="8">
<li>Notify others in the <a href="https://matrix.to/#/!YfoUFsJjsXbWmijbPG:nymtech.chat?via=nymtech.chat&amp;via=matrix.org">Node Operators Legal Forum</a> (Matrix chat) about the PR.</li>
</ol>
<footer id="last-change">Last change: 2024-02-01, commit: <a href="https://github.com/nymtech/nym/commit/f45ed7880">f45ed7880</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="archived-pages"><a class="header" href="#archived-pages">Archived Pages</a></h1>
<p>This section contains old but still relevant pages/guides, archived for backwards compatibility. The content of the pages is not updated. See the top of every page informing you about the last time of update.</p>
<p>Pages listed in archive section will eventually be terminated as they will become completely irrelevant with time.</p>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="node-setup-guides"><a class="header" href="#node-setup-guides">Node Setup Guides</a></h1>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/setup-guides.html#admonition-warning"></a>
</div>
<div>
<p><strong>This is an archived page for backwards compatibility. The content of this page is not updated since April 19th 2024. Eventually this page will be terminated!</strong></p>
</div>
</div>
<p>To setup any type of Nym’s node, start with building <a href="archive/nodes/../../binaries/building-nym.html">Nym’s platform</a> on the machine (VPS) where you want to run the node. Nodes will need to be bond to Nym’s wallet, setup one <a href="https://nymtech.net/docs/wallet/desktop-wallet.html">here</a>.</p>
<p>This section contains setup guides for the following node types:</p>
<ul>
<li><a href="archive/nodes/mix-node-setup.html">Mix Node</a></li>
<li><a href="archive/nodes/gateway-setup.html">Gateway</a></li>
<li><a href="archive/nodes/network-requester-setup.html">Network Requester</a></li>
<li><a href="archive/nodes/../../nodes/validator-setup.html">Validator</a></li>
</ul>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="preliminary-steps-2"><a class="header" href="#preliminary-steps-2">Preliminary Steps</a></h1>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/initial-steps.html#admonition-warning"></a>
</div>
<div>
<p><strong>This is an archived page for backwards compatibility. The content of this page is not updated since April 19th 2024. Eventually this page will be terminated!</strong></p>
</div>
</div>
<blockquote>
<p>The Nym <code>mixnode</code>, <code>gateway</code> and <code>network-requester</code> binaries were built in the <a href="archive/nodes/../../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code, go there first.</p>
</blockquote>
<p>There are a couple of steps that need completing before starting to set up your mix node, gateway or a network requester:</p>
<ul>
<li>preparing your <a href="https://nymtech.net/docs/wallet/desktop-wallet.html">desktop wallet</a> or <a href="https://nymtech.net/docs/wallet/cli-wallet.html">CLI wallet</a>.</li>
<li>requisitioning a VPS (Virtual Private Server)</li>
</ul>
<h3 id="wallet-preparation"><a class="header" href="#wallet-preparation">Wallet preparation</a></h3>
<h4 id="mainnet-1"><a class="header" href="#mainnet-1">Mainnet</a></h4>
<p>Before you initialise and run your mix node, head to our <a href="https://nymtech.net/download/">website</a> and download the Nym wallet for your operating system. If pre-compiled binaries for your operating system aren’t available, you can build the wallet yourself with instructions <a href="https://nymtech.net/docs/wallet/desktop-wallet.html">here</a>.</p>
<p>If you don’t already have one, please create a Nym address using the wallet, and fund it with tokens. The minimum amount required to bond a mix node is 100 <code>NYM</code>, but make sure you have a bit more to account for gas costs.</p>
<p><code>NYM</code> can be purchased via Bity from the wallet itself with BTC or fiat, and is currently present on several <a href="https://www.coingecko.com/en/coins/nym#markets">exchanges</a>.</p>
<blockquote>
<p>Remember that you can <strong>only</strong> use Cosmos <code>NYM</code> tokens to bond your mix node. You <strong>cannot</strong> use ERC20 representations of <code>NYM</code> to run a node.</p>
</blockquote>
<h4 id="sandbox-testnet-2"><a class="header" href="#sandbox-testnet-2">Sandbox testnet</a></h4>
<p>Make sure to download a wallet and create an account as outlined above. Then head to our <a href="https://faucet.nymtech.net/">token faucet</a> and get some tokens to use to bond it.</p>
<h3 id="vps-hardware-specs-1"><a class="header" href="#vps-hardware-specs-1">VPS Hardware Specs</a></h3>
<p>You will need to rent a VPS to run your node on. One key reason for this is that your node <strong>must be able to send TCP data using both IPv4 and IPv6</strong> (as other nodes you talk to may use either protocol).</p>
<p>For the moment, we haven’t put a great amount of effort into optimizing concurrency to increase throughput, so don’t bother provisioning a beastly server with multiple cores. This will change when we get a chance to start doing performance optimizations in a more serious way. Sphinx packet decryption is CPU-bound, so once we optimize, more fast cores will be better.</p>
<p>For now, see the below rough specs:</p>
<ul>
<li>Processors: 2 cores are fine. Get the fastest CPUs you can afford.</li>
</ul>
<h4 id="for-mix-node"><a class="header" href="#for-mix-node">For mix node</a></h4>
<ul>
<li>RAM: Memory requirements are very low - typically a mix node may use only a few hundred MB of RAM.</li>
<li>Disks: The mixnodes require no disk space beyond a few bytes for the configuration files.</li>
</ul>
<h4 id="for-gateway"><a class="header" href="#for-gateway">For Gateway</a></h4>
<ul>
<li>RAM: Memory requirements depend on the amount of users your Gateway will be serving at any one time. If you’re just going to be using it yourself, then minimal RAM is fine. <strong>If you’re running your Gateway as part of a Service Grant, get something with at least 4GB RAM.</strong></li>
<li>Disks: much like the amount of RAM your Gateway could use, the amount of disk space required will vary with the amount of users your Gateway is serving. <strong>If you’re running your Gateway as part of a Service Grant, get something with at least 40GB storage.</strong></li>
</ul>
<footer id="last-change">Last change: 2024-04-24, commit: <a href="https://github.com/nymtech/nym/commit/c53b46ee1">c53b46ee1</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="mix-nodes"><a class="header" href="#mix-nodes">Mix Nodes</a></h1>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/mix-node-setup.html#admonition-warning"></a>
</div>
<div>
<p><strong>This is an archived page for backwards compatibility for existing node operators. To start a new node or migrate, follow the <a href="archive/nodes/../../nodes/nym-node.html"><code>nym-node</code> guides</a>.</strong> The content of this page is not updated since April 19th 2024. Eventually this page will be terminated!</p>
</div>
</div>
<blockquote>
<p>The Nym Mix Node binary was built in the <a href="archive/nodes/../../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code, go there first.</p>
</blockquote>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable. Exchange with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<h2 id="current-version-3"><a class="header" href="#current-version-3">Current version</a></h2>
<p>The last version before migration to <a href="archive/nodes/../../nodes/nym-node.html"><code>nym-node</code></a> was <code>1.1.35</code>.</p>
<p>The <code>nym-mix node</code> binary is currently one point version ahead of the rest of the platform binaries due to a patch applied between releases.</p>
<h2 id="preliminary-steps-3"><a class="header" href="#preliminary-steps-3">Preliminary steps</a></h2>
<p>Make sure you do the preparation listed in the <a href="archive/nodes/initial-steps.html">preliminary steps page</a> before setting up your Mix Node.</p>
<h2 id="mix-node-setup"><a class="header" href="#mix-node-setup">Mix node setup</a></h2>
<p>Now that you have built the <a href="archive/nodes/../../binaries/building-nym.html">codebase</a>, set up your <a href="https://nymtech.net/docs/wallet/desktop-wallet.html">wallet</a>, and have a VPS with the <code>nym-mix node</code> binary, you can set up your Mix Node with the instructions below.</p>
<p>To begin, move to <code>/target/release</code> directory from which you run the node commands:</p>
<pre><code>cd target/release
</code></pre>
<h3 id="viewing-command-help-2"><a class="header" href="#viewing-command-help-2">Viewing command help</a></h3>
<p>You can check that your binaries are properly compiled with:</p>
<pre><code>./nym-mixnode --help
</code></pre>
<p>Which should return a list of all available commands.</p>
<p>You can also check the various arguments required for individual commands with:</p>
<pre><code>./nym-mixnode &lt;COMMAND&gt; --help
</code></pre>
<blockquote>
<p>Adding <code>--no-banner</code> startup flag will prevent Nym banner being printed even if run in tty environment.</p>
</blockquote>
<h3 id="initialising-your-mix-node"><a class="header" href="#initialising-your-mix-node">Initialising your Mix Node</a></h3>
<p>To check available configuration options for initializing your node use:</p>
<pre><code>./nym-mixnode init --help
</code></pre>
<p>Initialise your Mix Node with the following command, replacing the value of <code>--id</code> with the moniker you wish to give your Mix Node. Your <code>--host</code> must be publicly routable on the internet in order to mix packets, and can be either an Ipv4 or IPv6 address. The <code>$(curl -4 https://ifconfig.me)</code> command returns your IP automatically using an external service. If you enter your IP address manually, enter it <strong>without</strong> any port information.</p>
<pre><code>./nym-mixnode init --id &lt;YOUR_ID&gt; --host $(curl -4 https://ifconfig.me) 
</code></pre>
<blockquote>
<p>The <code>init</code> command will refuse to destroy existing Mix Node keys.</p>
</blockquote>
<p>During the <code>init</code> process you will have the option to change the <code>http_api</code>, <code>verloc</code> and <code>mixnode</code> ports from their default settings. If you wish to change these in the future you can edit their values in the <code>config.toml</code> file created by the initialization process, which is located at <code>~/.nym/mixnodes/&lt;YOUR_ID&gt;/</code>.</p>
<h2 id="node-description-optional"><a class="header" href="#node-description-optional">Node Description (optional)</a></h2>
<p>In order to easily identify your node via human-readable information later on, you can <code>describe</code> your Mix Node with the following command:</p>
<pre><code>./nym-mixnode describe --id &lt;YOUR_ID&gt;
</code></pre>
<p>Node description is a short text that describes your node. It is displayed in the <code>./nym-mixnode list</code> command and in the <code>./nym-mixnode node-details --id &lt;YOUR_ID&gt;</code> command. It also shows up in the node explorer to let people know what your node is about and link to your website.</p>
<p>You can set your node description, by creating a file called <code>description.toml</code> and put it in the same directory as your <code>config.toml</code> file (<code>~/.nym/mixnodes/&lt;YOUR_ID&gt;/config/description.toml</code>). The file should look like this example:</p>
<pre><code class="language-toml">name = "Winston Smith"
description = "I am the Sphinx"
link = "https://nymtech.net"
location = "Giza, Egypt"
</code></pre>
<blockquote>
<p>Remember to restart your <code>nym-mixnode</code> process in order for the new description to be propagated.</p>
</blockquote>
<h2 id="running-your-mix-node"><a class="header" href="#running-your-mix-node">Running your Mix Node</a></h2>
<p>Run your Mix Node with:</p>
<pre><code>./nym-mixnode run --id &lt;YOUR_ID&gt;
</code></pre>
<p>Have a look at the saved configuration files in <code>$HOME/.nym/mixnodes/</code> to see more configuration options.</p>
<h2 id="bonding-your-mix-node"><a class="header" href="#bonding-your-mix-node">Bonding your Mix Node</a></h2>
<div id="admonition-caution" class="admonition admonish-warning" role="note" aria-labelledby="admonition-caution-title">
<div class="admonition-title">
<div id="admonition-caution-title">
<p>Caution</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/mix-node-setup.html#admonition-caution"></a>
</div>
<div>
<p>From <code>v1.1.3</code>, if you unbond your Mix Node that means you are leaving the mixnet and you will lose all your delegations (permanently). You can join again with the same identity key, however, you will start with <strong>no delegations</strong>.</p>
</div>
</div>
<p>To initialise, run and bond your Mix Node are the minimum steps to do in order for your Mix Node to work. However we recommend to do a few more steps before bonding. These steps will make it easier for you as a node operator on a long run as well as for others to possibly delegate Nym tokens to your Mix Node. These steps are:</p>
<ul>
<li><a href="archive/nodes/./mix-node-setup.html#node-description-optional">Describe your Mix Node</a></li>
<li><a href="archive/nodes/../../nodes/maintenance.html#configure-your-firewall">Configure your firewall</a></li>
<li><a href="archive/nodes/../../nodes/maintenance.html#vps-setup-and-automation">Automate your Mix Node</a></li>
<li>Set the <a href="archive/nodes/../../nodes/maintenance.html#set-the-ulimit-via-systemd-service-file">ulimit</a>, in case you haven’t automated with <a href="archive/nodes/../../nodes/maintenance.html#set-the-ulimit-on-non-systemd-based-distributions">systemd</a></li>
</ul>
<h3 id="bond-via-the-desktop-wallet-recommended-1"><a class="header" href="#bond-via-the-desktop-wallet-recommended-1">Bond via the Desktop wallet (recommended)</a></h3>
<p>You can bond your Mix Node via the Desktop wallet.</p>
<ul>
<li>
<p>Open your wallet, and head to the <code>Bond</code> page, then select the node type <code>Mixnode</code> and input your node details. Press <code>Next</code>.</p>
</li>
<li>
<p>Enter the <code>Amount</code>, <code>Operating cost</code> and <code>Profit margin</code> and press <code>Next</code>.</p>
</li>
<li>
<p>You will be asked to run a the <code>sign</code> command with your <code>mixnode</code> - copy and paste the long signature as the value of <code>--contract-msg</code> and run it.</p>
</li>
</ul>
<pre><code>./nym-mixnode sign --id &lt;YOUR_ID&gt; --contract-msg &lt;PAYLOAD_GENERATED_BY_THE_WALLET&gt;
</code></pre>
<ul>
<li>Copy the resulting signature:</li>
</ul>
<pre><code class="language-sh"># &gt;&gt;&gt; The base58-encoded signature is:
2bbDJSmSo9r9qdamTNygY297nQTVRyQaxXURuomVcRd7EvG9oEC8uW8fvZZYnDeeC9iWyG9mAbX2K8rWEAxZBro1
</code></pre>
<ul>
<li>And paste it into the wallet nodal, press <code>Next</code> and confirm the transaction.</li>
</ul>
<p><img src="archive/nodes/../../images/wallet-screenshots/wallet-sign.png" alt="Paste Signature" /><br />
<em>This image is just an example, copy-paste your own base58-encoded signature</em></p>
<ul>
<li>Your node will now be bonded and ready to mix at the beginning of the next epoch (at most 1 hour).</li>
</ul>
<blockquote>
<p>You are asked to <code>sign</code> a transaction on bonding so that the Mixnet smart contract is able to map your nym address to your node. This allows us to create a nonce for each account and defend against replay attacks.</p>
</blockquote>
<p>If everything worked, you’ll see your node running on the either the <a href="https://sandbox-explorer.nymtech.net">Sandbox testnet network explorer</a> or the <a href="https://explorer.nymtech.net">mainnet network explorer</a>, depending on which network you’re running.</p>
<p>Note that your node’s public identity key is displayed during startup, you can use it to identify your node in the list.</p>
<h3 id="bond-via-the-cli-power-users-1"><a class="header" href="#bond-via-the-cli-power-users-1">Bond via the CLI (power users)</a></h3>
<p>If you want to bond your Mix Node via the CLI, then check out the <a href="https://nymtech.net/docs/tools/nym-cli.html#bond-a-mix-node">relevant section in the Nym CLI</a> docs.</p>
<h2 id="node-families"><a class="header" href="#node-families">Node Families</a></h2>
<p>Node family involves setting up a group of Mix Nodes that work together to provide greater privacy and security for network communications. This is achieved by having the nodes in the family share information and routes, creating a decentralized network that makes it difficult for third parties to monitor or track communication traffic.</p>
<h3 id="create-a-node-family"><a class="header" href="#create-a-node-family">Create a Node Family</a></h3>
<p>To create a Node family, you will need to install and configure multiple Mix Nodes, and then use the CLI to link them together into a family. Once your Node family is up and running, you can use it to route your network traffic through a series of nodes, obscuring the original source and destination of the communication.</p>
<p>You can use either <code>nym-cli</code> which can be downloaded from the <a href="https://github.com/nymtech/nym/releases">release page</a> or compiling <code>nyxd</code>.</p>
<p>Change directory by <code>cd &lt;PATH&gt;/&lt;TO&gt;/&lt;THE&gt;/&lt;RELEASE&gt;</code> and run the following on the family head to obtain the signature for the member:</p>
<pre><code>./nym-mixnode sign --id &lt;YOUR_ID&gt; --text &lt;TEXT&gt;
</code></pre>
<p>Using <code>nym-cli</code>:</p>
<blockquote>
<p><code>--mnemonic</code> is the mnemonic of the member wanting to be the head of family.</p>
</blockquote>
<pre><code>/nym-cli cosmwasm execute &lt;WALLET_ADDRESS&gt; '{"create_family": {"signature": "&lt;base58-encoded-signature&gt;","family_head": "&lt;TEXT&gt;","owner_signature":"&lt;NODE_OWNER_SIGNATURE&gt;","label": "&lt;NODE_LABEL&gt;"}}' --mnemonic &lt;MNEMONIC_FROM_THE_NODE_TO_THE_HEAD&gt;
</code></pre>
<p>Using <code>nyxd</code>:</p>
<blockquote>
<p><code>--from</code> is mnemonic of the member wanting to join the family.</p>
</blockquote>
<pre><code>./nyxd tx wasm execute ${MIXNET-CONTRACT} '{"join_family": {"signature": "&lt;base58-encoded-signature&gt;","family_head": "&lt;TEXT&gt;"}}' --node ${VALIDATOR-ENDPOINT} --from mix1 --chain-id nyx --gas-prices 0.025unym --gas auto --gas-adjustment 1.3 -y -b block
</code></pre>
<p>To get the node owner signature, use:</p>
<p><code>./nym-mixnode node-details --id &lt;NODE_ID&gt;</code></p>
<h3 id="joining-a-node-family"><a class="header" href="#joining-a-node-family">Joining a Node Family</a></h3>
<p>Change directory by <code>cd &lt;PATH&gt;/&lt;TO&gt;/&lt;THE&gt;/&lt;RELEASE&gt;</code> and run the following on the family head to obtain the signature for the member:</p>
<pre><code>./nym-mixnode sign --id &lt;YOUR_ID&gt; --text &lt;TEXT&gt;
</code></pre>
<p>Using <code>nym-cli</code>:</p>
<pre><code>./nym-cli cosmwasm execute &lt;WALLET_ADDRESS&gt; '{"join_family": {"signature": "&lt;base58-encoded-signature&gt;","family_head": "&lt;TEXT&gt;","owner_signautre": "&lt;OWNER_SIGNATURE_FROM_NODE_TO_JOIN&gt;", "label":"&lt;NODE_TO_JOIN_LABEL&gt;"}}'  --mnemonic &lt;MNEMONIC_FROM_NODE_TO_JOIN&gt;
</code></pre>
<p>Using <code>nyxd</code>:</p>
<pre><code>./nyxd tx wasm execute ${MIXNET-CONTRACT} '{"join_family": {"signature": "&lt;base58-encoded-signature&gt;","family_head": "&lt;TEXT&gt;"}}' --node ${VALIDATOR-ENDPOINT} --from mix1 --chain-id nyx --gas-prices 0.025unym --gas auto --gas-adjustment 1.3 -y -b block
</code></pre>
<p>To get the node owner signature, use:</p>
<p><code>./nym-mixnode node-details --id &lt;NODE_ID&gt;</code></p>
<h3 id="leaving-a-family"><a class="header" href="#leaving-a-family">Leaving a family</a></h3>
<p>If wanting to leave, run the same initial command as above, followed by:</p>
<p>Using <code>nym-cli</code>:</p>
<pre><code>./nym-cli cosmwasm execute &lt;WALLET_ADDRESS&gt; '{"leave_family": {"signature": "&lt;base58-encoded-signature&gt;","family_head": "&lt;TEXT&gt;","owner_signautre": "&lt;OWNER_IGNATURE_FROM_NODE_TO_LEAVE&gt;"}}'  --mnemonic &lt;MNEMONIC_FROM_NODE_TO_LEAVE&gt;
</code></pre>
<p>Using <code>nyxd</code>:</p>
<pre><code>./nyxd tx wasm execute ${MIXNET-CONTRACT} '{"join_family": {"signature": "&lt;base58-encoded-signature&gt;","family_head": "&lt;TEXT&gt;"}}' --node ${VALIDATOR-ENDPOINT} --from mix1 --chain-id nyx --gas-prices 0.025unym --gas auto --gas-adjustment 1.3 -y -b block
</code></pre>
<h2 id="checking-that-your-node-is-mixing-correctly"><a class="header" href="#checking-that-your-node-is-mixing-correctly">Checking that your node is mixing correctly</a></h2>
<h3 id="network-explorers"><a class="header" href="#network-explorers">Network explorers</a></h3>
<p>Once you’ve started your Mix Node and it connects to the validator, your node will automatically show up in the ‘Mix Nodes’ section of either the Nym Network Explorers:</p>
<ul>
<li><a href="https://explorer.nymtech.net/overview">Mainnet</a></li>
<li><a href="https://sandbox-explorer.nymtech.net/">Sandbox testnet</a></li>
</ul>
<p>Enter your <strong>identity key</strong> to find your node. There are numerous statistics about your node on that page that are useful for checking your up-time history, packets mixed, and any delegations your node may have.</p>
<p>There are also 2 community explorers which have been created by <a href="https://nodes.guru">Nodes Guru</a>:</p>
<ul>
<li><a href="https://mixnet.explorers.guru/">Mainnet</a></li>
<li><a href="https://sandbox.mixnet.explorers.guru/">Sandbox testnet</a></li>
</ul>
<h2 id="maintenance-1"><a class="header" href="#maintenance-1">Maintenance</a></h2>
<p>For Mix Node upgrade, firewall setup, port configuration, API endpoints, VPS suggestions, automation and more, see the <a href="archive/nodes/../../nodes/maintenance.html">maintenance page</a></p>
<footer id="last-change">Last change: 2024-04-24, commit: <a href="https://github.com/nymtech/nym/commit/c53b46ee1">c53b46ee1</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="gateways"><a class="header" href="#gateways">Gateways</a></h1>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/gateway-setup.html#admonition-warning"></a>
</div>
<div>
<p><strong>This is an archived page for backwards compatibility for existing node operators. To start a new node or migrate, follow the <a href="archive/nodes/../../nodes/nym-node.html"><code>nym-node</code> guides</a>.</strong> The content of this page is not updated since April 19th 2024. Eventually this page will be terminated!</p>
</div>
</div>
<blockquote>
<p>The Nym gateway was built in the <a href="archive/nodes/../../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code, go there first.</p>
</blockquote>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/gateway-setup.html#admonition-info"></a>
</div>
<div>
<p>As a result of <a href="archive/nodes/../faq/smoosh-faq.html">Project Smoosh</a>, the current version of <code>nym-gateway</code> binary also contains <code>nym-network-requester</code> functionality which can be enabled <a href="archive/nodes/./gateway-setup.html#initialising-gateway-with-network-requester">by the operator</a>. This combination is a basis of <em><strong>Nym Exit Gateway</strong></em> node - an essential piece in our new setup. Please read more in our <a href="archive/nodes/../faq/smoosh-faq.html">Project Smoosh FAQ</a> and <a href="archive/nodes/../../legal/exit-gateway.html">Exit Gateway</a> pages. We recommend operators begin to shift their setups to this new combined node, instead of operating two separate binaries.</p>
</div>
</div>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable. Exchange with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<h2 id="current-version-4"><a class="header" href="#current-version-4">Current version</a></h2>
<p>The last version before migration to <a href="archive/nodes/../../nodes/nym-node.html"><code>nym-node</code></a> was <code>1.1.33</code>.</p>
<h2 id="preliminary-steps-4"><a class="header" href="#preliminary-steps-4">Preliminary steps</a></h2>
<p>Make sure you do the preparation listed in the <a href="archive/nodes/initial-steps.html">preliminary steps page</a> before setting up your Gateway.</p>
<h2 id="gateway-setup"><a class="header" href="#gateway-setup">Gateway setup</a></h2>
<p>Now that you have built the codebase, set up your wallet, and have a VPS with the <code>nym-gateway</code> binary, you can set up your gateway with the instructions below.</p>
<p>To begin, move to <code>/target/release</code> directory from which you run the node commands:</p>
<pre><code>cd target/release
</code></pre>
<h3 id="viewing-command-help-3"><a class="header" href="#viewing-command-help-3">Viewing command help</a></h3>
<p>You can check that your binaries are properly compiled with:</p>
<pre><code>./nym-gateway --help
</code></pre>
<p>You can also check the various arguments required for individual commands with:</p>
<pre><code>./nym-gateway &lt;COMMAND&gt; --help
</code></pre>
<blockquote>
<p>Adding <code>--no-banner</code> startup flag will prevent Nym banner being printed even if run in tty environment.</p>
</blockquote>
<h2 id="initialising-your-gateway"><a class="header" href="#initialising-your-gateway">Initialising your Gateway</a></h2>
<p>As Nym developers build towards <a href="archive/nodes/../../legal/exit-gateway.html">Exit Gateway</a> functionality, operators can now run their <code>nym-gateway</code> binary with inbuilt Network Requester and include the our new <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">exit policy</a>. Considering the plan to <a href="archive/nodes/../faq/smoosh-faq.html"><em>smoosh</em></a> all the nodes into one binary and have wide opened Exit Gateways, we recommend this setup, instead of operating two separate binaries.</p>
<div id="admonition-warning-1" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-1-title">
<div class="admonition-title">
<div id="admonition-warning-1-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/gateway-setup.html#admonition-warning-1"></a>
</div>
<div>
<p>Before you start an Exit Gateway, read our <a href="archive/nodes/../../legal/exit-gateway.html">Operators Legal Forum</a> page and <a href="archive/nodes/../faq/smoosh-faq.html"><em>Project Smoosh FAQ</em></a>.</p>
</div>
</div>
<div id="admonition-info-1" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-1-title">
<div class="admonition-title">
<div id="admonition-info-1-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/gateway-setup.html#admonition-info-1"></a>
</div>
<div>
<p>There has been an ongoing development with dynamic upgrades. Follow the status of the Project Smoosh <a href="archive/nodes/../faq/smoosh-faq.html#what-are-the-changes">changes</a> and the progression state of exit policy <a href="archive/nodes/../faq/smoosh-faq.html#how-will-the-exit-policy-be-implemented">implementation</a> to be up to date with the current design.</p>
</div>
</div>
<p><strong>Note:</strong> Due to the development towards Exit Gateway functionality the <code>--host</code> flag has been replaced with <code>--listening-address</code>, this is the IP address which is used for receiving sphinx packets and listening to client data. Another flag <code>--public-ips</code> is required; it’s a comma separated list of IP’s that are announced to the <code>nym-api</code>, it is usually the address which is used for bonding.</p>
<h3 id="initialising-exit-gateway"><a class="header" href="#initialising-exit-gateway">Initialising Exit Gateway</a></h3>
<p>An operator can initialise the Exit Gateway functionality by adding Network Requester with the new exit policy option:</p>
<pre><code>./nym-gateway init --id &lt;ID&gt; --listening-address 0.0.0.0 --public-ips "$(curl -4 https://ifconfig.me)" --with-network-requester --with-exit-policy true
</code></pre>
<p>You can see that the printed information besides <em>identity</em> and <em>sphinx keys</em> also includes a long string called <em>address</em>. This is the address to be provided to your local <a href="https://nymtech.net/docs/clients/socks5-client.html">socks5 client</a> as a <code>--provider</code> if you wish to connect to your own Exit Gateway.</p>
<p>Additionally</p>
<h4 id="add-network-requester-to-an-existing-gateway"><a class="header" href="#add-network-requester-to-an-existing-gateway">Add Network Requester to an existing Gateway</a></h4>
<p>If you already <a href="archive/nodes/../../nodes/manual-upgrade.html">upgraded</a> your Gateway to the <a href="archive/nodes/./gateway-setup.html#current-version">latest version</a> and initialised without a Network Requester, you can easily change its functionality to Exit Gateway with a command <code>setup-network-requester</code>.</p>
<p>See the options:</p>
<pre><code>./nym-gateway setup-network-requester --help
</code></pre>
<p>To setup Exit Gateway functionality with our new <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">exit policy</a> add a flag <code>--with-exit-policy true</code>.</p>
<pre><code>./nym-gateway setup-network-requester --enabled true --with-exit-policy true --id &lt;ID&gt;
</code></pre>
<p>Say we have a Gateway with <code>&lt;ID&gt;</code> as <code>new-gateway</code>, originally initialised and ran without the Exit Gateway functionality. To change the setup, run:</p>
<pre><code>./nym-gateway setup-network-requester --enabled true --with-exit-policy true --id new-gateway
</code></pre>
<p>In case there are any unexpected problems, you can also change it manually by editing the Gateway config file stored in <code>/home/user/.nym/gateways/&lt;ID&gt;/config/config.toml</code> where the line under <code>[network_requester]</code> needs to be edited from <code>false</code> to <code>true</code>.</p>
<pre><code>[network_requester]
# Specifies whether Network Requester service is enabled in this process.
enabled = true
</code></pre>
<p>Save, exit and restart your Gateway. Now you are an operator of post-smooshed Exit Gateway.</p>
<h4 id="enable-nym-exit-policy-to-an-existing-gateway-with-network-requester-functionality"><a class="header" href="#enable-nym-exit-policy-to-an-existing-gateway-with-network-requester-functionality">Enable Nym exit policy to an existing Gateway with Network Requester functionality</a></h4>
<p>In case you already added Network Requester functionality to your Gateway as described above but haven’t enabled the <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">exit policy</a> there is an easy tweak to do so and turn your node into <a href="archive/nodes/../faq/smoosh-faq.html#what-are-the-changes">Nym Exit Gateway</a>.</p>
<p>Open the config file stored at <code>.nym/gateways/&lt;ID&gt;/config/network_requester_config.toml</code> and set:</p>
<pre><code class="language-sh">use_deprecated_allow_list = false
</code></pre>
<p>Save, exit and restart your Gateway. Now you are an operator of post-smooshed Exit gateway.</p>
<div id="admonition-info-2" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-2-title">
<div class="admonition-title">
<div id="admonition-info-2-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/gateway-setup.html#admonition-info-2"></a>
</div>
<div>
<p>All information about Network Requester part of your Exit Gateway is in <code>/home/user/.nym/gateways/&lt;ID&gt;/config/network_requester_config.toml</code>.</p>
</div>
</div>
<p>For now you can run Gateway without Network Requester or with and without the new exit policy. This will soon change as we inform in our <a href="archive/nodes/../faq/smoosh-faq.html#how-will-the-exit-policy-be-implemented">Project Smoosh FAQ</a>.</p>
<p>To read more about the configuration like whitelisted outbound requesters in <code>allowed.list</code> and other useful information, see the page <a href="archive/nodes/network-requester-setup.html#using-your-network-requester"><em>Network Requester whitelist</em></a>.</p>
<h4 id="initialising-gateway-without-network-requester"><a class="header" href="#initialising-gateway-without-network-requester">Initialising Gateway without Network Requester</a></h4>
<p>In case you don’t want to run your Gateway with the Exit Gateway functionality, you still can run a simple Gateway.</p>
<p>To check available configuration options use:</p>
<pre><code> ./nym-gateway init --help
</code></pre>
<p>The following command returns a Gateway on your current IP with the <code>&lt;ID&gt;</code> of <code>simple-gateway</code>:</p>
<pre><code>./nym-gateway init --id simple-gateway --listening-address 0.0.0.0 --public-ips "$(curl -4 https://ifconfig.me)"
</code></pre>
<p>The <code>$(curl -4 https://ifconfig.me)</code> command above returns your IP automatically using an external service. Alternatively, you can enter your IP manually if you wish. If you do this, remember to enter your IP <strong>without</strong> any port information.</p>
<h2 id="running-your-gateway"><a class="header" href="#running-your-gateway">Running your Gateway</a></h2>
<p>The <code>run</code> command starts the Gateway:</p>
<pre><code>./nym-gateway run --id &lt;ID&gt;
</code></pre>
<h2 id="bonding-your-gateway"><a class="header" href="#bonding-your-gateway">Bonding your Gateway</a></h2>
<div id="admonition-info-3" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-3-title">
<div class="admonition-title">
<div id="admonition-info-3-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/gateway-setup.html#admonition-info-3"></a>
</div>
<div>
<p>Before you bond your Gateway, please make sure the <a href="archive/nodes/../../nodes/maintenance.html#configure-your-firewall">firewall configuration</a> is setup so your Gateway can be reached from the outside. You can also setup WSS and automate your Gateway to simplify the operation overhead. We highly recommend to run any of these steps before bonding to prevent disruption of your Gateway’s routing score later on.</p>
</div>
</div>
<h3 id="via-the-desktop-wallet-recommended"><a class="header" href="#via-the-desktop-wallet-recommended">Via the Desktop wallet (recommended)</a></h3>
<p>You can bond your Gateway via the Desktop wallet. <strong>Make sure your Gateway is running first</strong>, then follow the steps below:</p>
<ol>
<li>
<p>Open your wallet, and head to the <code>Bonding</code> page, then select the node type <code>Gateway</code> and input your node details. Press <code>Next</code>.</p>
</li>
<li>
<p>Enter the <code>Amount</code>, <code>Operating cost</code> and press <code>Next</code>.</p>
</li>
<li>
<p>You will be asked to run a the <code>sign</code> command with your <code>gateway</code> - copy and paste the long signature <code>&lt;PAYLOAD_GENERATED_BY_THE_WALLET&gt;</code> and paste it as a value of <code>--contract-msg</code> in the following command:</p>
</li>
</ol>
<pre><code>./nym-gateway sign --id &lt;YOUR_ID&gt; --contract-msg &lt;PAYLOAD_GENERATED_BY_THE_WALLET&gt;
</code></pre>
<p>It will look something like this (as <code>&lt;YOUR_ID&gt;</code> we used <code>supergateway</code>):</p>
<details id="admonition-console-output" class="admonition admonish-example" role="note" aria-labelledby="admonition-console-output-title">
<summary class="admonition-title">
<div id="admonition-console-output-title">
<p>Console output</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/gateway-setup.html#admonition-console-output"></a>
</summary>
<div>
<pre><code>./nym-gateway sign --id supergateway --contract-msg 2Mf8xYytgEeyJke9LA7TjhHoGQWNBEfgHZtTyy2krFJfGHSiqy7FLgTnauSkQepCZTqKN5Yfi34JQCuog9k6FGA2EjsdpNGAWHZiuUGDipyJ6UksNKRxnFKhYW7ri4MRduyZwbR98y5fQMLAwHne1Tjm9cXYCn8McfigNt77WAYwBk5bRRKmC34BJMmWcAxphcLES2v9RdSR68tkHSpy2C8STfdmAQs3tZg8bJS5Qa8pQdqx14TnfQAPLk3QYCynfUJvgcQTrg29aqCasceGRpKdQ3Tbn81MLXAGAs7JLBbiMEAhCezAr2kEN8kET1q54zXtKz6znTPgeTZoSbP8rzf4k2JKHZYWrHYF9JriXepuZTnyxAKAxvGFPBk8Z6KAQi33NRQkwd7MPyttatHna6kG9x7knffV6ebGzgRBf7NV27LurH8x4L1uUXwm1v1UYCA1WSBQ9Pp2JW69k5v5v7G9gBy8RUcZnMbeL26Qqb8WkuGcmuHhaFfoqSfV7PRHPpPT4M8uRqUyR4bjUtSJJM1yh6QSeZk9BEazzoJqPeYeGoiFDZ3LMj2jesbJweQR4caaYuRczK92UGSSqu9zBKmE45a


      _ __  _   _ _ __ ___
     | '_ \| | | | '_ \ _ \
     | | | | |_| | | | | | |
     |_| |_|\__, |_| |_| |_|
            |___/

             (nym-gateway - version v1.1.&lt;XX&gt;)


&gt;&gt;&gt; attempting to sign 2Mf8xYytgEeyJke9LA7TjhHoGQWNBEfgHZtTyy2krFJfGHSiqy7FLgTnauSkQepCZTqKN5Yfi34JQCuog9k6FGA2EjsdpNGAWHZiuUGDipyJ6UksNKRxnFKhYW7ri4MRduyZwbR98y5fQMLAwHne1Tjm9cXYCn8McfigNt77WAYwBk5bRRKmC34BJMmWcAxphcLES2v9RdSR68tkHSpy2C8STfdmAQs3tZg8bJS5Qa8pQdqx14TnfQAPLk3QYCynfUJvgcQTrg29aqCasceGRpKdQ3Tbn81MLXAGAs7JLBbiMEAhCezAr2kEN8kET1q54zXtKz6znTPgeTZoSbP8rzf4k2JKHZYWrHYF9JriXepuZTnyxAKAxvGFPBk8Z6KAQi33NRQkwd7MPyttatHna6kG9x7knffV6ebGzgRBf7NV27LurH8x4L1uUXwm1v1UYCA1WSBQ9Pp2JW69k5v5v7G9gBy8RUcZnMbeL26Qqb8WkuGcmuHhaFfoqSfV7PRHPpPT4M8uRqUyR4bjUtSJJM1yh6QSeZk9BEazzoJqPeYeGoiFDZ3LMj2jesbJweQR4caaYuRczK92UGSSqu9zBKmE45a
&gt;&gt;&gt; decoding the message...
&gt;&gt;&gt; message to sign: {"nonce":0,"algorithm":"ed25519","message_type":"gateway-bonding","content":{"sender":"n1ewmme88q22l8syvgshqma02jv0vqrug9zq9dy8","proxy":null,"funds":[{"denom":"unym","amount":"100000000"}],"data":{"gateway":{"host":"62.240.134.189","mix_port":1789,"clients_port":9000,"location":"62.240.134.189","sphinx_key":"FKbuN7mPdoCG9jA3CkAfXxC5X4rHhqeMVtmfRtJ3cFZd","identity_key":"3RoAhR8gEdfBETMjm2vbMFzKddxXDdE9ygBAnJHWqSzD","version":"1.1.13"}}}}
&gt;&gt;&gt; The base58-encoded signature is:
2SPDjLjX4b6XEtkgG7yD8Znsb1xycL1edFvRK4JcVnPsM9k6HXEUUeVS6rswRiYxoj1bMgiRKyPDwiksiuyxu8Xi
</code></pre>
</div>
</details>
<ul>
<li>Copy the resulting signature:</li>
</ul>
<pre><code class="language-sh"># &gt;&gt;&gt; The base58-encoded signature is:
2SPDjLjX4b6XEtkgG7yD8Znsb1xycL1edFvRK4JcVnPsM9k6HXEUUeVS6rswRiYxoj1bMgiRKyPDwiksiuyxu8Xi
</code></pre>
<ul>
<li>And paste it into the wallet nodal, press <code>Next</code> and confirm the transaction.</li>
</ul>
<p><img src="archive/nodes/../../images/wallet-screenshots/wallet-gateway-sign.png" alt="Paste Signature" />
<em>This image is just an example, copy-paste your own base58-encoded signature.</em></p>
<ul>
<li>Your Gateway is now bonded.</li>
</ul>
<blockquote>
<p>You are asked to <code>sign</code> a transaction on bonding so that the Mixnet smart contract is able to map your Nym address to your node. This allows us to create a nonce for each account and defend against replay attacks.</p>
</blockquote>
<h3 id="via-the-cli-power-users"><a class="header" href="#via-the-cli-power-users">Via the CLI (power users)</a></h3>
<p>If you want to bond your Gateway via the CLI, then check out the <a href="https://nymtech.net/docs/tools/nym-cli.html#bond-a-mix-node">relevant section in the Nym CLI</a> docs.</p>
<h2 id="maintenance-2"><a class="header" href="#maintenance-2">Maintenance</a></h2>
<p>For Gateway upgrade, firewall setup, port configuration, API endpoints, VPS suggestions, automation, WSS setup and more, see the <a href="archive/nodes/../../nodes/maintenance.html">maintenance page</a></p>
<footer id="last-change">Last change: 2024-08-06, commit: <a href="https://github.com/nymtech/nym/commit/7e36595d8">7e36595d8</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="network-requester"><a class="header" href="#network-requester">Network Requester</a></h1>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/network-requester-setup.html#admonition-warning"></a>
</div>
<div>
<p><strong>This is an archived page for backwards compatibility for existing node operators. To start a new node or migrate, follow the <a href="archive/nodes/../../nodes/nym-node.html"><code>nym-node</code> guides</a>.</strong> The content of this page is not updated since April 19th 2024. Eventually this page will be terminated!</p>
</div>
</div>
<blockquote>
<p>Nym Network Requester was built in the <a href="archive/nodes/../../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code, go there first.</p>
</blockquote>
<blockquote>
<p>Any syntax in <code>&lt;&gt;</code> brackets is a user’s unique variable. Exchange with a corresponding name without the <code>&lt;&gt;</code> brackets.</p>
</blockquote>
<h2 id="current-version-5"><a class="header" href="#current-version-5">Current version</a></h2>
<p>The last version before migration to <a href="archive/nodes/../../nodes/nym-node.html"><code>nym-node</code></a> was <code>1.1.33</code>.</p>
<h2 id="preliminary-steps-5"><a class="header" href="#preliminary-steps-5">Preliminary steps</a></h2>
<p>Make sure you do the preparation listed in the <a href="archive/nodes/initial-steps.html">preliminary steps page</a> before setting up your Network Requester.</p>
<h2 id="network-requester-whitelist"><a class="header" href="#network-requester-whitelist">Network Requester Whitelist</a></h2>
<p>If you have access to a server, you can run the Network Requester, which allows Nym users to send outbound requests from their local machine through the Mixnet to a server, which then makes the request on their behalf, shielding them (and their metadata) from clearnet, untrusted and unknown infrastructure, such as email or message client servers.</p>
<p>By default the Network Requester is <strong>not</strong> an open proxy (although it can be used as one). It uses a file called <code>allowed.list</code> (located in <code>~/.nym/service-providers/network-requester/&lt;NETWORK-REQUESTER-ID&gt;/</code>) as a whitelist for outbound requests.</p>
<p><strong>Note:</strong> If you run Network Requester as a part of the Exit Gateway (suggested setup) the <code>allowed.list</code> will be stored in <code>~/.nym/gateways/&lt;ID&gt;/data/network-requester-data/allowed.list</code>.</p>
<p>Any request to a URL which is not on this list will be blocked.</p>
<p>On startup, if this file is not present, the requester will grab the default whitelist from <a href="https://nymtech.net/.wellknown/network-requester/standard-allowed-list.txt">Nym’s default list</a> automatically.</p>
<p>This default whitelist is useful for knowing that the majority of Network Requesters are able to support certain apps ‘out of the box’.</p>
<p><strong>Operators of a Network Requester are of course free to edit this file and add the URLs of services they wish to support to it!</strong> You can find instructions below on adding your own URLs or IPs to this list.</p>
<p>The domains and IPs on the default whitelist can be broken down by application as follows:</p>
<pre><code># Keybase
keybaseapi.com
s3.amazonaws.com
amazonaws.com
twitter.com
keybase.io
gist.githubusercontent.com

# Used to for uptime healthcheck (see the section on testing your requester below for more)
nymtech.net

# Blockstream Green Bitcoin Wallet
blockstream.info
blockstream.com
greenaddress.it

# Electrum Bitcoin Wallet
electrum.org

# Helios Ethereum Client
alchemy.com
lightclientdata.org
p2pify.com

# Telegram - these IPs have been copied from https://core.telegram.org/resources/cidr.txt as Telegram does
# not seem to route by domain as the other apps on this list do
91.108.56.0/22
91.108.4.0/22
91.108.8.0/22
91.108.16.0/22
91.108.12.0/22
149.154.160.0/20
91.105.192.0/23
91.108.20.0/22
185.76.151.0/24
2001:b28:f23d::/48
2001:b28:f23f::/48
2001:67c:4e8::/48
2001:b28:f23c::/48
2a0a:f280::/32

# nym matrix server
nymtech.chat

# generic matrix server backends
vector.im
matrix.org

# monero desktop - mainnet
212.83.175.67
212.83.172.165
176.9.0.187
88.198.163.90
95.217.25.101
136.244.105.131
104.238.221.81
66.85.74.134
88.99.173.38
51.79.173.165

# monero desktop - stagenet
162.210.173.150
176.9.0.187
88.99.173.38
51.79.173.165

# alephium 
alephium.org

</code></pre>
<h2 id="network-requester-directory"><a class="header" href="#network-requester-directory">Network Requester Directory</a></h2>
<p>You can find a list of Network Requesters running the default whitelist in the <a href="https://explorer.nymtech.net/network-components/service-providers">explorer</a>. This list comprises of the NRs running as infrastructure for NymConnect.</p>
<blockquote>
<p>We are currently working on a smart-contract based solution more in line with how Mix Nodes and Gateways announce themselves to the network.</p>
</blockquote>
<h2 id="viewing-command-help-4"><a class="header" href="#viewing-command-help-4">Viewing command help</a></h2>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="archive/nodes/network-requester-setup.html#admonition-info"></a>
</div>
<div>
<p>If you run your Network Requester as a part of your Exit Gateway according to the suggested setup, please skip this part of the page and read about <a href="archive/nodes/./gateway-setup.html#initialising-gateway-with-network-requester">Exit Gateway setup</a> instead.</p>
</div>
</div>
<p>To begin, move to <code>/target/release</code> directory from which you run the node commands:</p>
<pre><code>cd target/release
</code></pre>
<p>The <code>./nym-network-requester --help </code> command can be used to show a list of available parameters.</p>
<p>You can check the required parameters for available commands by running:</p>
<pre><code>./nym-network-requester &lt;COMMAND&gt; --help
</code></pre>
<blockquote>
<p>Adding <code>--no-banner</code> startup flag will prevent Nym banner being printed even if run in tty environment.</p>
</blockquote>
<h2 id="initializing-and-running-your-network-requester"><a class="header" href="#initializing-and-running-your-network-requester">Initializing and running your Network Requester</a></h2>
<p>The Network Requester needs to be initialized before it can be run. This is required for the embedded nym-client to connect successfully to the Mixnet. We want to specify an <code>&lt;ID&gt;</code> using the <code>--id</code> command and give it a value of your choice. The following command will achieve that:</p>
<pre><code> ./nym-network-requester init --id &lt;YOUR_ID&gt;
</code></pre>
<p>Now that we have initialized our network-requester, we can start it with the following command:</p>
<pre><code> ./nym-network-requester run --id &lt;YOUR_ID&gt;
</code></pre>
<h2 id="using-your-network-requester"><a class="header" href="#using-your-network-requester">Using your Network Requester</a></h2>
<p>The next thing to do is use your requester, share its address with friends (or whoever you want to help privacy-enhance their app traffic). Is this safe to do? If it was an open proxy, this would be unsafe, because any Nym user could make network requests to any system on the internet.</p>
<p>To make things a bit less stressful for administrators, the Network Requester drops all incoming requests by default. In order for it to make requests, you need to add specific domains to the <code>allowed.list</code> file at <code>$HOME/.nym/service-providers/network-requester/allowed.list</code> or if Network Requester is ran as a part of <a href="archive/nodes/./gateway-setup.html#initialising-gateway-with-network-requester">Exit Gateway</a>, the <code>allowed.list</code> will be stored in <code>~/.nym/gateways/&lt;ID&gt;/data/network-requester-data/allowed.list</code></p>
<h3 id="global-vs-local-allow-lists"><a class="header" href="#global-vs-local-allow-lists">Global vs local allow lists</a></h3>
<p>Your Network Requester will check for a domain against 2 lists before allowing traffic through for a particular domain or IP.</p>
<ul>
<li>
<p>The first list is the default list on the <a href="https://nymtech.net/.wellknown/network-requester/standard-allowed-list.txt">nymtech.net server</a>. Your Requester will not check against this list every time, but instead will keep a record of accepted domains in memory.</p>
</li>
<li>
<p>The second is the local <code>allowed.list</code> file.</p>
</li>
</ul>
<h3 id="supporting-custom-domains-with-your-network-requester"><a class="header" href="#supporting-custom-domains-with-your-network-requester">Supporting custom domains with your Network Requester</a></h3>
<p>It is easy to add new domains and services to your Network Requester - simply find out which endpoints (both URLs and raw IP addresses are supported) you need to whitelist, and then add these endpoints to your <code>allowed.list</code>.</p>
<blockquote>
<p>In order to keep things more organised, you can now use comments in the <code>allow.list</code> like the example at the top of this page.</p>
</blockquote>
<p>How to go about this? Have a look in your <code>nym-network-requester</code> config directory:</p>
<pre><code># nym-network-requester binary
ls -lt $HOME/.nym/service-providers/network-requester/*/data | grep "list"

# nym-gateway binary
ls -lt $HOME/.nym/gateways/*/data/network-requester-data | grep "list"

# returns: allowed.list  unknown.list
</code></pre>
<p>We already know that <code>allowed.list</code> is what lets requests go through. All unknown requests are logged to <code>unknown.list</code>. If you want to try using a new client type, just start the new application, point it at your local <a href="https://nymtech.net/docs/clients/socks5-client.html">socks client</a> (configured to use your remote <code>nym-network-requester</code>), and keep copying URLs from <code>unknown.list</code> into <code>allowed.list</code> (it may take multiple tries until you get all of them, depending on the complexity of the application). Make sure to delete the copied ones in <code>unknown.list</code> and restart your Exit Gateway or standalone Network Requester.</p>
<blockquote>
<p>If you are adding custom domains, please note that whilst they may appear in the logs of your network-requester as something like <code>api-0.core.keybaseapi.com:443</code>, you <strong>only need</strong> to include the main domain name, in this instance <code>keybaseapi.com</code></p>
</blockquote>
<h3 id="running-an-open-proxy"><a class="header" href="#running-an-open-proxy">Running an open proxy</a></h3>
<p>If you <em>really</em> want to run an open proxy, perhaps for testing purposes for your own use or among a small group of trusted friends, it is possible to do so. You can disable Network checks by passing the flag <code>--open-proxy</code> flag when you run it. If you run in this configuration, you do so at your own risk.</p>
<h2 id="testing-your-network-requester"><a class="header" href="#testing-your-network-requester">Testing your Network Requester</a></h2>
<ol>
<li>
<p>Make sure <code>nymtech.net</code> is in your <code>allowed.list</code> (remember to restart your Network Requester).</p>
</li>
<li>
<p>Ensure that your <code>nym-network-requester</code> is initialized and running.</p>
</li>
<li>
<p>In another terminal window, run the following:</p>
</li>
</ol>
<pre><code>curl -x socks5h://localhost:1080 https://nymtech.net/.wellknown/connect/healthcheck.json
</code></pre>
<p>This command should return the following:</p>
<pre><code>{ "status": "ok" }
</code></pre>
<footer id="last-change">Last change: 2024-04-24, commit: <a href="https://github.com/nymtech/nym/commit/c53b46ee1">c53b46ee1</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="frequently-asked-questions"><a class="header" href="#frequently-asked-questions">Frequently Asked Questions</a></h1>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="archive/faq/mixnodes-faq.html#admonition-warning"></a>
</div>
<div>
<p><strong>This is an archived page for backwards compatibility. The content of this page is not updated since April 19th 2024. Eventually this page will be terminated!</strong></p>
</div>
</div>
<h2 id="nym-mixnet-1"><a class="header" href="#nym-mixnet-1">Nym Mixnet</a></h2>
<p>To see different stats about Nym Mixnet live, we recommend you to visit <a href="https://status.notrustverify.ch/d/CW3L7dVVk/nym-mixnet?orgId=1">status.notrustverify.ch</a> built by <a href="https://notrustverify.ch/">No Trust Verify</a> crew, one of the squads within Nym core community.</p>
<iframe src="https://status.notrustverify.ch/d-solo/CW3L7dVVk/nym-mixnet?orgId=1&from=1702215592419&to=1704807592419&panelId=12" width="800" height="400" frameborder="0"></iframe>
<h3 id="is-there-an-explorer-for-nym-mixnet-1"><a class="header" href="#is-there-an-explorer-for-nym-mixnet-1">Is there an explorer for Nym Mixnet?</a></h3>
<p>Yes, there are several places, some are built by Nym core community:</p>
<ul>
<li><a href="https://explorer.nymtech.net/">Nym Explorer</a></li>
<li><a href="https://mixnet.explorers.guru/">Guru Explorer</a></li>
<li><a href="https://explorenym.net/">ExploreNYM</a></li>
</ul>
<h3 id="what-determines-the-rewards-when-running-a-mix-node"><a class="header" href="#what-determines-the-rewards-when-running-a-mix-node">What determines the rewards when running a Mix Node?</a></h3>
<p>The stake required for a Mix Node to achieve maximum rewards is called Mix Node saturation point. This is calculated from the staking supply (all circulating supply + part of unlocked tokens). The target level of staking is to have 40% of the staking supply locked in Mix Nodes.</p>
<p>The node stake saturation point, which we denote by Nsat, is given by the stake supply, target level of staking divided between the rewarded nodes.</p>
<p>This design ensures the nodes aim to have a same size of stake (reputation) which can be done by delegation staking, as well as it secures a whale prevention and decentralization of staking, as any higher level of delegated $NYM than Nsat per node results in worsening reward ratio. On the contrary, the more Mix Nodes are active, the lower is Nsat. The equilibrium is reached when the staked tokens are delegated equally across the active Mix nodes and that’s our basis for this incentive system.</p>
<iframe src="https://status.notrustverify.ch/d-solo/CW3L7dVVk/nym-mixnet?orgId=1&from=1703074760986&to=1705666760986&panelId=5" width="800" height="400" frameborder="0"></iframe>
<p>The rewarded nodes are the nodes which will receive some rewards by the end of the given epoch. These can be separated further separated into:</p>
<ol>
<li>
<p>Active: Top <em>N</em> nodes of the rewarded set (currently all of them but this can change), these are nodes which are used by the clients and mix packets.</p>
</li>
<li>
<p>Standby: Bottom <em>N</em> nodes of the rewarded set, they don’t mix data from the clients but are used for testing. Their reward is smaller.</p>
</li>
</ol>
<p>For more detailed calculation, read our blog post <a href="https://blog.nymtech.net/nym-token-economics-update-fedff0ed5267">Nym Token Economics update</a>. More info on staking can be found <a href="https://blog.nymtech.net/staking-in-nym-introducing-mainnet-mixmining-f9bb1cbc7c36">here</a>. And <a href="https://blog.nymtech.net/want-to-stake-in-nym-here-is-how-to-choose-a-mix-node-to-delegate-nym-to-c3b862add165">here</a> is more info on how to choose a Mix Node for delegation. And finally an <a href="https://blog.nymtech.net/quarterly-token-economic-parameter-update-b2862948710f">update</a> on token economics from July 2023.</p>
<iframe src="https://status.notrustverify.ch/d-solo/CW3L7dVVk/nym-mixnet?orgId=1&from=1703074829887&to=1705666829887&panelId=31" width="850" height="400" frameborder="0"></iframe>
<p><em>More graphs and stats at <a href="https://status.notrustverify.ch/d/CW3L7dVVk/nym-mixnet?orgId=1&amp;from=1703074861988&amp;to=1705666862004">stats.notrustverify.ch</a>.</em></p>
<h3 id="which-vps-providers-would-you-recommend-1"><a class="header" href="#which-vps-providers-would-you-recommend-1">Which VPS providers would you recommend?</a></h3>
<p>Consider in which jurisdiction you reside and where do you want to run a Mix Node. Do you want to pay by crypto or not and what are the other important particularities for your case? We always recommend operators to try to choose smaller and decentralised VPS providers over the most known ones controlling a majority of the internet. We receive some good feedback on these: Linode, Ghandi, Flokinet and Exoscale. Do your own research and share with the community.</p>
<h3 id="why-is-a-mix-node-setup-on-a-self-hosted-machine-so-tricky"><a class="header" href="#why-is-a-mix-node-setup-on-a-self-hosted-machine-so-tricky">Why is a mix node setup on a self-hosted machine so tricky?</a></h3>
<p>We don’t recommend this setup because it’s really difficult to get a static IP and route IPv6 traffic.</p>
<h3 id="whats-the-sphinx-packet-size-1"><a class="header" href="#whats-the-sphinx-packet-size-1">What’s the Sphinx packet size?</a></h3>
<p>The sizes are shown in the configs <a href="https://github.com/nymtech/nym/blob/1ba6444e722e7757f1175a296bed6e31e25b8db8/common/nymsphinx/params/src/packet_sizes.rs#L12">here</a> (default is the one clients use, the others are for research purposes, not to be used in production as this would fragment the anonymity set). More info can be found <a href="https://github.com/nymtech/nym/blob/4844ac953a12b29fa27688609ec193f1d560c996/common/nymsphinx/anonymous-replies/src/reply_surb.rs#L80">here</a>.</p>
<h3 id="why-a-mix-node-and-a-gateway-cannot-be-bonded-with-the-same-wallet-1"><a class="header" href="#why-a-mix-node-and-a-gateway-cannot-be-bonded-with-the-same-wallet-1">Why a Mix Node and a Gateway cannot be bonded with the same wallet?</a></h3>
<p>Because of the way the smart contract works we keep it one-node one-address at the moment.</p>
<h3 id="which-nodes-are-the-most-needed-to-be-setup-to-strengthen-nym-infrastructure-and-which-ones-bring-rewards-1"><a class="header" href="#which-nodes-are-the-most-needed-to-be-setup-to-strengthen-nym-infrastructure-and-which-ones-bring-rewards-1">Which nodes are the most needed to be setup to strengthen Nym infrastructure and which ones bring rewards?</a></h3>
<p>Ath this point the most crutial component needed are <a href="archive/faq/../../legal/exit-gateway.html">Exit Gateways</a>.</p>
<h3 id="are-mix-nodes-whitelisted"><a class="header" href="#are-mix-nodes-whitelisted">Are Mix Nodes whitelisted?</a></h3>
<p>Nope, anyone can run a Mix Node. Purely reliant on the node’s reputation (self stake + delegations) &amp; routing score.</p>
<h2 id="validators-and-tokens-1"><a class="header" href="#validators-and-tokens-1">Validators and tokens</a></h2>
<h3 id="whats-the-difference-between-nym-and-unym-1"><a class="header" href="#whats-the-difference-between-nym-and-unym-1">What’s the difference between NYM and uNYM?</a></h3>
<p>1 NYM = 1 000 000 uNYM</p>
<!--- Commenting for now as NYX is not publicly out yet
### What's the difference between NYM and NYX?
--->
<h3 id="why-some-nyx-blockchain-operations-take-one-hour-and-others-are-instant-1"><a class="header" href="#why-some-nyx-blockchain-operations-take-one-hour-and-others-are-instant-1">Why some Nyx blockchain operations take one hour and others are instant?</a></h3>
<p>This is based on the definition in <a href="https://github.com/nymtech/nym/tree/develop/common/cosmwasm-smart-contracts">Nym’s CosmWasm</a> smart contracts code.</p>
<p>Whatever is defined as <a href="https://github.com/nymtech/nym/blob/b07627d57e075b6de35b4b1a84927578c3172811/common/cosmwasm-smart-contracts/mixnet-contract/src/pending_events.rs#L35-L103">a pending epoch event</a> will get resolved at the end of the current epoch.</p>
<p>And whatever is defined as <a href="https://github.com/nymtech/nym/blob/b07627d57e075b6de35b4b1a84927578c3172811/common/cosmwasm-smart-contracts/mixnet-contract/src/pending_events.rs#L145-L172">a pending interval event</a> will get resolved at the end of the current interval.</p>
<h3 id="can-i-run-a-validator-1"><a class="header" href="#can-i-run-a-validator-1">Can I run a validator?</a></h3>
<p>We are currently working towards building up a closed set of reputable validators. You can ask us for coins to get in, but please don’t be offended if we say no - validators are part of our system’s core security and we are starting out with people we already know or who have a solid reputation.</p>
<h3 id="why-is-validator-set-entry-whitelisted-1"><a class="header" href="#why-is-validator-set-entry-whitelisted-1">Why is validator set entry whitelisted?</a></h3>
<p>We understand that the early days of the Nyx blockchain will face possible vulnerabilities in terms of size - easy to disrupt or halt the chain if a malicious party entered with a large portion of stake. Besides that, there are some legal issues we need to address before we can distribute the validator set in a fully permissions fashion.</p>
<h3 id="why-does-nym-do-airdrops-1"><a class="header" href="#why-does-nym-do-airdrops-1">Why does Nym do airdrops?</a></h3>
<p>It is part of ensuring decentralisation - we need to avoid a handful of people having too much control over the token and market. Of course ideally people will stake the tokens and contribute to the project at this stage. We run surveys to better understand what people are doing with their tokens and what usability issues there are for staking. Any feedback is appreciated as it helps us improve all aspects of using the token and participating in the ecosystem.</p>
<footer id="last-change">Last change: 2024-04-23, commit: <a href="https://github.com/nymtech/nym/commit/ce067db40">ce067db40</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="project-smoosh---faq"><a class="header" href="#project-smoosh---faq">Project Smoosh - FAQ</a></h1>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="archive/faq/smoosh-faq.html#admonition-warning"></a>
</div>
<div>
<p><strong>This is an archived page for backwards compatibility. We have switched to <a href="archive/faq/../../nodes/nym-node.html"><code>nym-node</code> binary</a>, please <a href="archive/faq/../../nodes/setup.html#migrate">migrate</a> your nodes. The content of this page is not updated since April 26th 2024. Eventually this page will be terminated!</strong></p>
</div>
</div>
<blockquote>
<p>We aim on purpose to make minimal changes to reward scheme and software. We’re just ‘smooshing’ together stuff we already debugged and know works.
– Harry Halpin,  Nym CEO</p>
</blockquote>
<br>
<p>This page refer to the changes which are planned to take place over Q3 and Q4 2023. As this is a transition period in the beginning (Q3 2023) the <a href="archive/faq/mixnodes-faq.html">Mix Nodes FAQ page</a> holds more answers to the current setup as project Smoosh refers to the eventual setup. As project Smoosh gets progressively implemented the answers on this page will become to be more relevant to the current state and eventually this FAQ page will be merged with the still relevant parts of the main Mix Nodes FAQ page.</p>
<p>If any questions are not answered or it’s not clear for you in which stage project Smoosh is right now, please reach out in Node Operators <a href="https://matrix.to/#/#operators:nymtech.chat">Matrix room</a>.</p>
<h3 id="what-are-the-changes"><a class="header" href="#what-are-the-changes">What are the changes?</a></h3>
<p>Project Smoosh will have four steps, please follow the table below to track the dynamic progress:</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left"><strong>Step</strong></th><th style="text-align: left"><strong>Status</strong></th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>1.</strong> Combine the <code>nym-gateway</code> and <code>nym-network-requester</code> into one binary</td><td style="text-align: left">✅ done</td></tr>
<tr><td style="text-align: left"><strong>2.</strong> Create <a href="archive/faq/../../legal/exit-gateway.html">Exit Gateway</a>: Take the <code>nym-gateway</code> binary including <code>nym-network-requester</code> combined in #1 and switch from <a href="https://nymtech.net/.wellknown/network-requester/standard-allowed-list.txt"><code>allowed.list</code></a> to a new <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">exit policy</a></td><td style="text-align: left">✅ done</td></tr>
<tr><td style="text-align: left"><strong>3.</strong> Combine all the nodes in the Nym Mixnet into one binary, that is <code>nym-mixnode</code>, <code>nym-gateway</code> (entry and exit) and <code>nym-network-requester</code>.</td><td style="text-align: left">✅ done</td></tr>
<tr><td style="text-align: left"><strong>4.</strong> Adjust reward scheme to incentivise and reward Exit Gateways as a part of <code>nym-node</code> binary, implementing <a href="https://youtu.be/nLmdsZ1BsQg?t=1717">zkNym credentials</a>.</td><td style="text-align: left">🛠️ in progress</td></tr>
<tr><td style="text-align: left"><strong>5.</strong> Implement multiple node functionalities into one <code>nym-node</code> connected to one Nyx account.</td><td style="text-align: left">🛠️ in progress</td></tr>
</tbody></table>
</div>
<p>These steps will be staggered over time - period of several months, and will be implemented one by one with enough time to take in feedback and fix bugs in between.
Generally, the software will be the same, just instead of multiple binaries, there will be one Nym Node (<code>nym-node</code>) binary. Delegations will remain on as they are now, per our token economics (staking, saturation etc)</p>
<h3 id="what-does-it-mean-for-nym-nodes-operators"><a class="header" href="#what-does-it-mean-for-nym-nodes-operators">What does it mean for Nym nodes operators?</a></h3>
<p>We are exploring two potential methods for implementing binary functionality in practice and will provide information in advance. The options are:</p>
<ol>
<li>
<p>Make a selection button (command/argument/flag) for operators to choose whether they want their node to provide all or just some of the functions nodes have in the Nym Mixnet. Nodes functioning as Exit Gateways (in that epoch) will then have bigger rewards due to their larger risk exposure and overhead work with the setup.</p>
</li>
<li>
<p>All nodes will be required to have the Exit Gateway functionality. All nodes are rewarded the same as now, and the difference is that a node sometimes (some epochs) may be performing as Exit Gateway sometimes as Mix node or Entry Gateway adjusted according the network demand by an algorithm.</p>
</li>
</ol>
<h3 id="where-can-i-read-more-about-the-exit-gateway-setup"><a class="header" href="#where-can-i-read-more-about-the-exit-gateway-setup">Where can I read more about the Exit Gateway setup?</a></h3>
<p>We created an <a href="archive/faq/../../legal/exit-gateway.html">entire page</a> about the technical and legal questions around Exit Gateway.</p>
<h3 id="what-is-the-change-from-allow-list-to-deny-list"><a class="header" href="#what-is-the-change-from-allow-list-to-deny-list">What is the change from allow list to deny list?</a></h3>
<p>The operators running Gateways would have to “open” their nodes to a wider range of online services, in a similar fashion to Tor exit relays. The main change will be to expand the original short <a href="https://nymtech.net/.wellknown/network-requester/standard-allowed-list.txt"><code>allowed.list</code></a> to a more permissive setup. An <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">exit policy</a> will constrain the hosts that the users of the Nym VPN and Mixnet can connect to. This will be done in an effort to protect the operators, as Gateways will act both as SOCKS5 Network Requesters, and exit nodes for IP traffic from Nym VPN and Mixnet clients.</p>
<h3 id="how-will-the-exit-policy-be-implemented"><a class="header" href="#how-will-the-exit-policy-be-implemented">How will the Exit policy be implemented?</a></h3>
<p>Follow the dynamic progress of exit policy implementation on Gateways below:</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left"><strong>Step</strong></th><th style="text-align: left"><strong>Status</strong></th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>1.</strong> By default the <a href="https://nymtech.net/.wellknown/network-requester/exit-policy.txt">exit policy</a> filtering is disabled and the <a href="https://nymtech.net/.wellknown/network-requester/standard-allowed-list.txt"><code>allowed.list</code></a> filtering is going to continue be used. This is to prevent operators getting surprised by upgrading their Gateways (or Network Requesters) and suddenly be widely open to the internet. To enable the new exit policy, operators must use <code>--with-exit-policy</code> flag or modify the <code>config.toml</code> file.</td><td style="text-align: left">✅ done</td></tr>
<tr><td style="text-align: left"><strong>2.</strong> The exit policy is part of the Gateway setup by default. To disable this exit policy, operators must use <code>--disable-exit-policy</code> flag.</td><td style="text-align: left">✅ done</td></tr>
<tr><td style="text-align: left"><strong>3.</strong> The exit policy is the only option. The <code>allowed.list</code> is completely removed.</td><td style="text-align: left">✅ done</td></tr>
</tbody></table>
</div>
<p>Keep in mind the table above only relates to changes happening on Gateways. For the Project Smoosh progress refer to the <a href="archive/faq/./smoosh-faq.html#what-are-the-changes">table above</a>. Whether Exit Gateway functionality will be optional or mandatory part of every active Nym Node depends on the chosen <a href="archive/faq/./smoosh-faq.html#what-does-it-mean-for-nym-nodes-operators">design</a>.</p>
<h3 id="can-i-run-a-mix-node-only"><a class="header" href="#can-i-run-a-mix-node-only">Can I run a Mix Node only?</a></h3>
<p>It depends which <a href="archive/faq/./smoosh-faq.html#what-does-it-mean-for-nym-nodes-operators">design</a> will ultimately be used. In case of the first - yes. In case of the second option, all the nodes will be setup with Exit Gateway functionality turned on.</p>
<h2 id="token-economics--rewards"><a class="header" href="#token-economics--rewards">Token Economics &amp; Rewards</a></h2>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="archive/faq/smoosh-faq.html#admonition-info"></a>
</div>
<div>
<p>For any specifics on Nym token economics and Nym Mixnet reward system, please read the <a href="https://nymtech.net/nym-cryptoecon-paper.pdf">Nym token economics paper</a>.</p>
</div>
</div>
<h3 id="what-are-the-incentives-for-the-node-operator"><a class="header" href="#what-are-the-incentives-for-the-node-operator">What are the incentives for the node operator?</a></h3>
<p>In the original setup there were no incentives to run a <code>nym-network-requester</code> binary. After the transition all the users will buy multiple tickets of zkNyms credentials and use those as <a href="https://arxiv.org/abs/2303.08221">anonymous e-cash</a> to pay for their data traffic (<a href="https://github.com/nymtech/nym/tree/master/nym-api"><code>Nym API</code></a> will do the do cryptographical checks to prevent double-spending). All collected fees get distributed to all active nodes proportionally to their work by the end of each epoch.</p>
<h3 id="how-does-this-change-the-token-economics"><a class="header" href="#how-does-this-change-the-token-economics">How does this change the token economics?</a></h3>
<p>The token economics will stay the same as they are, same goes for the reward algorithm.</p>
<h3 id="how-are-the-rewards-distributed"><a class="header" href="#how-are-the-rewards-distributed">How are the rewards distributed?</a></h3>
<p>This depends on <a href="archive/faq/./smoosh-faq.html#what-does-it-mean-for-nym-nodes-operators">design</a> chosen. In case of #1, it will look like this:</p>
<p>As each operator can choose what roles their nodes provide, the nodes which work as open Gateways will have higher rewards because they are the most important to keep up and stable. Besides that the operators of Gateways may be exposed to more complication and possible legal risks.</p>
<p>The nodes which are initialized to run as Mix Nodes and Gateways will be chosen to be on top of the active set before the ones working only as a Mix Node.</p>
<p>I case we go with #2, all nodes active in the epoch will be rewarded proportionally according their work.</p>
<p>In either way, Nym will share all the specifics beforehand.</p>
<h3 id="how-will-be-the-staking-and-inflation-after-project-smoosh"><a class="header" href="#how-will-be-the-staking-and-inflation-after-project-smoosh">How will be the staking and inflation after project Smoosh?</a></h3>
<p>Nym will run tests to count how much payment comes from the users of the Mixnet and if that covers the reward payments. If not, we may need to keep inflation on to secure incentives for high quality Gateways in the early stage of the transition.</p>
<h3 id="when-project-smooth-will-be-launched-it-would-be-the-mixmining-pool-that-will-pay-for-the-gateway-rewards-based-on-amount-of-traffic-routed-"><a class="header" href="#when-project-smooth-will-be-launched-it-would-be-the-mixmining-pool-that-will-pay-for-the-gateway-rewards-based-on-amount-of-traffic-routed-">When project smooth will be launched, it would be the mixmining pool that will pay for the Gateway rewards based on amount of traffic routed ?</a></h3>
<p>Yes, the same pool. Nym’s aim is to do minimal modifications. The only real modification on the smart contract side will be to get into top X of ‘active set’ operators will need to have open Gateway function enabled.</p>
<h3 id="what-does-this-mean-for-the-current-delegators"><a class="header" href="#what-does-this-mean-for-the-current-delegators">What does this mean for the current delegators?</a></h3>
<p>From an operator standpoint, it shall just be a standard Nym upgrade, a new option to run the Gateway software on your node. Delegators should not have to re-delegate.</p>
<h2 id="legal-questions"><a class="header" href="#legal-questions">Legal Questions</a></h2>
<h3 id="are-there-any-legal-concerns-for-the-operators"><a class="header" href="#are-there-any-legal-concerns-for-the-operators">Are there any legal concerns for the operators?</a></h3>
<p>So far the general line is that running a Gateway is not illegal (unless you are in Iran, China, and a few other places) and due to encryption/mixing less risky than running a normal VPN node. For Mix Nodes, it’s very safe as they have “no idea” what packets they are mixing.</p>
<p>There are several legal questions and analysis to be made for different jurisdictions. To be able to share resources and findings between the operators themselves we created a <a href="archive/faq/../../legal/exit-gateway.html">Community Legal Forum</a>.</p>
<footer id="last-change">Last change: 2024-04-26, commit: <a href="https://github.com/nymtech/nym/commit/b93afe775">b93afe775</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="code-of-conduct"><a class="header" href="#code-of-conduct">Code of Conduct</a></h1>
<p>We are committed to providing a friendly, safe and welcoming environment for all, regardless of level of experience, gender identity and expression, sexual orientation, disability, personal appearance, body size, race, ethnicity, age, religion, nationality, or other similar characteristic.</p>
<p>Please avoid using overtly sexual aliases or other nicknames that might detract from a friendly, safe and welcoming environment for all.</p>
<p>Please be kind and courteous. There’s no need to be mean or rude.</p>
<p>Respect that people have differences of opinion and that every design or implementation choice carries a trade-off and numerous costs. There is seldom a right answer.</p>
<p>Please keep unstructured critique to a minimum. If you have solid ideas you want to experiment with, make a fork and see how it works.</p>
<p>We will exclude you from interaction if you insult, demean or harass anyone. That is not welcome behaviour. We interpret the term “harassment” as including the definition in the Citizen Code of Conduct; if you have any lack of clarity about what might be included in that concept, please read their definition. In particular, we don’t tolerate behaviour that excludes people in socially marginalized groups.</p>
<p>Private harassment is also unacceptable. No matter who you are, if you feel you have been or are being harassed or made uncomfortable by a community member, please contact one of the channel ops or any of the Rust moderation team immediately. Whether you’re a regular contributor or a newcomer, we care about making this community a safe place for you and we’ve got your back.</p>
<p>Likewise any spamming, trolling, flaming, baiting or other attention-stealing behaviour is not welcome.</p>
<footer id="last-change">Last change: 2023-08-18, commit: <a href="https://github.com/nymtech/nym/commit/ee14dfc75">ee14dfc75</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="terms-and-conditions"><a class="header" href="#terms-and-conditions">Terms and Conditions</a></h1>
<p>With <code>nym-node</code> version <code>1.1.3</code>, NymTech SA introduced <a href="https://nymtech.net/terms-and-conditions/operators/v1.0.0"><strong>Operators Terms &amp; Conditions</strong></a> for operators who want their nodes to become a part of the active set of Nym Mixnet.</p>
<p>There has been a long ongoing discussion whether and how to apply Terms and Conditions for Nym network operators, with an aim to stay aligned with the philosophy of Free Software and provide legal defense for both node operators and Nym developers. To understand better the reasoning behind this decision, you can listen to the first <a href="https://www.youtube.com/live/7hwb8bAZIuc?si=3mQ2ed7AyUA1SsCp&amp;t=915">Nym Operator Town Hall</a> introducing the T&amp;Cs or to <a href="https://www.youtube.com/watch?v=yIN-zYQw0I0">Operator AMA with CEO Harry Halpin</a> from June 4th, 2024, explaining pros and cons of T&amp;Cs implementation.</p>
<p>Accepting T&amp;Cs is done via an explicit flag <code>--accept-operator-terms-and-conditions</code> added to <code>nym-node run</code> command.</p>
<p>More information on how to setup your node or check whether any node has T&amp;C accepted can be found in <a href="nodes/setup.html#terms--conditions"><code>nym-node</code> setup guide</a>.</p>
<footer id="last-change">Last change: 2024-06-27, commit: <a href="https://github.com/nymtech/nym/commit/789914b09">789914b09</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="licensing"><a class="header" href="#licensing">Licensing</a></h1>
<p>As a general approach, licensing is as follows this pattern:</p>
<ul>
<li><p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://nymtech.net/docs">Nym Documentation</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://nymtech.net">Nym Technologies</a> is licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></p>
</li>
<li>
<p>Nym applications and binaries are <a href="https://www.gnu.org/licenses/">GPL-3.0-only</a></p>
</li>
<li>
<p>Used libraries and different components are <a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache 2.0</a> or <a href="https://mit-license.org/">MIT</a></p>
</li>
</ul>
<p>For accurate information, please check individual files.</p>
<footer id="last-change">Last change: 2023-11-29, commit: <a href="https://github.com/nymtech/nym/commit/dafed3ad5">dafed3ad5</a></footer>
                            </div>
                        </main>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>


        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="./themes/pagetoc.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
