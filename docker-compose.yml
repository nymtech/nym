version: '3.7'
services:
        genesis_validator:
                build: docker/validator
                image: validator:latest
                ports:
                        - "26657:26657"
                container_name: genesis_validator
                volumes:
                        - "genesis_volume:/genesis_volume"
                command: ["genesis"]
        secondary_validator:
                build: docker/validator
                image: validator:latest
                volumes:
                        - "genesis_volume:/genesis_volume:ro"
                depends_on:
                        - "genesis_validator"
                command: ["secondary"]
        mixnet_contract:
                build: docker/mixnet_contract
                image: contract:latest
                volumes:
                        - ".:/nym"
        contract_uploader:
                build: docker/typescript_client
                image: contract_uploader:typescript
                volumes:
                        - "genesis_volume:/genesis_volume:ro"
                        - "contract_volume:/contract_volume"
                        - ".:/nym"
                depends_on:
                        - "genesis_validator"
                        - "secondary_validator"
                        - "mixnet_contract"
        wallet:
                build: docker/wallet-web
                image: wallet:latest
                ports:
                        - "3000:3000"
                volumes:
                        - "contract_volume:/contract_volume"
                        - "./wallet-web:/wallet-web:ro"
                depends_on:
                        - "contract_uploader"
        mnemonic_echo:
                build: docker/mnemonic_echo
                image: mnemonic_echo:latest
                volumes:
                        - "genesis_volume:/genesis_volume:ro"
                depends_on:
                        - "genesis_validator"


volumes:
        genesis_volume:
        contract_volume:
